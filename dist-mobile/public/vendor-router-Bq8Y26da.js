import{s as V,be as $}from"./vendor-misc-CeDaE8No.js";import*as y from"react";import{createContext as x,forwardRef as q,useContext as O,cloneElement as j,createElement as d,isValidElement as _,Fragment as z,useRef as H}from"react";const G=y.useInsertionEffect,J=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Q=J?y.useLayoutEffect:y.useEffect,W=G||Q,I=e=>{const t=y.useRef([e,(...n)=>t[0](...n)]).current;return W(()=>{t[0]=e}),t[1]},X="popstate",P="pushState",v="replaceState",Y="hashchange",k=[X,P,v,Y],Z=e=>{for(const t of k)addEventListener(t,e);return()=>{for(const t of k)removeEventListener(t,e)}},K=(e,t)=>V.useSyncExternalStore(Z,e,t),w=()=>location.search,ee=({ssrSearch:e}={})=>K(w,e!=null?()=>e:w),R=()=>location.pathname,te=({ssrPath:e}={})=>K(R,e!=null?()=>e:R),ne=(e,{replace:t=!1,state:n=null}={})=>history[t?v:P](n,"",e),se=(e={})=>[te(e),ne],L=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[L]>"u"){for(const e of[P,v]){const t=history[e];history[e]=function(){const n=t.apply(this,arguments),s=new Event(e);return s.arguments=arguments,dispatchEvent(s),n}}Object.defineProperty(window,L,{value:!0})}const oe=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",D=(e="")=>e==="/"?"":e,re=(e,t)=>e[0]==="~"?e.slice(1):D(t)+e,ce=(e="",t)=>oe(C(D(e)),C(t)),C=e=>{try{return decodeURI(e)}catch{return e}},U={hook:se,searchHook:ee,parser:$,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:e=>e},A=x(U),m=()=>O(A),B={},F=x(B),ae=()=>O(F),p=e=>{const[t,n]=e.hook(e);return[ce(e.base,t),I((s,o)=>n(re(s,e.base),o))]},he=()=>p(m()),M=(e,t,n,s)=>{const{pattern:o,keys:a}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",s),u=o.exec(n)||[],[f,...i]=u;return f!==void 0?[!0,(()=>{const c=a!==!1?Object.fromEntries(a.map((h,g)=>[h,i[g]])):u.groups;let r={...i};return c&&Object.assign(r,c),r})(),...s?[f]:[]]:[!1,null]},ue=({children:e,...t})=>{const n=m(),s=t.hook?U:n;let o=s;const[a,u=t.ssrSearch??""]=t.ssrPath?.split("?")??[];a&&(t.ssrSearch=u,t.ssrPath=a),t.hrefs=t.hrefs??t.hook?.hrefs,t.searchHook=t.searchHook??t.hook?.searchHook;let f=H({}),i=f.current,c=i;for(let r in s){const h=r==="base"?s[r]+(t[r]??""):t[r]??s[r];i===c&&h!==c[r]&&(f.current=c={...c}),c[r]=h,(h!==s[r]||h!==o[r])&&(o=c)}return d(A.Provider,{value:o,children:e})},S=({children:e,component:t},n)=>t?d(t,{params:n}):typeof e=="function"?e(n):e,ie=e=>{let t=H(B);const n=t.current;return t.current=Object.keys(e).length!==Object.keys(n).length||Object.entries(e).some(([s,o])=>o!==n[s])?e:n},de=({path:e,nest:t,match:n,...s})=>{const o=m(),[a]=p(o),[u,f,i]=n??M(o.parser,e,a,t),c=ie({...ae(),...f});if(!u)return null;const r=i?d(ue,{base:i},S(s,c)):S(s,c);return d(F.Provider,{value:c,children:r})},me=q((e,t)=>{const n=m(),[s,o]=p(n),{to:a="",href:u=a,onClick:f,asChild:i,children:c,className:r,replace:h,state:g,...T}=e,E=I(l=>{l.ctrlKey||l.metaKey||l.altKey||l.shiftKey||l.button!==0||(f?.(l),l.defaultPrevented||(l.preventDefault(),o(u,e)))}),b=n.hrefs(u[0]==="~"?u.slice(1):n.base+u,n);return i&&_(c)?j(c,{onClick:E,href:b}):d("a",{...T,onClick:E,href:b,className:r?.call?r(s===u):r,children:c,ref:t})}),N=e=>Array.isArray(e)?e.flatMap(t=>N(t&&t.type===z?t.props.children:t)):[e],ye=({children:e,location:t})=>{const n=m(),[s]=p(n);for(const o of N(e)){let a=0;if(_(o)&&(a=M(n.parser,o.props.path,t||s,o.props.nest))[0])return j(o,{match:a})}return null};export{me as L,de as R,ye as S,he as u};
