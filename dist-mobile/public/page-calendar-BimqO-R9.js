import{j as e,c as j,P as Q,u as V,a as W,f as X,B as v,D as E,b as T,d as Y,e as I,L as f,g as Z}from"./page-aichat-CjfTf9Xy.js";import{useState as d,useCallback as ee,useEffect as te,useMemo as O}from"react";import{j as se}from"./vendor-firebase-BAzxo0Bm.js";import{t as ae}from"./vendor-toast-CdQ6zwVl.js";import{v as ne,w as re,n as oe}from"./vendor-misc-CC_pCkXK.js";function le({className:n,...s}){return e.jsx("div",{"data-slot":"card",className:j("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",n),...s})}function ge({className:n,...s}){return e.jsx("div",{"data-slot":"card-header",className:j("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",n),...s})}function pe({className:n,...s}){return e.jsx("div",{"data-slot":"card-title",className:j("leading-none font-semibold",n),...s})}function fe({className:n,...s}){return e.jsx("div",{"data-slot":"card-description",className:j("text-muted-foreground text-sm",n),...s})}function ie({className:n,...s}){return e.jsx("div",{"data-slot":"card-content",className:j("px-6",n),...s})}function ce({children:n,title:s="Nexo",showSidebar:x=!1,showQuickActions:i=!1,quickActions:D=[],currentChatId:b,onSelectChat:N,onNewChat:m}){return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx(Q,{title:s,showSidebar:x,showQuickActions:i,quickActions:D,currentChatId:b,onSelectChat:N,onNewChat:m}),e.jsx("main",{className:"flex-1 overflow-y-auto pt-14",style:{touchAction:"pan-y"},children:e.jsx("div",{className:"mobile-container py-4",children:n})})]})}function je(){const{t:n}=V(),[s,x]=d(new Date),[i,D]=d([]),[b,N]=d(!0),[m,L]=d(null),[r,H]=d(null),[z,w]=d(!1),[P,y]=d(!1);W();const M=ee(async()=>{try{N(!0);const t=se(X,"getCalendarEvents"),a=new Date(s.getFullYear(),s.getMonth()-1,1),l=new Date(s.getFullYear(),s.getMonth()+2,0),h=(await t({startDate:a.toISOString(),endDate:l.toISOString()})).data;D(h.events||[])}catch{ae.error("Fehler beim Laden der Events")}finally{N(!1)}},[s]);te(()=>{M()},[M]);const R=["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],A=["Mo","Di","Mi","Do","Fr","Sa","So"],B=t=>new Date(t.getFullYear(),t.getMonth()+1,0).getDate(),$=t=>{const a=new Date(t.getFullYear(),t.getMonth(),1).getDay();return a===0?6:a-1},J=O(()=>{const t=B(s),a=$(s),l=[],h=new Date(s.getFullYear(),s.getMonth()-1,0).getDate();for(let o=a-1;o>=0;o--){const c=new Date(s.getFullYear(),s.getMonth()-1,h-o),g=c.toISOString().split("T")[0];l.push({date:c,isCurrentMonth:!1,events:i.filter(p=>p.date===g)})}for(let o=1;o<=t;o++){const c=new Date(s.getFullYear(),s.getMonth(),o),g=c.toISOString().split("T")[0];l.push({date:c,isCurrentMonth:!0,events:i.filter(p=>p.date===g)})}const C=42-l.length;for(let o=1;o<=C;o++){const c=new Date(s.getFullYear(),s.getMonth()+1,o),g=c.toISOString().split("T")[0];l.push({date:c,isCurrentMonth:!1,events:i.filter(p=>p.date===g)})}return l},[s,i]),_=()=>{x(new Date(s.getFullYear(),s.getMonth()-1,1))},q=()=>{x(new Date(s.getFullYear(),s.getMonth()+1,1))},K=()=>{x(new Date)},U=t=>{const a=new Date;return t.toDateString()===a.toDateString()},G=t=>{L(t),y(!0)},S=t=>{H(t),w(!0)},F=O(()=>{if(!m)return[];const t=m.toISOString().split("T")[0];return i.filter(a=>a.date===t)},[m,i]),k=t=>{switch(t){case"due":return"bg-red-500";case"reminder":return"bg-blue-500";case"appointment":return"bg-green-500";case"work":return"bg-purple-500";case"school":return"bg-yellow-500";case"hort":return"bg-orange-500";default:return"bg-gray-500"}};return e.jsxs(ce,{title:"Kalender",showSidebar:!0,children:[e.jsxs("div",{className:"mobile-card mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:_,className:"h-10 min-h-[44px] px-3",children:e.jsx(ne,{className:"w-5 h-5"})}),e.jsx("div",{className:"flex-1 text-center",children:e.jsxs("h2",{className:"text-lg font-semibold",children:[R[s.getMonth()]," ",s.getFullYear()]})}),e.jsx(v,{variant:"outline",size:"sm",onClick:q,className:"h-10 min-h-[44px] px-3",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsx(v,{variant:"outline",size:"sm",onClick:K,className:"w-full h-10 min-h-[44px]",children:"Heute"})]}),e.jsxs("div",{className:"mobile-card",children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:A.map((t,a)=>e.jsx("div",{className:"text-center text-xs font-medium text-muted-foreground py-2",children:t},a))}),b?e.jsx("div",{className:"grid grid-cols-7 gap-1",children:Array.from({length:42}).map((t,a)=>e.jsx(Skeleton,{className:"aspect-square min-h-[44px] rounded-lg"},a))}):e.jsx("div",{className:"grid grid-cols-7 gap-1",children:J.map((t,a)=>{const l=U(t.date);return e.jsxs("button",{onClick:()=>G(t.date),className:`
                    aspect-square min-h-[44px] p-1 rounded-lg text-sm transition-colors
                    ${t.isCurrentMonth?"text-foreground":"text-muted-foreground/40"}
                    ${l?"bg-primary text-primary-foreground font-bold":"hover:bg-muted"}
                  `,children:[e.jsx("div",{className:"text-xs font-medium mb-1",children:t.date.getDate()}),e.jsxs("div",{className:"flex flex-col gap-0.5",children:[t.events.slice(0,2).map((u,h)=>e.jsx("div",{onClick:C=>{C.stopPropagation(),S(u)},className:`h-1 rounded ${k(u.type)}`,title:u.title},h)),t.events.length>2&&e.jsxs("div",{className:"text-[10px] text-muted-foreground",children:["+",t.events.length-2]})]})]},a)})})]}),e.jsx(E,{open:P,onOpenChange:y,children:e.jsxs(T,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-fit !rounded-3xl !m-0 !overflow-visible !shadow-2xl",children:[e.jsx(Y,{className:"px-5 pt-5 pb-3",children:e.jsx(I,{className:"text-lg font-semibold",children:m?.toLocaleDateString("de-CH",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})}),e.jsx("div",{className:"space-y-2 px-5 pb-2",children:F.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Keine Events an diesem Tag"}):F.map(t=>e.jsx(le,{className:"cursor-pointer",onClick:()=>{y(!1),S(t)},children:e.jsx(ie,{className:"p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full mt-1 ${k(t.type)}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.title}),t.time&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsx(oe,{className:"w-3 h-3 inline mr-1"}),t.time]}),t.personName&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t.personName})]})]})})},t.id))})]})}),e.jsx(E,{open:z,onOpenChange:w,children:e.jsxs(T,{className:"max-w-sm",children:[e.jsx(Y,{children:e.jsx(I,{children:r?.title})}),r&&e.jsxs("div",{className:"space-y-3",children:[r.date&&e.jsxs("div",{children:[e.jsx(f,{className:"text-xs text-muted-foreground",children:"Datum"}),e.jsx("p",{className:"text-sm",children:new Date(r.date).toLocaleDateString("de-CH",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})]}),r.time&&e.jsxs("div",{children:[e.jsx(f,{className:"text-xs text-muted-foreground",children:"Uhrzeit"}),e.jsx("p",{className:"text-sm",children:r.time})]}),r.description&&e.jsxs("div",{children:[e.jsx(f,{className:"text-xs text-muted-foreground",children:"Beschreibung"}),e.jsx("p",{className:"text-sm",children:r.description})]}),r.amount&&e.jsxs("div",{children:[e.jsx(f,{className:"text-xs text-muted-foreground",children:"Betrag"}),e.jsxs("p",{className:"text-sm",children:["CHF ",(r.amount/100).toFixed(2)]})]}),r.personName&&e.jsxs("div",{children:[e.jsx(f,{className:"text-xs text-muted-foreground",children:"Person"}),e.jsx("p",{className:"text-sm",children:r.personName})]})]}),e.jsx(Z,{children:e.jsx(v,{variant:"outline",onClick:()=>w(!1),className:"h-10 min-h-[44px]",children:"Schließen"})})]})})]})}export{le as C,ce as M,ge as a,pe as b,fe as c,ie as d,je as e};
