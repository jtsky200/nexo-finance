import{j as e,P as G,u as Q,a as V,f as W,B as j,D as k,b as E,c as T,d as Y,C as X,e as Z,L as p,g as ee}from"./page-aichat-NBZWpoUt.js";import{useState as c,useCallback as te,useEffect as se,useMemo as I}from"react";import{j as ae}from"./vendor-firebase-BWRlcouJ.js";import{t as ne}from"./vendor-toast-CdQ6zwVl.js";import{d as re,e as le,v as oe}from"./vendor-misc-BL476KuS.js";function ie({children:w,title:s="Nexo",showSidebar:m=!1,showQuickActions:o=!1,quickActions:N=[],currentChatId:v,onSelectChat:f,onNewChat:d}){return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx(G,{title:s,showSidebar:m,showQuickActions:o,quickActions:N,currentChatId:v,onSelectChat:f,onNewChat:d}),e.jsx("main",{className:"flex-1 overflow-y-auto pt-14",style:{touchAction:"pan-y"},children:e.jsx("div",{className:"mobile-container py-4",children:w})})]})}function ue(){const{t:w}=Q(),[s,m]=c(new Date),[o,N]=c([]),[v,f]=c(!0),[d,O]=c(null),[n,L]=c(null),[z,D]=c(!1),[H,b]=c(!1);V();const C=te(async()=>{try{f(!0);const t=ae(W,"getCalendarEvents"),a=new Date(s.getFullYear(),s.getMonth()-1,1),l=new Date(s.getFullYear(),s.getMonth()+2,0),h=(await t({startDate:a.toISOString(),endDate:l.toISOString()})).data;N(h.events||[])}catch{ne.error("Fehler beim Laden der Events")}finally{f(!1)}},[s]);se(()=>{C()},[C]);const P=["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],R=["Mo","Di","Mi","Do","Fr","Sa","So"],A=t=>new Date(t.getFullYear(),t.getMonth()+1,0).getDate(),B=t=>{const a=new Date(t.getFullYear(),t.getMonth(),1).getDay();return a===0?6:a-1},$=I(()=>{const t=A(s),a=B(s),l=[],h=new Date(s.getFullYear(),s.getMonth()-1,0).getDate();for(let r=a-1;r>=0;r--){const i=new Date(s.getFullYear(),s.getMonth()-1,h-r),u=i.toISOString().split("T")[0];l.push({date:i,isCurrentMonth:!1,events:o.filter(g=>g.date===u)})}for(let r=1;r<=t;r++){const i=new Date(s.getFullYear(),s.getMonth(),r),u=i.toISOString().split("T")[0];l.push({date:i,isCurrentMonth:!0,events:o.filter(g=>g.date===u)})}const y=42-l.length;for(let r=1;r<=y;r++){const i=new Date(s.getFullYear(),s.getMonth()+1,r),u=i.toISOString().split("T")[0];l.push({date:i,isCurrentMonth:!1,events:o.filter(g=>g.date===u)})}return l},[s,o]),J=()=>{m(new Date(s.getFullYear(),s.getMonth()-1,1))},q=()=>{m(new Date(s.getFullYear(),s.getMonth()+1,1))},K=()=>{m(new Date)},U=t=>{const a=new Date;return t.toDateString()===a.toDateString()},_=t=>{O(t),b(!0)},M=t=>{L(t),D(!0)},S=I(()=>{if(!d)return[];const t=d.toISOString().split("T")[0];return o.filter(a=>a.date===t)},[d,o]),F=t=>{switch(t){case"due":return"bg-red-500";case"reminder":return"bg-blue-500";case"appointment":return"bg-green-500";case"work":return"bg-purple-500";case"school":return"bg-yellow-500";case"hort":return"bg-orange-500";default:return"bg-gray-500"}};return e.jsxs(ie,{title:"Kalender",showSidebar:!0,children:[e.jsxs("div",{className:"mobile-card mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:J,className:"h-10 min-h-[44px] px-3",children:e.jsx(re,{className:"w-5 h-5"})}),e.jsx("div",{className:"flex-1 text-center",children:e.jsxs("h2",{className:"text-lg font-semibold",children:[P[s.getMonth()]," ",s.getFullYear()]})}),e.jsx(j,{variant:"outline",size:"sm",onClick:q,className:"h-10 min-h-[44px] px-3",children:e.jsx(le,{className:"w-5 h-5"})})]}),e.jsx(j,{variant:"outline",size:"sm",onClick:K,className:"w-full h-10 min-h-[44px]",children:"Heute"})]}),e.jsxs("div",{className:"mobile-card",children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:R.map((t,a)=>e.jsx("div",{className:"text-center text-xs font-medium text-muted-foreground py-2",children:t},a))}),v?e.jsx("div",{className:"grid grid-cols-7 gap-1",children:Array.from({length:42}).map((t,a)=>e.jsx(Skeleton,{className:"aspect-square min-h-[44px] rounded-lg"},a))}):e.jsx("div",{className:"grid grid-cols-7 gap-1",children:$.map((t,a)=>{const l=U(t.date);return e.jsxs("button",{onClick:()=>_(t.date),className:`
                    aspect-square min-h-[44px] p-1 rounded-lg text-sm transition-colors
                    ${t.isCurrentMonth?"text-foreground":"text-muted-foreground/40"}
                    ${l?"bg-primary text-primary-foreground font-bold":"hover:bg-muted"}
                  `,children:[e.jsx("div",{className:"text-xs font-medium mb-1",children:t.date.getDate()}),e.jsxs("div",{className:"flex flex-col gap-0.5",children:[t.events.slice(0,2).map((x,h)=>e.jsx("div",{onClick:y=>{y.stopPropagation(),M(x)},className:`h-1 rounded ${F(x.type)}`,title:x.title},h)),t.events.length>2&&e.jsxs("div",{className:"text-[10px] text-muted-foreground",children:["+",t.events.length-2]})]})]},a)})})]}),e.jsx(k,{open:H,onOpenChange:b,children:e.jsxs(E,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-fit !rounded-3xl !m-0 !overflow-visible !shadow-2xl",children:[e.jsx(T,{className:"px-5 pt-5 pb-3",children:e.jsx(Y,{className:"text-lg font-semibold",children:d?.toLocaleDateString("de-CH",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})}),e.jsx("div",{className:"space-y-2 px-5 pb-2",children:S.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Keine Events an diesem Tag"}):S.map(t=>e.jsx(X,{className:"cursor-pointer",onClick:()=>{b(!1),M(t)},children:e.jsx(Z,{className:"p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full mt-1 ${F(t.type)}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.title}),t.time&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsx(oe,{className:"w-3 h-3 inline mr-1"}),t.time]}),t.personName&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t.personName})]})]})})},t.id))})]})}),e.jsx(k,{open:z,onOpenChange:D,children:e.jsxs(E,{className:"max-w-sm",children:[e.jsx(T,{children:e.jsx(Y,{children:n?.title})}),n&&e.jsxs("div",{className:"space-y-3",children:[n.date&&e.jsxs("div",{children:[e.jsx(p,{className:"text-xs text-muted-foreground",children:"Datum"}),e.jsx("p",{className:"text-sm",children:new Date(n.date).toLocaleDateString("de-CH",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})]}),n.time&&e.jsxs("div",{children:[e.jsx(p,{className:"text-xs text-muted-foreground",children:"Uhrzeit"}),e.jsx("p",{className:"text-sm",children:n.time})]}),n.description&&e.jsxs("div",{children:[e.jsx(p,{className:"text-xs text-muted-foreground",children:"Beschreibung"}),e.jsx("p",{className:"text-sm",children:n.description})]}),n.amount&&e.jsxs("div",{children:[e.jsx(p,{className:"text-xs text-muted-foreground",children:"Betrag"}),e.jsxs("p",{className:"text-sm",children:["CHF ",(n.amount/100).toFixed(2)]})]}),n.personName&&e.jsxs("div",{children:[e.jsx(p,{className:"text-xs text-muted-foreground",children:"Person"}),e.jsx("p",{className:"text-sm",children:n.personName})]})]}),e.jsx(ee,{children:e.jsx(j,{variant:"outline",onClick:()=>D(!1),className:"h-10 min-h-[44px]",children:"Schließen"})})]})})]})}export{ie as M,ue as a};
