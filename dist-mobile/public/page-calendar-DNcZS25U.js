import{j as e,P as ye,c as M,u as De,a as ke,b as Se,d as Ce,f as ee,e as Ee,B as h,C as te,g as se,D as $,h as L,i as A,k as H,l as O,L as C,m as Fe,n as Me}from"./page-aichat-Incr_Y-u.js";import{useState as v,useEffect as ae,useCallback as Te,useMemo as K}from"react";import{S as ze}from"./vendor-ui-O6JmT-Zi.js";import{c as Be,X as V,d as Ie,e as Ye,w as J,C as ne,S as $e,b as Le,a as Ae,W as He,f as Oe,g as re,h as Re,B as Pe,K as Ue,N as We}from"./vendor-misc-D_lwQBa3.js";import{j as Ke}from"./vendor-firebase-BUqvHymk.js";import{t as g}from"./vendor-toast-CdQ6zwVl.js";import{u as Ve}from"./vendor-router-Dgxws0rx.js";function Je({children:s,title:n="Nexo",showSidebar:a=!1,showQuickActions:m=!1,quickActions:o=[],currentChatId:p,onSelectChat:k,onNewChat:N}){return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx(ye,{title:n,showSidebar:a,showQuickActions:m,quickActions:o,currentChatId:p,onSelectChat:k,onNewChat:N}),e.jsx("main",{className:"flex-1 overflow-y-auto pt-14",style:{touchAction:"pan-y"},children:e.jsx("div",{className:"mobile-container py-4",children:s})})]})}function qe({className:s,...n}){return e.jsx("div",{"data-slot":"skeleton",className:M("bg-accent animate-pulse rounded-md",s),...n})}const Ze=Be("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function le({className:s,variant:n,asChild:a=!1,...m}){const o=a?ze:"span";return e.jsx(o,{"data-slot":"badge",className:M(Ze({variant:n}),s),...m})}function at(s){if(!s||!s.includes("T"))throw new Error("Invalid datetime-local format. Expected: YYYY-MM-DDTHH:mm");const[n,a]=s.split("T"),[m,o,p]=n.split("-").map(Number),[k,N]=a?a.split(":").map(Number):[0,0];return new Date(m,o-1,p,k,N,0,0)}function nt(s,n){if(!s)return"N/A";try{let a;if(s?.toDate&&typeof s.toDate=="function")a=s.toDate();else if(typeof s=="string")a=new Date(s);else if(s instanceof Date)a=s;else return"N/A";if(isNaN(a.getTime()))return"N/A";const m=a.getDate().toString().padStart(2,"0"),o=(a.getMonth()+1).toString().padStart(2,"0"),p=a.getFullYear();return n?.includeTime,`${m}.${o}.${p}`}catch{return"N/A"}}function R(s){if(!s)return R(new Date);try{let n;if(s?.toDate&&typeof s.toDate=="function")n=s.toDate();else if(typeof s=="string")n=new Date(s);else if(s instanceof Date)n=s;else return R(new Date);if(isNaN(n.getTime()))return R(new Date);const a=n.getFullYear(),m=(n.getMonth()+1).toString().padStart(2,"0"),o=n.getDate().toString().padStart(2,"0"),p=n.getHours().toString().padStart(2,"0"),k=n.getMinutes().toString().padStart(2,"0");return`${a}-${m}-${o}T${p}:${k}`}catch{return R(new Date)}}function E(s){if(!s)return"";try{let n;if(typeof s=="object"&&s!==null&&"toDate"in s&&typeof s.toDate=="function")n=s.toDate();else if(s instanceof Date)n=s;else if(typeof s=="string"){if(!s.includes("T")&&s.match(/^\d{4}-\d{2}-\d{2}$/))return s;n=new Date(s)}else n=new Date(s);if(isNaN(n.getTime()))return"";const a=n.getFullYear(),m=String(n.getMonth()+1).padStart(2,"0"),o=String(n.getDate()).padStart(2,"0");return`${a}-${m}-${o}`}catch{return""}}function D(s){if(!(s instanceof Date)||isNaN(s.getTime()))throw new Error("Invalid date: must be a valid Date object");const n=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),m=String(s.getDate()).padStart(2,"0");return`${n}-${a}-${m}`}function rt(){const{t:s}=De(),[,n]=Ve(),[a,m]=v(new Date),[o,p]=v([]),[k,N]=v(!0),[d,P]=v(null),[r,ie]=v(null),[oe,T]=v(!1),[de,S]=v(!1),[ce,z]=v(!1),[me,B]=v(!1);ke();const{settings:ue}=Se(),q=ue?.location||"Zurich, CH",Z=d?new Date(d.getFullYear(),d.getMonth(),d.getDate()):null,{data:x,isLoading:G,error:U}=Ce(Z,q);ae(()=>{},[d,Z,q,x,G,U]);const I=Te(async()=>{try{if(N(!0),!ee){console.error("[Calendar] Firebase functions not available"),g.error("Firebase nicht initialisiert"),p([]);return}if(!Ee.currentUser){console.warn("[Calendar] User not authenticated"),p([]);return}const t=Ke(ee,"getCalendarEvents"),l=new Date(a.getFullYear(),a.getMonth()-1,1),c=new Date(a.getFullYear(),a.getMonth()+2,0);try{const w=(await t({startDate:l.toISOString(),endDate:c.toISOString()})).data.events||[],u=typeof globalThis.process<"u"&&!1,j=w.map(b=>{const y=E(b.date);return y?{...b,date:y}:(console.warn("[Calendar] Event with invalid date skipped:",b),null)}).filter(b=>b!==null);p(j)}catch(i){console.error("[Calendar] API Error:",{message:i?.message,code:i?.code,details:i?.details,stack:i?.stack}),i?.code==="unauthenticated"||i?.message?.includes("UNAUTHORIZED")?g.error("Bitte anmelden"):i?.code==="unavailable"||i?.message?.includes("network")?g.error("Netzwerkfehler - Bitte erneut versuchen"):g.error(`Fehler beim Laden der Events: ${i?.message||"Unbekannter Fehler"}`),p([])}}catch(t){console.error("[Calendar] Unexpected error:",t),g.error("Unerwarteter Fehler beim Laden der Events"),p([])}finally{N(!1)}},[a]);ae(()=>{I()},[I]);const xe=["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],he=["Mo","Di","Mi","Do","Fr","Sa","So"],pe=t=>new Date(t.getFullYear(),t.getMonth()+1,0).getDate(),ge=t=>{const l=new Date(t.getFullYear(),t.getMonth(),1).getDay();return l===0?6:l-1},fe=K(()=>{const t=pe(a),l=ge(a),c=[],f=new Date(a.getFullYear(),a.getMonth()-1,0).getDate();for(let u=l-1;u>=0;u--){const j=new Date(a.getFullYear(),a.getMonth()-1,f-u),b=D(j),y=o.filter(F=>E(F.date)===b);c.push({date:j,isCurrentMonth:!1,events:y})}for(let u=1;u<=t;u++){const j=new Date(a.getFullYear(),a.getMonth(),u),b=D(j),y=o.filter(F=>E(F.date)===b);c.push({date:j,isCurrentMonth:!0,events:y})}const w=42-c.length;for(let u=1;u<=w;u++){const j=new Date(a.getFullYear(),a.getMonth()+1,u),b=D(j),y=o.filter(F=>E(F.date)===b);c.push({date:j,isCurrentMonth:!1,events:y})}return c},[a,o]),be=()=>{m(new Date(a.getFullYear(),a.getMonth()-1,1))},je=()=>{m(new Date(a.getFullYear(),a.getMonth()+1,1))},ve=()=>{m(new Date)},Ne=t=>{const l=new Date;return t.toDateString()===l.toDateString()},we=t=>{const l=new Date(t.getFullYear(),t.getMonth(),t.getDate());P(l),S(!0)},W=t=>{ie(t),T(!0)},X=K(()=>{if(!d)return[];const t=new Date(d.getFullYear(),d.getMonth(),d.getDate()),l=D(t);return o.filter(i=>{if(!i.date)return!1;const f=E(i.date);return f?f===l:!1})},[d,o]),_=K(()=>{const l=D(new Date);return o.filter(c=>{const i=E(c.date);return i!==""&&i===l})},[o]),Y=t=>{switch(t){case"due":return"bg-pink-500";case"reminder":case"appointment":case"termin":return"bg-orange-500";case"work":return"bg-slate-400";case"vacation":case"frei":return"bg-emerald-400";case"school-holiday":return"bg-sky-400";case"school":return"bg-purple-400";case"hort":return"bg-fuchsia-500";default:return"bg-gray-500"}};return e.jsxs(Je,{title:"Kalender",showSidebar:!0,children:[e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>n("/"),className:"fixed top-2 right-2 z-50 h-9 w-9 rounded-full bg-background/95 backdrop-blur-sm border border-border shadow-lg",children:e.jsx(V,{className:"h-4 w-4"})}),e.jsxs("div",{className:"mobile-card mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(h,{variant:"outline",size:"sm",onClick:be,className:"h-10 min-h-[44px] px-3",children:e.jsx(Ie,{className:"w-5 h-5"})}),e.jsx("div",{className:"flex-1 text-center",children:e.jsxs("h2",{className:"text-lg font-semibold",children:[xe[a.getMonth()]," ",a.getFullYear()]})}),e.jsx(h,{variant:"outline",size:"sm",onClick:je,className:"h-10 min-h-[44px] px-3",children:e.jsx(Ye,{className:"w-5 h-5"})})]}),e.jsx(h,{variant:"outline",size:"sm",onClick:ve,className:"w-full h-10 min-h-[44px]",children:"Heute"})]}),e.jsxs("div",{className:"mobile-card",children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:he.map((t,l)=>e.jsx("div",{className:"text-center text-xs font-medium text-muted-foreground py-2",children:t},l))}),k?e.jsx("div",{className:"grid grid-cols-7 gap-1",children:Array.from({length:42}).map((t,l)=>e.jsx(qe,{className:"aspect-square min-h-[44px] rounded-lg"},l))}):e.jsx("div",{className:"grid grid-cols-7 gap-1",children:fe.map((t,l)=>{const c=Ne(t.date);return e.jsxs("button",{onClick:()=>we(t.date),className:`
                    aspect-square min-h-[44px] p-1 rounded-lg text-sm transition-colors
                    ${t.isCurrentMonth?"text-foreground":"text-muted-foreground/40"}
                    ${c?"bg-primary text-primary-foreground font-bold":"hover:bg-muted"}
                  `,children:[e.jsx("div",{className:"text-xs font-medium mb-1",children:t.date.getDate()}),e.jsxs("div",{className:"flex flex-col gap-0.5",children:[t.events.slice(0,2).map((i,f)=>e.jsx("div",{onClick:w=>{w.stopPropagation(),W(i)},className:`h-1 rounded ${Y(i.type)}`,title:i.title},f)),t.events.length>2&&e.jsxs("div",{className:"text-[10px] text-muted-foreground",children:["+",t.events.length-2]})]})]},l)})})]}),_.length>0&&e.jsxs("div",{className:"mobile-card mt-4",children:[e.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Heute - Termine & Events"}),e.jsx("div",{className:"space-y-2",children:_.map(t=>e.jsx(te,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>{P(new Date(t.date.includes("T")?t.date.split("T")[0]:t.date)),W(t)},children:e.jsx(se,{className:"p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:M("w-3 h-3 rounded-full mt-1 flex-shrink-0",Y(t.type))}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.title}),t.time&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsx(J,{className:"w-3 h-3 inline mr-1"}),t.time]}),t.personName&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t.personName})]})]})})},t.id))})]}),e.jsx($,{open:de,onOpenChange:S,children:e.jsxs(L,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-[85vh] !rounded-3xl !m-0 !overflow-y-auto !shadow-2xl",children:[e.jsx(A,{className:"px-5 pt-5 pb-3 sticky top-0 bg-background z-10 border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(H,{className:"text-lg font-semibold",children:d?.toLocaleDateString("de-CH",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}),e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>S(!1),className:"h-8 w-8 rounded-full",children:e.jsx(V,{className:"h-4 w-4"})})]})}),e.jsxs("div",{className:"space-y-4 px-5 pb-2",children:[e.jsxs("div",{className:"bg-muted/30 rounded-xl p-4 space-y-3",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),"Wetter"]})}),G?e.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Lädt Wetterdaten..."}),U&&e.jsxs("div",{className:"text-xs text-red-500 mt-2",children:["Fehler: ",U.message]})]}):x?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[x.icon==="sun"&&e.jsx($e,{className:"w-6 h-6 text-yellow-500"}),x.icon==="cloud-sun"&&e.jsx(Le,{className:"w-6 h-6 text-gray-500"}),x.icon==="cloud"&&e.jsx(ne,{className:"w-6 h-6 text-gray-500"}),x.icon==="rain"&&e.jsx(Ae,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsxs("span",{className:"text-2xl font-bold",children:[x.temperature,"°"]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"C"})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:x.condition})]})]}),(x.humidity!==void 0||x.windSpeed!==void 0)&&e.jsxs("div",{className:"flex gap-4 text-xs text-muted-foreground pt-2 border-t border-border/50",children:[x.windSpeed!==void 0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(He,{className:"w-3 h-3"}),e.jsxs("span",{children:[x.windSpeed," km/h"]})]}),x.humidity!==void 0&&e.jsx("div",{children:e.jsxs("span",{children:["Luftfeuchtigkeit: ",x.humidity,"%"]})})]})]}):e.jsx("div",{className:"text-xs text-muted-foreground text-center py-2",children:"Keine Wetterdaten verfügbar"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Termine & Events"}),X.length===0?e.jsxs("div",{className:"text-sm text-muted-foreground text-center py-3 bg-muted/30 rounded-lg",children:[e.jsx("p",{children:"Keine Events an diesem Tag"}),e.jsxs("p",{className:"text-xs mt-2 opacity-70",children:["Debug: ",o.length," Events geladen, ",d?`Datum: ${D(d)}`:"Kein Datum ausgewählt"]})]}):e.jsx("div",{className:"space-y-2",children:X.map(t=>e.jsx(te,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>{S(!1),W(t)},children:e.jsx(se,{className:"p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:M("w-3 h-3 rounded-full mt-1 flex-shrink-0",Y(t.type))}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.title}),t.time&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsx(J,{className:"w-3 h-3 inline mr-1"}),t.time]}),t.personName&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t.personName})]})]})})},t.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Schnellaktionen"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(h,{variant:"outline",onClick:()=>{z(!0)},className:"h-auto py-3 flex flex-col items-center gap-2 rounded-xl",children:[e.jsx(Oe,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:"Termin erstellen"})]}),e.jsxs(h,{variant:"outline",onClick:()=>{B(!0)},className:"h-auto py-3 flex flex-col items-center gap-2 rounded-xl",children:[e.jsx(re,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:"Finanz-Eintrag"})]})]})]})]}),e.jsx(O,{className:"px-5 pb-3 pt-2 sticky bottom-0 bg-background border-t border-border",children:e.jsx(h,{variant:"default",onClick:()=>S(!1),className:"h-11 min-h-[44px] w-full rounded-xl text-sm font-medium",children:"Schließen"})})]})}),e.jsx($,{open:oe,onOpenChange:T,children:e.jsxs(L,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-[85vh] !rounded-3xl !m-0 !overflow-y-auto !shadow-2xl",children:[e.jsxs(A,{className:"px-5 pt-5 pb-3 sticky top-0 bg-background z-10 border-b border-border relative",children:[e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>T(!1),className:"absolute right-2 top-2 h-8 w-8 rounded-full z-20",children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex items-start gap-3 pr-8",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:M("w-4 h-4 rounded-full flex-shrink-0",Y(r?.type||""))}),e.jsxs(le,{variant:"outline",className:"text-xs",children:[r?.type==="due"&&"Fällig",r?.type==="reminder"&&"Erinnerung",r?.type==="appointment"&&"Termin",r?.type==="work"&&"Arbeit",r?.type==="school"&&"Schule",r?.type==="hort"&&"Hort",!r?.type&&"Event"]})]}),e.jsx(H,{className:"text-lg font-semibold leading-tight",children:r?.title})]})})]}),r&&e.jsxs("div",{className:"space-y-4 px-5 pb-2",children:[e.jsxs("div",{className:"bg-muted/30 rounded-xl p-4 space-y-3",children:[r.date&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Re,{className:"w-5 h-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(C,{className:"text-xs text-muted-foreground block mb-1",children:"Datum"}),e.jsx("p",{className:"text-sm font-medium",children:new Date(r.date).toLocaleDateString("de-CH",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})]})]}),r.time&&e.jsxs("div",{className:"flex items-start gap-3 pt-2 border-t border-border/50",children:[e.jsx(J,{className:"w-5 h-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(C,{className:"text-xs text-muted-foreground block mb-1",children:"Uhrzeit"}),e.jsx("p",{className:"text-sm font-medium",children:r.time})]})]})]}),r.description&&e.jsxs("div",{className:"bg-muted/30 rounded-xl p-4",children:[e.jsx(C,{className:"text-xs text-muted-foreground block mb-2",children:"Beschreibung"}),e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:r.description})]}),(r.amount||r.personName||r.status)&&e.jsxs("div",{className:"space-y-2",children:[r.amount&&e.jsxs("div",{className:"flex items-center gap-3 bg-muted/30 rounded-xl p-4",children:[e.jsx(re,{className:"w-5 h-5 text-muted-foreground flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(C,{className:"text-xs text-muted-foreground block mb-1",children:"Betrag"}),e.jsxs("p",{className:"text-sm font-semibold",children:["CHF ",(r.amount/100).toFixed(2)]})]})]}),r.personName&&e.jsxs("div",{className:"flex items-center gap-3 bg-muted/30 rounded-xl p-4",children:[e.jsx(Pe,{className:"w-5 h-5 text-muted-foreground flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(C,{className:"text-xs text-muted-foreground block mb-1",children:"Person"}),e.jsx("p",{className:"text-sm font-medium",children:r.personName})]})]}),r.status&&e.jsxs("div",{className:"flex items-center gap-3 bg-muted/30 rounded-xl p-4",children:[e.jsx(Ue,{className:"w-5 h-5 text-muted-foreground flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(C,{className:"text-xs text-muted-foreground block mb-1",children:"Status"}),e.jsx(le,{variant:r.status==="paid"?"default":"secondary",className:"text-xs",children:r.status==="paid"?"Bezahlt":r.status==="pending"?"Ausstehend":r.status})]})]}),r.isOverdue&&e.jsxs("div",{className:"flex items-center gap-3 bg-red-50 dark:bg-red-950/20 rounded-xl p-4 border border-red-200 dark:border-red-800",children:[e.jsx(We,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0"}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-sm font-medium text-red-600 dark:text-red-400",children:"Überfällig"})})]})]})]}),e.jsx(O,{className:"px-5 pb-3 pt-2 sticky bottom-0 bg-background border-t border-border",children:e.jsx(h,{variant:"default",onClick:()=>T(!1),className:"h-11 min-h-[44px] w-full rounded-xl text-sm font-medium",children:"Schließen"})})]})}),e.jsx($,{open:ce,onOpenChange:z,children:e.jsxs(L,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-fit !rounded-3xl !m-0 !overflow-visible !shadow-2xl",children:[e.jsx(A,{className:"px-5 pt-4 pb-2",children:e.jsx(H,{className:"text-lg font-semibold",children:"Termin erstellen"})}),e.jsxs("div",{className:"px-5 pb-2 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Titel"}),e.jsx("input",{type:"text",id:"reminder-title",placeholder:"z.B. Arzttermin",className:"w-full px-3 py-2 border border-border rounded-lg text-sm",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Datum"}),e.jsx("input",{type:"date",id:"reminder-date",defaultValue:d?D(d):"",className:"w-full px-3 py-2 border border-border rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Uhrzeit (optional)"}),e.jsx("input",{type:"time",id:"reminder-time",className:"w-full px-3 py-2 border border-border rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Notizen (optional)"}),e.jsx("textarea",{id:"reminder-notes",placeholder:"Weitere Details...",rows:2,className:"w-full px-3 py-2 border border-border rounded-lg text-sm resize-none"})]})]}),e.jsxs(O,{className:"px-5 pb-3 pt-2 gap-2",children:[e.jsx(h,{variant:"outline",onClick:()=>z(!1),className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:"Abbrechen"}),e.jsx(h,{variant:"default",onClick:async()=>{try{const t=document.getElementById("reminder-title"),l=document.getElementById("reminder-date"),c=document.getElementById("reminder-time"),i=document.getElementById("reminder-notes");if(!t.value.trim()){g.error("Bitte gib einen Titel ein");return}const f=new Date(l.value);if(c.value){const[w,u]=c.value.split(":");f.setHours(parseInt(w),parseInt(u))}else f.setHours(12,0);await Fe({title:t.value.trim(),type:"termin",dueDate:f,isAllDay:!c.value,notes:i.value.trim()||null}),g.success("Termin erstellt"),z(!1),S(!1),await I(),d&&P(new Date(d))}catch(t){g.error(t.message||"Fehler beim Erstellen des Termins")}},className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:"Erstellen"})]})]})}),e.jsx($,{open:me,onOpenChange:B,children:e.jsxs(L,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-fit !rounded-3xl !m-0 !overflow-visible !shadow-2xl",children:[e.jsx(A,{className:"px-5 pt-4 pb-2",children:e.jsx(H,{className:"text-lg font-semibold",children:"Finanz-Eintrag erstellen"})}),e.jsxs("div",{className:"px-5 pb-2 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Beschreibung"}),e.jsx("input",{type:"text",id:"finance-description",placeholder:"z.B. Einkauf, Gehalt",className:"w-full px-3 py-2 border border-border rounded-lg text-sm",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Betrag (CHF)"}),e.jsx("input",{type:"number",id:"finance-amount",placeholder:"0.00",step:"0.01",className:"w-full px-3 py-2 border border-border rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Typ"}),e.jsxs("select",{id:"finance-type",className:"w-full px-3 py-2 border border-border rounded-lg text-sm",children:[e.jsx("option",{value:"einnahme",children:"Einnahme"}),e.jsx("option",{value:"ausgabe",children:"Ausgabe"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Datum"}),e.jsx("input",{type:"date",id:"finance-date",defaultValue:d?D(d):"",className:"w-full px-3 py-2 border border-border rounded-lg text-sm"})]})]}),e.jsxs(O,{className:"px-5 pb-3 pt-2 gap-2",children:[e.jsx(h,{variant:"outline",onClick:()=>B(!1),className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:"Abbrechen"}),e.jsx(h,{variant:"default",onClick:async()=>{try{const t=document.getElementById("finance-description"),l=document.getElementById("finance-amount"),c=document.getElementById("finance-type"),i=document.getElementById("finance-date");if(!t.value.trim()){g.error("Bitte gib eine Beschreibung ein");return}if(!l.value||parseFloat(l.value)<=0){g.error("Bitte gib einen gültigen Betrag ein");return}await Me({notes:t.value.trim(),amount:Math.round(parseFloat(l.value)*100),type:c.value,date:new Date(i.value),category:"Sonstiges",currency:"CHF",isRecurring:!1}),g.success("Finanz-Eintrag erstellt"),B(!1),S(!1),await I()}catch(t){g.error(t.message||"Fehler beim Erstellen des Finanz-Eintrags")}},className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:"Erstellen"})]})]})})]})}export{le as B,Je as M,qe as S,rt as a,R as d,nt as f,at as p};
