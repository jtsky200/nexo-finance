import{j as e,c as Et,u as ca,y as oa,z as da,A as wt,E as ma,F as ua,G as N,H as g,I as C,J as yt,S as Pe,K as Le,M as Ae,N as Fe,O as v,B as h,Q as Y,D as kt,p as Ct,q as St,r as It,s as Pt,R as ha,L as ds,t as Lt,T as Ve,h as De,U as xa,V as fa,W as pa,x as ga}from"./page-aichat-D9kAxZiV.js";import{isValidElement as ba,cloneElement as ja,useEffect as oe,useState as l,useRef as O,useMemo as ms,useCallback as X}from"react";import{M as Na}from"./page-calendar-BeNX6wtJ.js";import{v as va,w as wa,x as ya,y as ka,z as Ca,A as Sa}from"./vendor-ui-lt1so0uj.js";import{t as i}from"./vendor-toast-CdQ6zwVl.js";import{k as ze}from"./vendor-firebase-Dpcgiyci.js";import{F as At,p as q,X as B,T as de,k as Ft,a2 as Ge,a3 as Ia,Q as We,v as Qe,Z as Pa,j as Ye,R as La,a4 as Aa,q as Dt,o as zt,h as Fa,G as Da,a5 as us,a6 as za,a7 as Ea,a8 as Ta}from"./vendor-misc-Dgoprpj-.js";function Ma({...n}){return e.jsx(va,{"data-slot":"context-menu",...n})}function Ra({...n}){return e.jsx(wa,{"data-slot":"context-menu-trigger",...n})}function qa({className:n,...f}){return e.jsx(ya,{children:e.jsx(ka,{"data-slot":"context-menu-content",className:Et("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",n),...f})})}function hs({className:n,inset:f,variant:me="default",...p}){return e.jsx(Ca,{"data-slot":"context-menu-item","data-inset":f,"data-variant":me,className:Et("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",n),...p})}function Ba({className:n,...f}){return e.jsx(Sa,{"data-slot":"context-menu-separator",className:Et("bg-border -mx-1 my-1 h-px",n),...f})}function $a({children:n,actions:f,disabled:me}){if(me||!f||f.length===0)return e.jsx(e.Fragment,{children:n});const p={primary:f.filter(m=>!m.variant||m.variant==="default"),destructive:f.filter(m=>m.variant==="destructive")};if(p.primary.length===0&&p.destructive.length===0)return e.jsx(e.Fragment,{children:n});const ee=ba(n)?ja(n,{onContextMenu:m=>{m.preventDefault(),n.props?.onContextMenu&&n.props.onContextMenu(m)}}):n;return e.jsxs(Ma,{modal:!1,children:[e.jsx(Ra,{asChild:!0,children:ee}),e.jsxs(qa,{className:"w-48 z-50",onCloseAutoFocus:m=>m.preventDefault(),onEscapeKeyDown:m=>m.stopPropagation(),children:[p.primary.map(m=>e.jsxs(hs,{onClick:F=>{F.preventDefault(),F.stopPropagation(),m.onClick()},disabled:m.disabled,className:"cursor-pointer",children:[m.icon&&e.jsx("span",{className:"mr-2",children:m.icon}),m.label]},m.id)),p.destructive.length>0&&p.primary.length>0&&e.jsx(Ba,{}),p.destructive.map(m=>e.jsxs(hs,{onClick:F=>{F.preventDefault(),F.stopPropagation(),m.onClick()},disabled:m.disabled,className:"cursor-pointer text-destructive focus:text-destructive",children:[m.icon&&e.jsx("span",{className:"mr-2",children:m.icon}),m.label]},m.id))]})]})}const xs=n=>[n("shopping.categories.food"),n("shopping.categories.drinks"),n("shopping.categories.household"),n("shopping.categories.hygiene"),n("shopping.categories.pet"),n("shopping.categories.other")];function ln(){const{t:n}=ca();oe(()=>{const t=document.createElement("style");return t.textContent=`
      @keyframes scan-line {
        0% { transform: translateY(0); opacity: 0.3; }
        50% { transform: translateY(100%); opacity: 1; }
        100% { transform: translateY(0); opacity: 0.3; }
      }
    `,document.head.appendChild(t),()=>{document.head.contains(t)&&document.head.removeChild(t)}},[]);const{data:f=[],isLoading:me}=oa(),[p,ee]=l(null),[m,F]=l(!1),[fs,Ee]=l(!1),[te,se]=l(""),[ps,Ze]=l(null);oe(()=>{if(f.length>0&&!p){const t=f.find(s=>s.isDefault)||f[0];t&&ee(t.id)}},[f,p]);const{data:U=[],isLoading:gs,refetch:w}=da(p||void 0),[Je,ue]=l([]),[Ha,ae]=l(new Set);oe(()=>{(U.length>0||Je.length===0)&&ue(U)},[U]),Je.length>0;const[Tt,Xe]=l(!1),[Mt,Te]=l(!1),[S,he]=l({name:"",quantity:"1",category:n("shopping.categories.food"),store:""}),[y,_]=l([]),[Rt,qt]=l(!1),[xe,ne]=l("camera"),[re,Me]=l("receipt"),[k,Z]=l(!1),[d,et]=l(null),[D,ie]=l([]),[z,K]=l([]),[bs,V]=l(0),[E,Re]=l(null),[fe,pe]=l(1),[tt,js]=l(!0),[st,Ns]=l(!0),[at,vs]=l(!0),b=O(null),le=O(null),Bt=O(null),[u,ge]=l(null),[$t,nt]=l(!1),[be,rt]=l(null),[Ht,Ot]=l(!1),G=O(null),it=O(null),[Ut,_t]=l(null),qe=O(null),[Kt,lt]=l(!1),[ct,ot]=l(null),[dt,Vt]=l(!1),W=O(null),mt=O(null),[Gt,Wt]=l(null),ce=ms(()=>U.filter(t=>t.status==="not_bought"),[U]),Q=ms(()=>U.filter(t=>t.status==="bought"),[U]),[A,ut]=l(!1),[I,je]=l(new Set),ws=async()=>{if(!S.name.trim()){i.error(n("shopping.itemNameRequired"));return}try{await Ve({listId:p||void 0,item:S.name.trim(),quantity:parseInt(S.quantity)||1,category:S.category,estimatedPrice:0,currency:"CHF",store:S.store||null}),i.success(n("shopping.itemAdded")),C(),Xe(!1),he({name:"",quantity:"1",category:n("shopping.categories.food"),store:""}),await w()}catch(t){i.error(n("shopping.error")+N(t)),g()}},ys=()=>{const t={store:"",items:[]};_([...y,t])},ks=t=>{_(y.filter((s,a)=>a!==t))},Cs=(t,s)=>{const a=[...y];a[t].store=s,_(a)},Ss=t=>{const s=[...y];s[t].items.push({id:Date.now().toString()+Math.random().toString(36).substr(2,9),name:"",quantity:"1",category:n("shopping.categories.food"),price:"",articleNumber:"",productInfo:null,saveToDatabase:!1}),_(s)},Is=(t,s)=>{const a=[...y];a[t].items=a[t].items.filter(r=>r.id!==s),_(a)},T=(t,s,a,r)=>{const o=[...y],c=o[t].items.findIndex(x=>x.id===s);c!==-1&&(o[t].items[c][a]=r,_(o))},Ps=(t,s)=>{rt({groupIndex:t,itemId:s}),nt(!0),setTimeout(()=>Ls(),100)},Ls=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){i.error("Kamera wird nicht unterstützt");return}const t=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});_t(t),G.current&&(G.current.srcObject=t,await G.current.play()),Ot(!0),As(),C()}catch(t){i.error("Kamera-Fehler: "+N(t)),g()}},As=()=>{if(!("BarcodeDetector"in window)){i.error("Barcode-Erkennung nicht unterstützt");return}const t=new window.BarcodeDetector({formats:["ean_13","ean_8","code_128","code_39","upc_a","upc_e"]});qe.current=setInterval(async()=>{if(!G.current||!it.current||!Ht)return;const s=G.current,a=it.current,r=a.getContext("2d");if(!(!r||s.readyState!==4)){a.width=s.videoWidth,a.height=s.videoHeight,r.drawImage(s,0,0);try{const o=await t.detect(a);if(o.length>0){const c=o[0].rawValue;Qt(),be&&(T(be.groupIndex,be.itemId,"articleNumber",c),i.success(`Barcode gescannt: ${c}`),C(),await Ms(be.groupIndex,be.itemId,c)),nt(!1),rt(null)}}catch{}}},500)},Qt=()=>{qe.current&&(clearInterval(qe.current),qe.current=null),Ut&&(Ut.getTracks().forEach(t=>t.stop()),_t(null)),G.current&&(G.current.srcObject=null),Ot(!1)},Fs=()=>{Qt(),nt(!1),rt(null)},Ds=(t,s)=>{ot({groupIndex:t,itemId:s}),lt(!0),setTimeout(()=>zs(),100)},zs=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){i.error("Kamera wird nicht unterstützt");return}const t=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});Wt(t),W.current&&(W.current.srcObject=t,await W.current.play()),C()}catch(t){i.error("Kamera-Fehler: "+N(t)),g()}},Es=async()=>{if(!(!W.current||!mt.current||!ct)){Vt(!0);try{const t=W.current,s=mt.current;s.width=t.videoWidth,s.height=t.videoHeight;const a=s.getContext("2d");if(a){a.drawImage(t,0,0);const r=s.toDataURL("image/jpeg");await Rs(ct.groupIndex,ct.itemId,r),Yt(),lt(!1),ot(null)}}catch(t){i.error("Fehler beim Erfassen: "+N(t)),g()}finally{Vt(!1)}}},Yt=()=>{Gt&&(Gt.getTracks().forEach(t=>t.stop()),Wt(null)),W.current&&(W.current.srcObject=null)},Ts=()=>{Yt(),lt(!1),ot(null)},Ms=async(t,s,a)=>{try{if(!y[t]?.items.find(M=>M.id===s))return;const o=y[t]?.store||"",x=await ze(De,"searchProductInfo")({articleNumber:a,store:o});x.data&&x.data.productInfo&&(T(t,s,"productInfo",x.data.productInfo),i.success("Produktinformationen gefunden"))}catch(r){console.log("Product info fetch failed:",r)}},Rs=async(t,s,a)=>{try{const r=y[t]?.items.find(M=>M.id===s);if(!r)return;const o=y[t]?.store||"",x=await ze(De,"analyzeProductImage")({imageData:a,store:o,articleNumber:r.articleNumber});x.data&&x.data.productInfo?(T(t,s,"productInfo",x.data.productInfo),x.data.articleNumber&&!r.articleNumber&&T(t,s,"articleNumber",x.data.articleNumber),i.success(n("shopping.productInfoRecognized")),C()):i.info(n("shopping.noProductInfo"))}catch(r){i.error(n("shopping.analysisError")+N(r)),g()}},qs=async(t,s)=>{Ps(t,s)},Bs=async(t,s)=>{Ds(t,s)},$s=async()=>{try{let t=0;for(const s of y){if(!s.store){i.error(n("shopping.storeRequired"));return}for(const a of s.items){if(!a.name.trim()){i.error(n("shopping.itemNameRequiredForAll"));return}await Ve({listId:p||void 0,item:a.name.trim(),quantity:parseInt(a.quantity)||1,category:a.category,estimatedPrice:parseFloat(a.price||"0")*100,currency:"CHF",store:s.store,articleNumber:a.articleNumber||null,productInfo:a.productInfo||null,saveToDatabase:a.saveToDatabase||!1}),t++}}i.success(n("shopping.itemsAdded",{count:t})),C(),Te(!1),_([]),await w()}catch(t){i.error(n("shopping.error")+N(t)),g()}},Zt=async()=>{if(!te.trim()){i.error(n("shopping.listNameRequired"));return}try{const t=await xa(te.trim(),f.length===0);i.success(n("shopping.listCreated")),C(),Ee(!1),se(""),ee(t.id)}catch(t){i.error(n("shopping.error")+N(t)),g()}},Hs=async t=>{if(f.length<=1){i.error(n("shopping.atLeastOneListRequired"));return}try{if(await fa(t),i.success(n("shopping.listDeleted")),C(),p===t){const s=f.find(a=>a.id!==t);ee(s?.id||null)}}catch(s){i.error(n("shopping.error")+N(s)),g()}},Os=async(t,s,a)=>{try{await pa(t,{name:s,isDefault:a}),i.success(n("shopping.listUpdated")),C(),Ze(null)}catch(r){i.error(n("shopping.error")+N(r)),g()}},ht=X(async(t,s)=>{const a=s==="bought"?"not_bought":"bought";ue(r=>r.map(o=>o.id===t?{...o,status:a,boughtAt:a==="bought"?new Date:null}:o)),wt();try{a==="bought"?await ma(t):await ua(t,{status:"not_bought"}),setTimeout(()=>w(),100)}catch(r){w(),i.error(N(r)),g()}},[w]),Jt=X(async t=>{ue(s=>s.filter(a=>a.id!==t)),ae(s=>new Set(s).add(t)),C();try{await yt(t),setTimeout(()=>w(),100)}catch(s){w(),i.error(N(s)),g()}finally{ae(s=>{const a=new Set(s);return a.delete(t),a})}},[w]),Us=X(async()=>{if(I.size===0){i.error(n("shopping.pleaseSelectAtLeastOne"));return}const t=Array.from(I);ue(s=>s.filter(a=>!I.has(a.id))),ae(s=>{const a=new Set(s);return t.forEach(r=>a.add(r)),a}),je(new Set),ut(!1),C();try{const s=t.map(a=>yt(a));await Promise.all(s),i.success(n("shopping.itemsDeleted",{count:t.length})),setTimeout(()=>w(),100)}catch(s){w(),i.error(N(s)),g()}finally{ae(s=>{const a=new Set(s);return t.forEach(r=>a.delete(r)),a})}},[I,w]),Xt=X(t=>{je(s=>{const a=new Set(s);return a.has(t)?a.delete(t):a.add(t),a}),wt()},[]),_s=X(()=>{const t=new Set([...ce.map(s=>s.id),...Q.map(s=>s.id)]);I.size===t.size?je(new Set):je(t),wt()},[ce,Q,I.size]),Ks=X(()=>{ut(!1),je(new Set)},[]),Vs=X(async()=>{const t=Q.map(s=>s.id);ue(s=>s.filter(a=>!t.includes(a.id))),ae(s=>{const a=new Set(s);return t.forEach(r=>a.add(r)),a}),C();try{const s=t.map(a=>yt(a));await Promise.all(s),i.success(n("shopping.boughtItemsDeleted")),setTimeout(()=>w(),100)}catch(s){w(),i.error(N(s)),g()}finally{ae(s=>{const a=new Set(s);return t.forEach(r=>a.delete(r)),a})}},[Q,w]),[Oa,Ne]=l("idle"),[Ua,es]=l(0),$=O(null),[_a,Gs]=l({topLeft:{x:10,y:15},topRight:{x:90,y:15},bottomLeft:{x:10,y:75},bottomRight:{x:90,y:75}}),[Ka,Va]=l(null),[Ga,Wa]=l(!1),ve=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){i.error("Kamera wird nicht unterstützt"),ne("upload");return}u&&(u.getTracks().forEach(a=>{a.stop()}),ge(null),await new Promise(a=>setTimeout(a,100))),b.current&&(b.current.srcObject=null);let t=null,s={video:{facingMode:"environment",width:{ideal:3840},height:{ideal:2160},aspectRatio:{ideal:16/9}},audio:!1};try{t=await navigator.mediaDevices.getUserMedia(s)}catch{s={video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}},audio:!1};try{t=await navigator.mediaDevices.getUserMedia(s)}catch{t=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1})}}if(!t||t.getVideoTracks().length===0)throw new Error("Kein Kamera-Stream erhalten");if(ge(t),Ne("scanning"),await new Promise(a=>setTimeout(a,50)),b.current){const a=b.current;a.srcObject=t,await new Promise((r,o)=>{const c=setTimeout(()=>{o(new Error("Video-Timeout"))},5e3),x=()=>{clearTimeout(c),a.removeEventListener("loadedmetadata",x),a.removeEventListener("error",M),r()},M=bt=>{clearTimeout(c),a.removeEventListener("loadedmetadata",x),a.removeEventListener("error",M),o(new Error("Video-Fehler"))};if(a.readyState>=2){clearTimeout(c),r();return}a.addEventListener("loadedmetadata",x,{once:!0}),a.addEventListener("error",M,{once:!0})});try{await a.play(),i.success("Kamera aktiv"),ts()}catch{i.success("Kamera aktiv"),ts()}}}catch(t){u&&(u.getTracks().forEach(r=>r.stop()),ge(null)),b.current&&(b.current.srcObject=null);const s=t;let a=n("shopping.cameraError");s.name==="NotAllowedError"||s.name==="PermissionDeniedError"?a=n("shopping.cameraPermissionDenied"):s.name==="NotFoundError"||s.name==="DevicesNotFoundError"?a=n("shopping.noCameraFound"):s.name==="NotReadableError"||s.name==="TrackStartError"?a=n("shopping.cameraInUse"):s.name==="OverconstrainedError"||s.name==="ConstraintNotSatisfiedError"?a=n("shopping.cameraNotSupported"):s.message==="Video-Timeout"?a=n("shopping.cameraInitSlow"):a=`${n("shopping.cameraError")}: ${s.message||s.name}`,i.error(a),ne("upload"),Ne("idle")}},xt=()=>{$.current&&(cancelAnimationFrame($.current),$.current=null),u&&(u.getTracks().forEach(t=>t.stop()),ge(null)),Ne("idle"),es(0)},ts=()=>{Gs({topLeft:{x:15,y:10},topRight:{x:85,y:10},bottomLeft:{x:15,y:85},bottomRight:{x:85,y:85}}),Ne("scanning"),es(0)},Ws=()=>{if(!b.current||!le.current)return;$.current&&(cancelAnimationFrame($.current),$.current=null),Ne("capturing");const t=b.current,s=le.current;s.width=t.videoWidth,s.height=t.videoHeight;const a=s.getContext("2d");a&&(a.imageSmoothingEnabled=!1,a.drawImage(t,0,0),i.success("Foto aufgenommen!"),s.toBlob(async r=>{if(r){xt();const o=new File([r],"photo.jpg",{type:"image/jpeg"});await ss(o)}},"image/jpeg",1))};oe(()=>()=>{!u&&b.current&&b.current.srcObject&&(b.current.srcObject.getTracks().forEach(s=>s.stop()),b.current.srcObject=null)},[u]),oe(()=>()=>{$.current&&(cancelAnimationFrame($.current),$.current=null),u&&(u.getTracks().forEach(t=>t.stop()),ge(null)),b.current&&(b.current.srcObject=null)},[]);const Qs=async t=>{const s=t.target.files?.[0];s&&await ss(s)},ss=async t=>{Z(!0),ie([]),et(null);try{const s=new FileReader;s.onload=async()=>{try{const a=s.result.split(",")[1];i.info("Analysiere mit OCR...");const c=(await ze(De,"analyzeReceipt")({fileData:a,fileType:t.type||"image/jpeg",fileName:t.name||"photo.jpg"})).data;c.success&&c.items&&c.items.length>0?(et({store:c.store||{name:"Unbekannt"},purchase:c.purchase||{},items:c.items,totals:c.totals||{total:0},confidence:c.confidence||50}),ie(c.items.map(x=>({...x,selected:!0}))),i.success(n("shopping.itemsRecognized",{count:c.items.length}))):c.error?.includes("Vision API")||c.error?.includes("PERMISSION_DENIED")?i.error(n("shopping.ocrNotAvailable"),{duration:5e3}):c.error?.includes("billing")?i.error(n("shopping.googleBillingRequired"),{duration:5e3}):c.rawText?i.error(n("shopping.textRecognizedNoItems"),{duration:4e3}):i.error(c.error||n("shopping.noItemsRecognizedBetterQuality"),{duration:4e3})}catch(a){i.error(N(a)),g()}Z(!1)},s.onerror=()=>{i.error("Datei konnte nicht gelesen werden"),g(),Z(!1)},s.readAsDataURL(t)}catch(s){i.error(N(s)),g(),Z(!1)}},[ft,we]=l(null),[P,as]=l(!1),[Be,$e]=l(null),[Ys,Zs]=l(0),[pt,ye]=l(new Set),[Qa,Js]=l([]),gt=async()=>{if(!b.current||!le.current||k)return;const t=Date.now();if(t-Ys<1500)return;Zs(t),Z(!0),we(null);const s=b.current,a=le.current,r=s.videoWidth||1920,o=s.videoHeight||1080,c=Math.max(r,1920),x=Math.max(o,1080);a.width=c,a.height=x;const M=a.getContext("2d",{willReadFrequently:!0,alpha:!1});M&&(M.drawImage(s,0,0,r,o,0,0,c,x),a.toBlob(async bt=>{if(bt)try{const He=new FileReader;He.onload=async()=>{const la=He.result.split(",")[1];try{const Ce=(await ze(De,"analyzeReceipt")({fileData:la,fileType:"image/jpeg",fileName:"live-scan-full.jpg"})).data;if(Ce.success&&Ce.items&&Ce.items.length>0){const jt=(Ce.rawText||"").split(/[\n\r]+/),Oe=Ce.items.map((j,H)=>{const Ue=(j.name||"Unbekannt").toLowerCase().trim(),Se=(j.unitPrice||j.totalPrice||0).toFixed(2),J=j.articleNumber||"";let Ie=-1;for(let R=0;R<jt.length;R++)if(jt[R].includes(j.name||"")||J&&jt[R].includes(J)){Ie=R;break}const L=`${Ue}_${Se}_${J}_${Ie>=0?Ie:H}_${H}`;return{item:{name:j.name||"Unbekannt",articleNumber:j.articleNumber,quantity:j.quantity||1,unitPrice:j.unitPrice||j.totalPrice||0,totalPrice:j.totalPrice||j.unitPrice*(j.quantity||1),selected:!0},positionId:L}}).filter(({positionId:j})=>!pt.has(j));if(Oe.length>0){const j=new Set(pt);Oe.forEach(({positionId:H})=>{j.add(H)}),ye(j),K(H=>{const Ue=new Set(H.map(L=>{const R=L.name.toLowerCase().trim(),_e=L.unitPrice.toFixed(2),Nt=L.articleNumber||"";return`${R}_${_e}_${Nt}`})),Se=[...H];let J=0;Oe.forEach(({item:L,positionId:R})=>{const _e=L.name.toLowerCase().trim(),Nt=L.unitPrice.toFixed(2),vt=L.articleNumber||"",os=`${_e}_${Nt}_${vt}`;Ue.has(os)||vt&&H.some(Ke=>Ke.articleNumber===vt)||H.some(Ke=>Ke.name.toLowerCase().trim()===_e&&Math.abs(Ke.unitPrice-L.unitPrice)<.01)||(Se.push(L),J++,Ue.add(os))});const Ie=Se.reduce((L,R)=>L+R.totalPrice,0);return V(Ie),J>0?(i.success(n("shopping.newItemsRecognized",{count:J}),{duration:1500}),navigator.vibrate&&navigator.vibrate(200)):Oe.length>0&&(P||i.info(n("shopping.allItemsAlreadyInList"),{duration:1e3})),Se})}else P||i.info(n("shopping.allItemsAlreadyRecognized"),{duration:1e3})}else P||we(n("shopping.noItemsRecognized"))}catch(ls){if(!P){const cs=N(ls);we(cs)}g()}Z(!1)},He.readAsDataURL(bt)}catch{g(),Z(!1)}},"image/jpeg",.95))};oe(()=>{if(P&&u&&re==="single"){const t=setTimeout(()=>{!k&&u&&gt()},500),s=setInterval(()=>{!k&&u&&gt()},2e3);return $e(s),()=>{clearInterval(s),clearTimeout(t),$e(null)}}else Be&&(clearInterval(Be),$e(null))},[P,u,re,k]);const Xs=async()=>{await gt()},ea=()=>{if(!E)return;const t={...E,quantity:fe,totalPrice:E.unitPrice*fe};K(s=>[...s,t]),V(s=>s+t.totalPrice),Re(null),pe(1),i.success(`${t.name} (${fe}x) hinzugefügt`),C()},ta=()=>{Re(null),pe(1)},ns=t=>{K(s=>{const a=s[t];return V(r=>r-a.totalPrice),s.filter((r,o)=>o!==t)})},rs=(t,s)=>{if(s<1){ns(t);return}K(a=>{const r=[...a],o=r[t],c=o.totalPrice;return r[t]={...o,quantity:s,totalPrice:o.unitPrice*s},V(x=>x-c+r[t].totalPrice),r})},sa=async()=>{if(z.length===0){i.error(n("shopping.noItemsScanned"));return}try{for(const t of z)await Ve({listId:p||void 0,item:t.name,quantity:t.quantity||1,category:is(t.name),estimatedPrice:(t.totalPrice||t.unitPrice||0)*100,currency:"CHF",store:d?.store?.name||null});i.success(n("shopping.itemsAdded",{count:z.length})),K([]),V(0),ke(),await w()}catch(t){i.error(n("shopping.error")+t.message)}},aa=async()=>{const t=D.filter(s=>s.selected);if(t.length===0){i.error(n("shopping.pleaseSelectAtLeastOne"));return}try{for(const s of t)await Ve({listId:p||void 0,item:s.name,quantity:s.quantity||1,category:is(s.name),estimatedPrice:(s.totalPrice||s.unitPrice||0)*100,currency:"CHF",store:d?.store?.name||null});i.success(n("shopping.itemsAdded",{count:t.length})),ke(),await w()}catch(s){i.error(n("shopping.error")+s.message)}},na=async()=>{if(d)try{await ze(De,"saveReceipt")({receiptData:d}),i.success(n("shopping.receiptSaved"))}catch(t){i.error(n("shopping.error")+t.message)}},ra=async()=>{if(d)try{await ga({type:"ausgabe",amount:d.totals.total*100,category:n("shopping.categories.food"),notes:`${n("shopping.purchaseAt")} ${d.store.name}`,date:d.purchase.date||new Date().toISOString().split("T")[0],paymentMethod:d.purchase.paymentMethod||"Karte",currency:"CHF",isRecurring:!1}),i.success(n("shopping.addedToFinance")),C(),ke()}catch(t){i.error(N(t)),g()}},is=t=>{const s=t.toLowerCase(),a={Getränke:["bier","wein","saft","wasser","cola","fanta","sprite","energy","shot","drink"],"Obst & Gemüse":["apfel","orange","banane","tomate","salat","gurke","karotte","bio oran","gemüse"],Milchprodukte:["milch","joghurt","käse","butter","sahne","quark","naturejog"],Fleisch:["fleisch","steak","wurst","schinken","poulet","rind","schwein","ragout"],Backwaren:["brot","brötchen","toast","croissant","kuchen","keks","butterkeks"],Süsswaren:["schoko","bonbon","gummi","chips","zucker","gelatine"]};for(const[r,o]of Object.entries(a))if(o.some(c=>s.includes(c)))return r;return n("shopping.categories.food")},ia=()=>{qt(!0),ie([]),ne("camera"),setTimeout(()=>ve(),100)},ke=()=>{xt(),qt(!1),ie([]),et(null),K([]),V(0),Me("receipt"),Re(null),pe(1),we(null),as(!1),ye(new Set),Js([]),Be&&(clearInterval(Be),$e(null))};return e.jsxs(Na,{title:n("nav.shopping","Einkaufsliste"),showSidebar:!0,children:[e.jsx("div",{className:"mb-4 flex items-center gap-2",children:A?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsx(h,{variant:"outline",size:"sm",onClick:_s,className:"h-11",children:I.size===ce.length+Q.length?n("shopping.deselectAll"):n("shopping.selectAll")}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[I.size," ",n("shopping.selected")]})]}),e.jsx(h,{variant:"outline",size:"icon",onClick:Ks,className:"h-11 w-11",children:e.jsx(B,{className:"w-5 h-5"})}),I.size>0&&e.jsx(h,{variant:"destructive",size:"icon",onClick:Us,className:"h-11 w-11",children:e.jsx(de,{className:"w-5 h-5"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{value:p||"",onValueChange:t=>ee(t),disabled:me,children:[e.jsx(Le,{className:"flex-1 h-11",children:e.jsx(Ae,{placeholder:"Liste wählen"})}),e.jsx(Fe,{children:f.map(t=>e.jsxs(v,{value:t.id,children:[t.name," ",t.isDefault&&n("shopping.standard")]},t.id))})]}),e.jsx(h,{variant:"outline",size:"icon",onClick:()=>F(!0),className:"h-11 w-11",children:e.jsx(At,{className:"w-5 h-5"})}),e.jsx(h,{variant:"outline",size:"icon",onClick:()=>ut(!0),className:"h-11 w-11",children:e.jsx(q,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"mobile-card mb-4 bg-primary text-primary-foreground",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Ft,{className:"w-6 h-6 opacity-70"}),e.jsx("p",{className:"text-sm opacity-70 font-medium",children:f.find(t=>t.id===p)?.name||n("shopping.list","Einkaufsliste")})]}),e.jsx("p",{className:"text-3xl font-semibold mb-2",children:ce.length}),e.jsx("p",{className:"text-sm opacity-60",children:n("shopping.itemsOpen")})]}),gs?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:n("common.loading","Laden...")}):ce.length===0?e.jsxs("div",{className:"mobile-card text-center py-8",children:[e.jsx(q,{className:"w-10 h-10 mx-auto status-success mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:n("shopping.empty")})]}):e.jsx("div",{className:"space-y-3 mb-4",children:ce.map(t=>{const s=[{id:"mark-bought",label:n("shopping.markAsBought","Als gekauft markieren"),icon:e.jsx(q,{className:"w-4 h-4"}),onClick:()=>ht(t.id,t.status)},{id:"delete",label:n("common.delete","Löschen"),icon:e.jsx(de,{className:"w-4 h-4"}),onClick:()=>Jt(t.id),variant:"destructive"}];return e.jsx($a,{actions:s,disabled:A,children:e.jsxs("div",{className:`mobile-card flex items-center gap-4 py-3 ${A&&I.has(t.id)?"ring-2 ring-primary":""}`,onClick:A?()=>Xt(t.id):void 0,children:[A?e.jsx("div",{className:"w-6 h-6 rounded border-2 border-border flex items-center justify-center shrink-0",children:I.has(t.id)&&e.jsx(q,{className:"w-4 h-4 text-primary"})}):e.jsx("button",{onClick:()=>ht(t.id,t.status),className:"w-6 h-6 rounded border-2 border-border flex items-center justify-center shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:t.item}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.quantity>1&&`${t.quantity}x • `,t.category,t.store&&` • ${t.store}`]})]}),!A&&e.jsx("button",{onClick:()=>Jt(t.id),className:"w-10 h-10 rounded-lg flex items-center justify-center text-muted-foreground active:opacity-80",children:e.jsx(de,{className:"w-4 h-4"})})]})},t.id)})}),Q.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:[n("shopping.bought","Eingekauft")," (",Q.length,")"]}),!A&&e.jsx("button",{onClick:Vs,className:"text-xs status-error active:opacity-80",children:n("shopping.clearBought","Löschen")})]}),e.jsx("div",{className:"space-y-3 opacity-60",children:Q.map(t=>e.jsxs("div",{className:`mobile-card flex items-center gap-4 py-3 ${A&&I.has(t.id)?"ring-2 ring-primary opacity-100":""}`,onClick:A?()=>Xt(t.id):void 0,children:[A?e.jsx("div",{className:"w-6 h-6 rounded border-2 border-border flex items-center justify-center shrink-0",children:I.has(t.id)&&e.jsx(q,{className:"w-4 h-4 text-primary"})}):e.jsx("button",{onClick:()=>ht(t.id,t.status),className:"w-6 h-6 rounded bg-status-success flex items-center justify-center shrink-0",children:e.jsx(q,{className:"w-4 h-4 status-success"})}),e.jsx("p",{className:"font-medium line-through flex-1 truncate",children:t.item})]},t.id))})]}),Tt&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-end",children:e.jsxs("div",{className:"bg-background w-full rounded-t-2xl p-6 safe-bottom animate-in slide-in-from-bottom",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Artikel hinzufügen"}),e.jsx("button",{onClick:()=>Xe(!1),className:"w-10 h-10 rounded-lg bg-muted flex items-center justify-center",children:e.jsx(B,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsx(Y,{value:S.name,onChange:t=>he({...S,name:t.target.value}),placeholder:"Artikelname",className:"mobile-input",autoFocus:!0})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-20",children:e.jsx(Y,{type:"number",value:S.quantity,onChange:t=>he({...S,quantity:t.target.value}),placeholder:"1",className:"mobile-input text-center",min:"1"})}),e.jsx("div",{className:"flex-1",children:e.jsxs(Pe,{value:S.category,onValueChange:t=>he({...S,category:t}),children:[e.jsx(Le,{className:"mobile-input",children:e.jsx(Ae,{})}),e.jsx(Fe,{children:xs(n).map(t=>e.jsx(v,{value:t,children:t},t))})]})})]}),e.jsx("div",{children:e.jsxs(Pe,{value:S.store||"none",onValueChange:t=>he({...S,store:t==="none"?"":t}),children:[e.jsx(Le,{className:"mobile-input",children:e.jsx(Ae,{placeholder:"Laden (optional)"})}),e.jsxs(Fe,{children:[e.jsx(v,{value:"none",children:"Kein Laden"}),e.jsx(v,{value:"Migros",children:"Migros"}),e.jsx(v,{value:"Coop",children:"Coop"}),e.jsx(v,{value:"Aldi",children:"Aldi"}),e.jsx(v,{value:"Lidl",children:"Lidl"}),e.jsx(v,{value:"Denner",children:"Denner"})]})]})}),e.jsx(h,{onClick:ws,className:"w-auto mx-auto mobile-btn bg-primary text-primary-foreground mt-4",children:"Hinzufügen"})]})]})}),e.jsx(kt,{open:Mt,onOpenChange:Te,children:e.jsxs(Ct,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[90vw] !max-w-2xl !max-h-[90vh] !rounded-3xl !m-0 !overflow-hidden !shadow-2xl !flex !flex-col",children:[e.jsxs(St,{className:"px-5 pt-5 pb-3 flex-shrink-0",children:[e.jsx(It,{className:"text-lg font-semibold",children:"Mehrere Artikel hinzufügen"}),e.jsx(Pt,{className:"sr-only",children:"Fügen Sie mehrere Artikel gruppiert nach Laden hinzu"})]}),e.jsxs("div",{className:"px-5 pb-2 overflow-y-auto flex-1 min-h-0 space-y-4",children:[y.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Ge,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Keine Laden-Gruppen vorhanden"}),e.jsx("p",{className:"text-sm mt-1",children:'Klicken Sie auf "Laden hinzufügen" um zu beginnen'})]}),y.map((t,s)=>e.jsxs("div",{className:"border rounded-xl p-4 space-y-3 bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs(Pe,{value:t.store||"none",onValueChange:a=>Cs(s,a==="none"?"":a),children:[e.jsx(Le,{className:"flex-1 h-9",children:e.jsx(Ae,{placeholder:"Laden wählen"})}),e.jsxs(Fe,{children:[e.jsx(v,{value:"none",children:"Laden wählen"}),e.jsx(v,{value:"Migros",children:"Migros"}),e.jsx(v,{value:"Coop",children:"Coop"}),e.jsx(v,{value:"Aldi",children:"Aldi"}),e.jsx(v,{value:"Lidl",children:"Lidl"}),e.jsx(v,{value:"Denner",children:"Denner"}),e.jsx(v,{value:"Volg",children:"Volg"}),e.jsx(v,{value:"Spar",children:"Spar"})]})]}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>ks(s),className:"h-9 w-9 p-0",children:e.jsx(B,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-2",children:[t.items.map(a=>e.jsx("div",{className:"bg-background rounded-lg p-3 space-y-2 border",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Y,{placeholder:"Artikelname *",value:a.name,onChange:r=>T(s,a.id,"name",r.target.value),className:"flex-1 h-9"}),e.jsx(Y,{type:"number",placeholder:"Menge",value:a.quantity,onChange:r=>T(s,a.id,"quantity",r.target.value),className:"w-20 h-9",min:"1"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Pe,{value:a.category,onValueChange:r=>T(s,a.id,"category",r),children:[e.jsx(Le,{className:"flex-1 h-9",children:e.jsx(Ae,{})}),e.jsx(Fe,{children:xs(n).map(r=>e.jsx(v,{value:r,children:r},r))})]}),e.jsx(Y,{type:"number",step:"0.01",placeholder:"Preis (CHF)",value:a.price,onChange:r=>T(s,a.id,"price",r.target.value),className:"w-24 h-9"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Y,{placeholder:"Artikelnummer (EAN/Barcode)",value:a.articleNumber,onChange:r=>T(s,a.id,"articleNumber",r.target.value),className:"flex-1 h-9"}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>qs(s,a.id),className:"h-9",title:"Barcode scannen",children:e.jsx(Ia,{className:"w-4 h-4"})}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>Bs(s,a.id),className:"h-9",title:"Produktinfo scannen",children:e.jsx(We,{className:"w-4 h-4"})})]}),a.productInfo&&e.jsxs("div",{className:"bg-muted/50 rounded p-2 text-xs space-y-1",children:[a.productInfo.brand&&e.jsxs("p",{children:[e.jsx("strong",{children:"Marke:"})," ",a.productInfo.brand]}),a.productInfo.description&&e.jsxs("p",{children:[e.jsx("strong",{children:"Beschreibung:"})," ",a.productInfo.description]}),a.productInfo.price&&e.jsxs("p",{children:[e.jsx("strong",{children:"Preis:"})," CHF ",a.productInfo.price]}),a.productInfo.imageUrl&&e.jsx("img",{src:a.productInfo.imageUrl,alt:"Produkt",className:"w-full h-24 object-contain mt-2 rounded"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ha,{checked:a.saveToDatabase||!1,onCheckedChange:r=>T(s,a.id,"saveToDatabase",r)}),e.jsx(ds,{className:"text-xs",children:"Für zukünftige Käufe speichern"})]})]}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>Is(s,a.id),className:"h-9 w-9 p-0",children:e.jsx(de,{className:"w-4 h-4"})})]})},a.id)),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>Ss(s),className:"w-full h-9",children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Artikel hinzufügen"]})]})]},s)),e.jsxs(h,{variant:"outline",onClick:ys,className:"w-full",children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"}),"Laden hinzufügen"]})]}),e.jsxs(Lt,{className:"px-5 pb-3 pt-2 gap-2.5 flex-shrink-0",children:[e.jsx(h,{variant:"outline",onClick:()=>{Te(!1),_([])},className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:"Abbrechen"}),e.jsxs(h,{onClick:$s,disabled:y.length===0||y.every(t=>t.items.length===0),className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:[y.reduce((t,s)=>t+s.items.length,0)," Artikel hinzufügen"]})]})]})}),Rt&&e.jsxs("div",{className:"fixed inset-0 z-50 bg-black flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-black/50",children:[e.jsx("h2",{className:"text-white font-semibold",children:"Liste scannen"}),e.jsx("button",{onClick:ke,className:"w-10 h-10 rounded-lg bg-white/20 flex items-center justify-center",children:e.jsx(B,{className:"w-5 h-5 text-white"})})]}),e.jsxs("div",{className:"flex gap-2 px-4 py-2",children:[e.jsxs("button",{onClick:()=>{Me("receipt"),ne("camera"),ve()},className:`flex-1 py-2 px-3 rounded-lg flex items-center justify-center gap-1.5 text-sm ${re==="receipt"&&xe==="camera"?"bg-white text-black":"bg-white/20 text-white"}`,children:[e.jsx(Pa,{className:"w-4 h-4"}),"Quittung"]}),e.jsxs("button",{onClick:async()=>{Me("single"),ne("camera"),K([]),V(0),ye(new Set),Re(null),we(null),await ve()},className:`flex-1 py-2 px-3 rounded-lg flex items-center justify-center gap-1.5 text-sm ${re==="single"?"bg-white text-black":"bg-white/20 text-white"}`,children:[e.jsx(Ye,{className:"w-4 h-4"}),"Einzeln"]}),e.jsxs("button",{onClick:()=>{Me("receipt"),ne("upload"),xt()},className:`flex-1 py-2 px-3 rounded-lg flex items-center justify-center gap-1.5 text-sm ${xe==="upload"?"bg-white text-black":"bg-white/20 text-white"}`,children:[e.jsx(La,{className:"w-4 h-4"}),"Upload"]})]}),xe==="camera"&&re==="receipt"&&D.length===0&&e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("video",{ref:b,autoPlay:!0,playsInline:!0,muted:!0,preload:"auto",className:"absolute inset-0 w-full h-full object-cover"}),e.jsx("canvas",{ref:le,className:"hidden"}),u&&e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute inset-8 border-2 border-white/60 rounded-lg"}),e.jsx("div",{className:"absolute top-8 left-8 w-6 h-6 border-t-4 border-l-4 border-white rounded-tl"}),e.jsx("div",{className:"absolute top-8 right-8 w-6 h-6 border-t-4 border-r-4 border-white rounded-tr"}),e.jsx("div",{className:"absolute bottom-8 left-8 w-6 h-6 border-b-4 border-l-4 border-white rounded-bl"}),e.jsx("div",{className:"absolute bottom-8 right-8 w-6 h-6 border-b-4 border-r-4 border-white rounded-br"})]}),e.jsx("div",{className:"absolute top-4 left-4 right-4 z-20",children:e.jsx("div",{className:"bg-black/60 rounded-lg p-3 text-center",children:e.jsx("p",{className:"text-white text-sm font-medium",children:k?"Analysiere...":"Quittung fotografieren"})})}),e.jsx("div",{className:"absolute bottom-8 left-0 right-0 z-20",children:u?e.jsxs("div",{className:"flex justify-center items-center gap-4",children:[e.jsx("button",{onClick:ke,className:"w-12 h-12 rounded-full bg-white/20 flex items-center justify-center active:opacity-80",children:e.jsx(B,{className:"w-6 h-6 text-white"})}),e.jsx("button",{onClick:Ws,disabled:k,className:"w-20 h-20 rounded-full bg-white shadow-lg flex items-center justify-center active:opacity-80 border-4 border-white/50",children:k?e.jsx("div",{className:"w-8 h-8 border-3 border-gray-300 border-t-gray-600 rounded-full animate-spin"}):e.jsx("div",{className:"w-14 h-14 rounded-full bg-white"})}),e.jsx("div",{className:"w-12 h-12"})]}):e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:ve,className:"px-6 py-3 rounded-full bg-white shadow-lg flex items-center justify-center gap-2 active:opacity-80",children:[e.jsx(We,{className:"w-5 h-5 text-gray-800"}),e.jsx("span",{className:"font-medium text-gray-800",children:"Kamera starten"})]})})})]}),xe==="camera"&&re==="single"&&e.jsxs("div",{className:"flex-1 flex flex-col bg-background w-full h-full overflow-hidden",children:[e.jsx("div",{className:"w-full px-4 py-3 bg-background/95 backdrop-blur-sm border-b border-border/50 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${u?"bg-green-500 animate-pulse":"bg-gray-400"}`}),e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:u?"Kamera aktiv":"Kamera inaktiv"})]}),e.jsx("p",{className:"text-sm font-bold truncate",children:k?"Analysiere...":P?`${pt.size} Positionen erkannt`:z.length>0?`${z.length} Artikel gescannt`:"Bereit zum Scannen"})]}),e.jsxs("button",{onClick:()=>as(!P),disabled:!u,className:`px-3 py-2 rounded-lg flex items-center gap-1.5 flex-shrink-0 transition-all ${P&&u?"bg-green-500 text-white shadow-lg":"bg-muted text-muted-foreground"} ${u?"":"opacity-50"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${P&&u?"bg-white":"bg-foreground/50"}`}),e.jsx("span",{className:"text-xs font-semibold",children:"Auto"})]})]})}),e.jsxs("div",{className:"flex-1 flex flex-col w-full overflow-hidden min-h-0 relative",children:[e.jsxs("div",{className:"relative bg-black w-full flex-1 flex-shrink-0 min-h-0",children:[e.jsx("video",{ref:b,autoPlay:!0,playsInline:!0,muted:!0,preload:"auto",className:"absolute inset-0 w-full h-full object-cover",style:{minWidth:"100%",minHeight:"100%"}}),e.jsx("canvas",{ref:le,className:"hidden"}),u&&P&&e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[k&&e.jsx("div",{className:"absolute left-0 right-0 h-1 bg-green-500/50",style:{top:"50%",animation:"scan-line 1.5s ease-in-out infinite",boxShadow:"0 0 20px rgba(16, 185, 129, 0.6)",transform:"translateY(-50%)"}}),e.jsx("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 z-10",children:e.jsxs("div",{className:"bg-green-500/90 backdrop-blur-sm text-white px-4 py-2 rounded-full text-xs font-semibold flex items-center gap-2 shadow-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),k?"Analysiere...":`Live-Scan (${z.length} Artikel)`]})})]}),u&&!P&&e.jsx("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 z-10",children:e.jsx("div",{className:"bg-black/60 backdrop-blur-sm text-white px-4 py-2 rounded-full text-xs font-medium",children:"Quittung vollständig sichtbar machen"})}),u&&!E&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 z-20 p-4 bg-gradient-to-t from-black/80 via-black/40 to-transparent",children:e.jsx("button",{onClick:Xs,disabled:k,className:`w-full py-4 rounded-xl shadow-2xl flex items-center justify-center gap-3 transition-all transform ${k?"bg-gray-600/90":"bg-green-500 hover:bg-green-600 active:scale-95"}`,children:k?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{className:"font-bold text-white text-lg",children:"Analysiere..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"w-6 h-6 text-white"}),e.jsx("span",{className:"font-bold text-white text-lg",children:"ALLE SCANNEN"})]})})}),!u&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-b from-black/90 to-black/70",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center",children:e.jsx(We,{className:"w-10 h-10 text-white"})}),e.jsx("p",{className:"text-white text-lg font-semibold mb-2",children:"Kamera starten"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Für das Scannen von Quittungen"})]}),e.jsxs("button",{onClick:ve,className:"px-8 py-4 rounded-xl bg-white shadow-2xl flex items-center justify-center gap-3 hover:bg-gray-50 active:scale-95 transition-all",children:[e.jsx(We,{className:"w-6 h-6 text-gray-800"}),e.jsx("span",{className:"font-bold text-gray-800 text-base",children:"Kamera aktivieren"})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto bg-background w-full p-4 min-h-0",children:[ft&&!E&&e.jsxs("div",{className:"mb-4 p-4 bg-red-500/10 border border-red-500/30 rounded-xl backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),e.jsx("p",{className:"text-red-600 font-semibold text-sm",children:"Fehler"})]}),e.jsx("p",{className:"text-red-600 font-medium text-center text-sm",children:ft}),e.jsx("p",{className:"text-red-500/70 text-xs text-center mt-1",children:"Quittung näher halten und erneut scannen"})]}),E&&e.jsxs("div",{className:"mb-4 p-5 bg-green-500/10 border border-green-500/40 rounded-xl backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),e.jsx("p",{className:"text-green-600 font-bold text-sm",children:"ERKANNT"})]}),e.jsxs("div",{className:"bg-background/80 backdrop-blur-sm rounded-lg p-4 mb-4 border border-border/50",children:[e.jsx("p",{className:"font-bold text-base mb-1",children:E.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["CHF ",E.unitPrice.toFixed(2)," pro Stück"]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4",children:[e.jsx("button",{onClick:()=>pe(t=>Math.max(1,t-1)),className:"w-11 h-11 rounded-full bg-muted flex items-center justify-center text-xl font-bold active:scale-95 transition-transform",children:"−"}),e.jsx("div",{className:"w-16 h-11 rounded-lg bg-background border border-border flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold",children:fe})}),e.jsx("button",{onClick:()=>pe(t=>t+1),className:"w-11 h-11 rounded-full bg-muted flex items-center justify-center text-xl font-bold active:scale-95 transition-transform",children:"+"})]}),e.jsxs("div",{className:"text-center mb-4 p-3 bg-background/50 rounded-lg border border-border/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Total"}),e.jsxs("p",{className:"text-xl font-bold",children:["CHF ",(E.unitPrice*fe).toFixed(2)]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:ta,className:"flex-1 py-3 rounded-lg bg-muted flex items-center justify-center gap-2 text-sm font-semibold active:scale-95 transition-transform",children:[e.jsx(B,{className:"w-4 h-4"}),"Abbrechen"]}),e.jsxs("button",{onClick:ea,className:"flex-1 py-3 rounded-lg bg-green-500 text-white flex items-center justify-center gap-2 text-sm font-semibold shadow-lg active:scale-95 transition-transform",children:[e.jsx(q,{className:"w-4 h-4"}),"Hinzufügen"]})]})]}),!E&&z.length===0&&!ft&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-muted/50 flex items-center justify-center",children:e.jsx(Ye,{className:"w-8 h-8 text-muted-foreground/40"})}),e.jsx("p",{className:"text-base font-bold text-foreground mb-2",children:"Artikel scannen"}),e.jsx("p",{className:"text-xs text-muted-foreground/70 px-4",children:P?e.jsx(e.Fragment,{children:"Auto-Scan aktiv: Quittung in den Rahmen halten"}):e.jsx(e.Fragment,{children:'Quittung in den Rahmen halten und "ALLE SCANNEN" drücken'})})]}),z.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 p-3 bg-green-500/10 rounded-xl border border-green-500/30 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center",children:e.jsx(Ft,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Gesamt"}),e.jsxs("p",{className:"font-bold text-sm",children:[z.reduce((t,s)=>t+s.quantity,0)," Artikel"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total"}),e.jsxs("p",{className:"text-xl font-bold text-green-600",children:["CHF ",bs.toFixed(2)]})]})]}),e.jsx("div",{className:"space-y-2.5 mb-3",children:z.map((t,s)=>e.jsxs("div",{className:"p-3 bg-muted/80 backdrop-blur-sm rounded-xl border border-border/50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2.5",children:[e.jsxs("div",{className:"flex items-center gap-2.5 flex-1 min-w-0",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-green-500 text-white text-xs font-bold flex items-center justify-center flex-shrink-0 shadow-sm",children:t.quantity}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-sm mb-0.5 truncate",children:t.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["CHF ",t.unitPrice.toFixed(2)," pro Stück"]})]})]}),e.jsx("button",{onClick:()=>ns(s),className:"w-8 h-8 rounded-full bg-red-500/10 flex items-center justify-center flex-shrink-0 active:scale-95 transition-transform",children:e.jsx(B,{className:"w-4 h-4 text-red-500"})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>rs(s,t.quantity-1),className:"w-9 h-9 rounded-full bg-background border border-border flex items-center justify-center text-lg font-bold active:scale-95 transition-transform",children:"−"}),e.jsx("div",{className:"w-10 h-9 rounded-lg bg-background border border-border flex items-center justify-center",children:e.jsx("span",{className:"text-lg font-bold",children:t.quantity})}),e.jsx("button",{onClick:()=>rs(s,t.quantity+1),className:"w-9 h-9 rounded-full bg-background border border-border flex items-center justify-center text-lg font-bold active:scale-95 transition-transform",children:"+"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total"}),e.jsxs("p",{className:"font-bold text-base",children:["CHF ",t.totalPrice.toFixed(2)]})]})]})]},s))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{ye(new Set),i.success("Positionen zurückgesetzt")},className:"px-3 py-2.5 rounded-lg bg-muted flex items-center justify-center gap-1.5 text-xs font-semibold active:scale-95 transition-transform",children:[e.jsx(Aa,{className:"w-3.5 h-3.5"}),"Reset"]}),e.jsxs("button",{onClick:()=>{K([]),V(0),ye(new Set)},className:"flex-1 py-2.5 rounded-lg bg-muted flex items-center justify-center gap-1.5 text-xs font-semibold active:scale-95 transition-transform",children:[e.jsx(de,{className:"w-3.5 h-3.5"}),"Alle löschen"]}),e.jsxs("button",{onClick:sa,className:"flex-1 py-2.5 rounded-lg bg-primary text-primary-foreground flex items-center justify-center gap-1.5 text-xs font-semibold shadow-lg active:scale-95 transition-transform",children:[e.jsx(q,{className:"w-3.5 h-3.5"}),"Fertig"]})]})]})]})]})]}),xe==="upload"&&D.length===0&&e.jsxs("div",{className:"flex-1 flex items-center justify-center p-4",children:[e.jsxs("button",{onClick:()=>Bt.current?.click(),className:"w-full max-w-sm p-8 border-2 border-dashed border-white/30 rounded-xl text-center",children:[e.jsx(At,{className:"w-12 h-12 mx-auto text-white/50 mb-4"}),e.jsx("p",{className:"text-white font-medium",children:"Foto auswählen"}),e.jsx("p",{className:"text-white/50 text-sm mt-2",children:"JPG, PNG oder PDF"})]}),e.jsx("input",{ref:Bt,type:"file",accept:"image/*,application/pdf",capture:"environment",className:"hidden",onChange:Qs})]}),k&&e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-2 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white",children:"Analysiere Liste..."})]})}),d&&D.length>0&&e.jsx("div",{className:"flex-1 bg-background overflow-y-auto",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"bg-muted rounded-xl overflow-hidden",children:[e.jsxs("button",{onClick:()=>js(!tt),className:"w-full p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-medium",children:"Geschäft"})]}),tt?e.jsx(Dt,{className:"w-4 h-4"}):e.jsx(zt,{className:"w-4 h-4"})]}),tt&&e.jsxs("div",{className:"px-3 pb-3 space-y-1",children:[e.jsx("p",{className:"font-semibold text-lg",children:d.store.name}),d.store.address&&e.jsx("p",{className:"text-sm text-muted-foreground",children:d.store.address}),d.store.city&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:[d.store.postalCode," ",d.store.city]}),e.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-muted-foreground",children:[d.purchase.date&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Fa,{className:"w-3 h-3"}),new Date(d.purchase.date).toLocaleDateString("de-CH")]}),d.purchase.time&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Da,{className:"w-3 h-3"}),d.purchase.time]})]})]})]}),e.jsxs("div",{className:"bg-muted rounded-xl overflow-hidden",children:[e.jsxs("button",{onClick:()=>Ns(!st),className:"w-full p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ft,{className:"w-4 h-4 text-primary"}),e.jsxs("span",{className:"font-medium",children:["Artikel (",D.length,")"]}),e.jsxs("span",{className:"text-xs bg-primary text-primary-foreground px-2 py-0.5 rounded-full",children:[D.filter(t=>t.selected).length," ausgewählt"]})]}),st?e.jsx(Dt,{className:"w-4 h-4"}):e.jsx(zt,{className:"w-4 h-4"})]}),st&&e.jsxs("div",{className:"px-3 pb-3",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsx("button",{onClick:()=>ie(t=>t.map(s=>({...s,selected:!D.every(a=>a.selected)}))),className:"text-xs text-primary",children:D.every(t=>t.selected)?"Alle abwählen":"Alle auswählen"})}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:D.map((t,s)=>e.jsx("div",{className:`p-2.5 rounded-lg border ${t.selected?"bg-background border-primary":"bg-background/50 border-border"}`,onClick:()=>ie(a=>a.map((r,o)=>o===s?{...r,selected:!r.selected}:r)),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-5 h-5 rounded border-2 ${t.selected?"bg-primary border-primary":"border-border"} flex items-center justify-center shrink-0`,children:t.selected&&e.jsx(q,{className:"w-3 h-3 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.articleNumber&&e.jsxs("span",{className:"mr-2",children:["#",t.articleNumber]}),t.quantity,"x à CHF ",t.unitPrice.toFixed(2)]})]}),e.jsxs("p",{className:"font-semibold text-sm shrink-0",children:["CHF ",t.totalPrice.toFixed(2)]})]})},s))})]})]}),e.jsxs("div",{className:"bg-muted rounded-xl overflow-hidden",children:[e.jsxs("button",{onClick:()=>vs(!at),className:"w-full p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(us,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-medium",children:"Zahlung"})]}),at?e.jsx(Dt,{className:"w-4 h-4"}):e.jsx(zt,{className:"w-4 h-4"})]}),at&&e.jsxs("div",{className:"px-3 pb-3 space-y-2",children:[d.totals.subtotal&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Zwischensumme"}),e.jsxs("span",{children:["CHF ",d.totals.subtotal.toFixed(2)]})]}),d.totals.rounding&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Rundung"}),e.jsxs("span",{children:["CHF ",d.totals.rounding.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-semibold text-lg pt-2 border-t",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["CHF ",d.totals.total.toFixed(2)]})]}),d.purchase.paymentMethod&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(us,{className:"w-3 h-3"}),d.purchase.paymentMethod]})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-muted-foreground",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${d.confidence>=70?"bg-green-500":d.confidence>=40?"bg-yellow-500":"bg-red-500"}`}),"Erkennungsqualität: ",d.confidence,"%"]}),e.jsxs("div",{className:"space-y-2 pt-2",children:[e.jsxs(h,{onClick:aa,className:"w-full",children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),D.filter(t=>t.selected).length," Artikel zur Liste"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(h,{variant:"outline",onClick:na,className:"flex-1",children:[e.jsx(za,{className:"w-4 h-4 mr-1"}),"Speichern"]}),e.jsxs(h,{variant:"outline",onClick:ra,className:"flex-1",children:[e.jsx(Ea,{className:"w-4 h-4 mr-1"}),"Zu Finanzen"]})]})]})]})})]}),$t&&e.jsxs("div",{className:"fixed inset-0 z-[100] bg-black flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-black/50",children:[e.jsx("h2",{className:"text-white font-semibold",children:"Barcode scannen"}),e.jsx("button",{onClick:Fs,className:"w-10 h-10 rounded-lg bg-white/20 flex items-center justify-center",children:e.jsx(B,{className:"w-5 h-5 text-white"})})]}),e.jsxs("div",{className:"flex-1 relative flex items-center justify-center",children:[e.jsx("video",{ref:G,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),e.jsx("canvas",{ref:it,className:"hidden"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-64 h-32 border-2 border-white rounded-lg"})}),Ht&&e.jsx("div",{className:"absolute bottom-20 left-0 right-0 text-center",children:e.jsx("p",{className:"text-white bg-black/50 px-4 py-2 rounded-lg inline-block",children:"Barcode in den Rahmen positionieren"})})]})]}),Kt&&e.jsxs("div",{className:"fixed inset-0 z-[100] bg-black flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-black/50",children:[e.jsx("h2",{className:"text-white font-semibold",children:"Produkt fotografieren"}),e.jsx("button",{onClick:Ts,className:"w-10 h-10 rounded-lg bg-white/20 flex items-center justify-center",children:e.jsx(B,{className:"w-5 h-5 text-white"})})]}),e.jsxs("div",{className:"flex-1 relative flex items-center justify-center",children:[e.jsx("video",{ref:W,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),e.jsx("canvas",{ref:mt,className:"hidden"}),dt&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-2 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white",children:"Analysiere Produkt..."})]})})]}),e.jsx("div",{className:"p-4 bg-black/50",children:e.jsx(h,{onClick:Es,disabled:dt,className:"w-full bg-primary text-primary-foreground",children:dt?"Analysiere...":"Foto aufnehmen"})})]}),e.jsx(kt,{open:m,onOpenChange:F,children:e.jsxs(Ct,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-[90vh] !rounded-3xl !m-0 !overflow-hidden !shadow-2xl !flex !flex-col",children:[e.jsxs(St,{className:"px-5 pt-5 pb-3 flex-shrink-0",children:[e.jsx(It,{className:"text-lg font-semibold",children:"Einkaufslisten"}),e.jsx(Pt,{className:"sr-only",children:"Verwalten Sie Ihre Einkaufslisten"})]}),e.jsx("div",{className:"px-5 pb-2 overflow-y-auto flex-1 min-h-0 space-y-2",children:f.map(t=>e.jsx("div",{className:"flex items-center gap-2 p-3 border rounded-lg",children:ps===t.id?e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsx(Y,{value:te,onChange:s=>se(s.target.value),className:"flex-1 h-9",placeholder:"Listenname",autoFocus:!0}),e.jsx(h,{size:"sm",onClick:()=>Os(t.id,te),className:"h-9",children:e.jsx(q,{className:"w-4 h-4"})}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>{Ze(null),se("")},className:"h-9",children:e.jsx(B,{className:"w-4 h-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:t.name}),t.isDefault&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Standard"})]}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>{Ze(t.id),se(t.name)},className:"h-9 w-9 p-0",children:e.jsx(At,{className:"w-4 h-4"})}),!t.isDefault&&e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>Hs(t.id),className:"h-9 w-9 p-0 text-red-500",children:e.jsx(de,{className:"w-4 h-4"})})]})},t.id))}),e.jsxs(Lt,{className:"px-5 pb-3 pt-2 gap-2.5 flex-shrink-0",children:[e.jsx(h,{variant:"outline",onClick:()=>F(!1),className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:"Schliessen"}),e.jsxs(h,{onClick:()=>{F(!1),Ee(!0)},className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Neue Liste"]})]})]})}),e.jsx(kt,{open:fs,onOpenChange:Ee,children:e.jsxs(Ct,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-fit !rounded-3xl !m-0 !overflow-visible !shadow-2xl !flex !flex-col",children:[e.jsxs(St,{className:"px-5 pt-5 pb-3 flex-shrink-0",children:[e.jsx(It,{className:"text-lg font-semibold",children:"Neue Liste erstellen"}),e.jsx(Pt,{className:"sr-only",children:"Erstellen Sie eine neue Einkaufsliste"})]}),e.jsx("div",{className:"space-y-3 px-5 pb-2 overflow-y-auto flex-1 min-h-0",children:e.jsxs("div",{className:"w-full",children:[e.jsx(ds,{className:"text-sm font-medium",children:"Listenname *"}),e.jsx(Y,{value:te,onChange:t=>se(t.target.value),placeholder:"z.B. Wochenendeinkauf",className:"h-11 min-h-[44px] mt-1.5 rounded-xl w-full",onKeyDown:t=>{t.key==="Enter"&&Zt()}})]})}),e.jsxs(Lt,{className:"px-5 pb-3 pt-2 gap-2.5 flex-shrink-0",children:[e.jsx(h,{variant:"outline",onClick:()=>{Ee(!1),se("")},className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:"Abbrechen"}),e.jsx(h,{onClick:Zt,disabled:!te.trim(),className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:"Erstellen"})]})]})}),!Tt&&!Rt&&!Mt&&!$t&&!Kt&&!A&&e.jsxs("div",{className:"fixed right-4 bottom-20 flex flex-col gap-3 safe-bottom",children:[e.jsx("button",{onClick:ia,className:"w-12 h-12 rounded-full bg-secondary text-secondary-foreground shadow-lg flex items-center justify-center active:opacity-80 transition-opacity",children:e.jsx(Ye,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>Te(!0),className:"w-12 h-12 rounded-full bg-secondary text-secondary-foreground shadow-lg flex items-center justify-center active:opacity-80 transition-opacity",title:"Mehrere Artikel hinzufügen",children:e.jsx(Ta,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>Xe(!0),className:"w-14 h-14 rounded-full bg-primary text-primary-foreground shadow-lg flex items-center justify-center active:opacity-80 transition-opacity",children:e.jsx(Qe,{className:"w-6 h-6"})})]})]})}export{$a as C,ln as M};
