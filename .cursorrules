# Cursor Rules for Nexo Project

## Build and Deployment Rules

**CRITICAL: DO NOT BUILD OR DEPLOY WITHOUT USER CONFIRMATION**

**ABSOLUTE PROHIBITION:**
- **FORBIDDEN: NEVER run `npm run build:mobile` or `npm run build` without explicit user confirmation**
- **FORBIDDEN: NEVER run `firebase deploy` or any deployment commands without explicit user confirmation**
- **FORBIDDEN: NEVER assume the user wants to build/deploy even if they said "ja" to something else**
- **FORBIDDEN: NEVER build/deploy "just to test" or "to see if it works"**
- **FORBIDDEN: NEVER build/deploy because "the code is ready"**

**MANDATORY WORKFLOW - YOU MUST FOLLOW THIS EXACT SEQUENCE:**

1. **BEFORE ANY BUILD:**
   - Stop and ask: "Soll ich die Änderungen jetzt bauen?" or "Should I build the changes now?"
   - Wait for explicit user confirmation
   - Only proceed if user says "ja", "yes", "build", "bauen", or explicitly confirms

2. **BEFORE ANY DEPLOY:**
   - Stop and ask: "Soll ich die Änderungen jetzt deployen?" or "Should I deploy the changes now?"
   - Wait for explicit user confirmation
   - Only proceed if user says "ja", "yes", "deploy", "deployen", or explicitly confirms

3. **EXPLICIT CONFIRMATION REQUIRED:**
   - User must explicitly say "ja", "yes", "build", "deploy", "bauen", "deployen"
   - "ja" alone is NOT confirmation for build/deploy unless the question was specifically about build/deploy
   - If user says "ja" to a different question, you MUST ask again specifically about build/deploy

4. **AFTER DEPLOYMENT:**
   - ALWAYS push changes to Git with an appropriate commit message
   - Use `git add .`, `git commit -m "message"`, and `git push` after deployment is confirmed successful

## Dialog Styling Rules

**CRITICAL: All dialogs must use consistent styling to avoid excessive white space**

When creating or modifying dialogs (DialogContent components), ALWAYS use these exact classes:

- **DialogContent**: `!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-fit !rounded-3xl !m-0 !overflow-visible !shadow-2xl`
  - NEVER use `max-h-[90vh]` or `!overflow-hidden` or `!flex !flex-col` on DialogContent
  - ALWAYS use `max-h-fit` and `!overflow-visible` for compact, content-fitting dialogs

- **DialogHeader**: `px-5 pt-5 pb-3`
  - Standard padding for all dialog headers

- **Content Container**: `space-y-3 px-5 pb-2`
  - Standard spacing and padding for dialog content areas

- **Input Fields**: `mt-1.5` for spacing between label and input
  - Use `h-11 min-h-[44px]` for input height
  - Use `rounded-xl` for border radius

- **Textarea**: `mt-1.5 min-h-[80px]` for spacing and minimum height

- **DialogFooter**: `px-5 pb-3 pt-2 gap-2.5`
  - Standard padding and gap for footer buttons

**Examples of correct dialog structure:**
```tsx
<DialogContent className="!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-fit !rounded-3xl !m-0 !overflow-visible !shadow-2xl">
  <DialogHeader className="px-5 pt-5 pb-3">
    <DialogTitle>Dialog Title</DialogTitle>
  </DialogHeader>
  <div className="space-y-3 px-5 pb-2">
    {/* Content */}
  </div>
  <DialogFooter className="px-5 pb-3 pt-2 gap-2.5">
    {/* Buttons */}
  </DialogFooter>
</DialogContent>
```

## Live Testing and Debugging Workflow

**CRITICAL: When user reports issues/störungen, follow this EXACT workflow:**

1. **Initial Live Testing:**
   - **CRITICAL: Use the correct URL based on version:**
     - **Web version:** Navigate to https://nexo-jtsky100.web.app/login
     - **Mobile version:** Navigate to https://m-nexo-jtsky100.web.app/aichat
   - **MANDATORY: Take a screenshot after navigation using `browser_take_screenshot` to verify current page state**
   - **IMPORTANT: Only start ONE browser instance, never two browsers simultaneously**
   - For web version: Login with credentials:
     - Email: antonio10jonathan@yahoo.com
     - Password: 12345678
   - **MANDATORY: Take a screenshot after entering email using `browser_take_screenshot`**
   - **MANDATORY: Take a screenshot after entering password using `browser_take_screenshot`**
   - **MANDATORY: Take a screenshot after clicking login button using `browser_take_screenshot`**
   - **MANDATORY: Take a screenshot after login completes to verify successful login using `browser_take_screenshot`**
   - **CRITICAL: After EVERY action (navigate, type, click, wait), take a screenshot to know exactly where you are**
   - Test the reported issue/feature
   - **MANDATORY: Take a screenshot when testing the feature to verify the current state**
   - Check browser console logs using `browser_console_messages`
   - Check network requests using `browser_network_requests` if needed
   - Take a snapshot using `browser_snapshot` to see current state
   - Document all errors and issues found

2. **Code Investigation and Fixing:**
   - Search codebase for related code sections
   - Read relevant files to understand the issue
   - Identify root cause of the problem
   - Implement fixes in code
   - Check for linter errors and fix them
   - Review the changes to ensure they address the issue

3. **Request Build/Deploy Permission:**
   - **ABSOLUTELY FORBIDDEN: NEVER build or deploy automatically**
   - **STOP: Before running ANY build command, you MUST ask: "Soll ich die Änderungen jetzt bauen?"**
   - **STOP: Before running ANY deploy command, you MUST ask: "Soll ich die Änderungen jetzt deployen?"**
   - **WAIT: You MUST wait for explicit user confirmation ("ja", "yes", "build", "deploy", etc.)**
   - **VERIFY: Make sure the user's "ja" or "yes" is specifically for build/deploy, not for something else**
   - **IF IN DOUBT: Ask again specifically about build/deploy**

4. **Build and Deploy (after user confirmation):**
   - Run `npm run build` (or `npm run build:mobile` if needed)
   - Run `firebase deploy --only hosting` (or appropriate deploy command)
   - Commit and push changes to Git

5. **Post-Deployment Verification:**
   - **MANDATORY: Test again on live site after deployment**
   - **CRITICAL: Use the correct URL based on version:**
     - **Web version:** Navigate to https://nexo-jtsky100.web.app/login
     - **Mobile version:** Navigate to https://m-nexo-jtsky100.web.app/aichat
   - **MANDATORY: Take a screenshot after navigation using `browser_take_screenshot`**
   - For web version: Login again with same credentials (antonio10jonathan@yahoo.com / 12345678)
   - **MANDATORY: Take a screenshot after entering email using `browser_take_screenshot`**
   - **MANDATORY: Take a screenshot after entering password using `browser_take_screenshot`**
   - **MANDATORY: Take a screenshot after clicking login button using `browser_take_screenshot`**
   - **MANDATORY: Take a screenshot after login completes to verify successful login using `browser_take_screenshot`**
   - **CRITICAL: After EVERY action (navigate, type, click, wait), take a screenshot to know exactly where you are**
   - Test the fixed feature/issue again
   - **MANDATORY: Take a screenshot when testing the fixed feature to verify the current state**
   - Check browser console logs again for any remaining errors
   - Check network requests if relevant
   - Take a screenshot using `browser_take_screenshot`
   - Verify in the screenshot that the issue is actually resolved
   - Confirm to user that the issue is fixed

6. **Browser Management:**
   - **CRITICAL: Only use ONE browser instance at a time**
   - **FORBIDDEN: NEVER navigate to "about:blank" - this URL is strictly prohibited**
   - **FORBIDDEN: NEVER open any URL that is not explicitly specified by the user**
   - **ONLY navigate to these specific URLs:**
     - Web version: https://nexo-jtsky100.web.app/login
     - Mobile version: https://m-nexo-jtsky100.web.app/aichat
   - Before starting a new browser session, ensure any previous browser is closed
   - **If you detect that a second browser instance has been opened:**
     - Immediately terminate/kill the second browser process
     - The second browser typically opens "about:blank" which is forbidden
     - Only keep ONE browser instance open with the correct URL
   - Never have multiple browser tabs/instances open simultaneously
   - Close browser after testing is complete
   - **If browser_navigate results in "about:blank", immediately close that browser and navigate again to the correct URL**

7. **Error Documentation:**
   - Log all console errors found
   - Document network request failures
   - Note any visual issues observed
   - Report findings clearly to user

8. **Problem Resolution Requirements:**
   - **CRITICAL: You MUST fully solve problems without user intervention**
   - **If buttons/features don't work for you during testing, they won't work for the user either**
   - **NEVER mark a problem as "solved" or "fixed" unless you have verified it works in your own testing**
   - **If you cannot click/test a button during live testing, you MUST investigate and fix the root cause**
   - **Do NOT assume something will work for the user if it doesn't work for you**
   - **Continue debugging until the feature actually works in your live testing**
   - **Only report success after you have successfully tested the feature yourself**

**This workflow must be followed EXACTLY - no shortcuts, no hallucinations, no assumptions.**

## General Development Rules

- Always test changes locally when possible before suggesting deployment
- Provide clear explanations of what will be deployed
- Use German language for user-facing messages when the user communicates in German
- Follow existing code patterns and conventions in the codebase
- Ensure all linter errors are resolved before suggesting deployment

## German Language Rules (Swiss Grammar)

**CRITICAL: Swiss German Grammar Rules - ALWAYS FOLLOW:**

- **FORBIDDEN: NEVER use "ß" (Eszett) character in ANY German text**
- **MANDATORY: ALWAYS use "ss" instead of "ß" in ALL German text**
- **Examples:**
  - ✅ CORRECT: "müssen" → "müssen" (already correct)
  - ✅ CORRECT: "Straße" → "Strasse"
  - ✅ CORRECT: "groß" → "gross"
  - ✅ CORRECT: "Fuß" → "Fuss"
  - ✅ CORRECT: "Maße" → "Masse"
  - ✅ CORRECT: "Maß" → "Mass"
  - ✅ CORRECT: "außen" → "aussen"
  - ✅ CORRECT: "draußen" → "draussen"
  - ✅ CORRECT: "heißen" → "heissen"
  - ✅ CORRECT: "schließen" → "schliessen"
  - ✅ CORRECT: "größer" → "grösser"
  - ✅ CORRECT: "besser" → "besser" (already correct)
  - ✅ CORRECT: "müssen" → "müssen" (already correct)
  - ❌ FORBIDDEN: "Straße", "groß", "Fuß", "Maße", "außen", "heißen", "schließen", "größer"

- **This rule applies to:**
  - All user-facing German text (UI labels, messages, tooltips, etc.)
  - All German comments in code
  - All German documentation
  - All German error messages
  - All German console logs (when in German)
  - All German variable names (if using German)
  - All German function names (if using German)

- **This rule does NOT apply to:**
  - Code syntax, keywords, or programming language elements
  - English text
  - Other languages
  - File names (unless they contain German text)
  - URLs or technical identifiers

- **When in doubt:**
  - Search for "ß" in the file before committing
  - Replace ALL instances of "ß" with "ss"
  - Verify that the replacement makes sense in context

