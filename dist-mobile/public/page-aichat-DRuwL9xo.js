import*as fe from"react";import gt,{createContext as ft,useContext as pt,useMemo as le,useRef as K,useCallback as G,useState as p,useEffect as $}from"react";import"./vendor-i18n-CxwOOByA.js";import{s as _t,c as Lt,X as Je,W as Bt,C as nt,a as st,b as Ot,S as Ut,d as Kt,e as Wt,M as Ht,L as Xe,f as xt,B as Ye,g as Re,U as bt,h as Te,i as Oe,j as ze,F as vt,k as Ue,l as yt,m as wt,n as $t,o as at,P as Gt,I as qt,G as Zt,p as jt,A as Vt,q as Jt,r as Xt,t as Yt,T as Qt,u as en,E as tn,v as nn,w as sn,x as an,y as rn,z as on,R as ln,D as rt,H as cn}from"./vendor-misc-0xFFjwIq.js";import{u as Pe,L as dn}from"./vendor-router-Cqhm60_J.js";import{S as un,R as mn,C as hn,a as gn,T as fn,D as pn,P as xn,O as bn,b as vn,c as yn,d as wn,I as jn,V as Nn,e as Cn,f as Sn,g as kn,h as Dn,i as En,j as An,k as In,l as Fn,m as Rn,n as Tn,o as zn,p as Pn,q as Mn,r as _n,s as Ln}from"./vendor-ui-BVS7oxWT.js";import{t as Bn,c as On}from"./vendor-utils-BNe0Xlio.js";import{i as Un,g as Kn,a as Wn,b as Hn,c as $n,d as Gn,o as qn,s as Zn,G as Vn,e as Jn,f as Xn,h as Yn,j as F}from"./vendor-firebase-CefD0GaG.js";import{t as v}from"./vendor-toast-CdQ6zwVl.js";import{c as Qn}from"./vendor-api-DpzZqlm7.js";const es="modulepreload",ts=function(n){return"/"+n},it={},ga=function(t,s,i){let o=Promise.resolve();if(s&&s.length>0){let g=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");o=g(s.map(c=>{if(c=ts(c),c in it)return;it[c]=!0;const h=c.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const N=document.createElement("link");if(N.rel=h?"stylesheet":es,h||(N.as="script"),N.crossOrigin="",N.href=c,u&&N.setAttribute("nonce",u),document.head.appendChild(N),h)return new Promise((C,y)=>{N.addEventListener("load",C),N.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return o.then(l=>{for(const u of l||[])u.status==="rejected"&&r(u.reason);return t().catch(r)})};var fa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pa(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var We={exports:{}},Fe={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ot;function ns(){if(ot)return Fe;ot=1;var n=gt,t=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function l(u,g,c){var h,d={},N=null,C=null;c!==void 0&&(N=""+c),g.key!==void 0&&(N=""+g.key),g.ref!==void 0&&(C=g.ref);for(h in g)i.call(g,h)&&!r.hasOwnProperty(h)&&(d[h]=g[h]);if(u&&u.defaultProps)for(h in g=u.defaultProps,g)d[h]===void 0&&(d[h]=g[h]);return{$$typeof:t,type:u,key:N,ref:C,props:d,_owner:o.current}}return Fe.Fragment=s,Fe.jsx=l,Fe.jsxs=l,Fe}var lt;function ss(){return lt||(lt=1,We.exports=ns()),We.exports}var e=ss();const as=(n,t,s,i)=>{const o=[s,{code:t,...i||{}}];if(n?.services?.logger?.forward)return n.services.logger.forward(o,"warn","react-i18next::",!0);pe(o[0])&&(o[0]=`react-i18next:: ${o[0]}`),n?.services?.logger?.warn?n.services.logger.warn(...o):console?.warn&&console.warn(...o)},ct={},Nt=(n,t,s,i)=>{pe(s)&&ct[s]||(pe(s)&&(ct[s]=new Date),as(n,t,s,i))},Ct=(n,t)=>()=>{if(n.isInitialized)t();else{const s=()=>{setTimeout(()=>{n.off("initialized",s)},0),t()};n.on("initialized",s)}},Ze=(n,t,s)=>{n.loadNamespaces(t,Ct(n,s))},dt=(n,t,s,i)=>{if(pe(s)&&(s=[s]),n.options.preload&&n.options.preload.indexOf(t)>-1)return Ze(n,s,i);s.forEach(o=>{n.options.ns.indexOf(o)<0&&n.options.ns.push(o)}),n.loadLanguages(t,Ct(n,i))},rs=(n,t,s={})=>!t.languages||!t.languages.length?(Nt(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(n,{lng:s.lng,precheck:(i,o)=>{if(s.bindI18n&&s.bindI18n.indexOf("languageChanging")>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!o(i.isLanguageChangingTo,n))return!1}}),pe=n=>typeof n=="string",is=n=>typeof n=="object"&&n!==null,os=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,ls={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},cs=n=>ls[n],ds=n=>n.replace(os,cs);let Ve={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:ds,transDefaultProps:void 0};const us=(n={})=>{Ve={...Ve,...n}},ms=()=>Ve;let St;const hs=n=>{St=n},gs=()=>St,xa={type:"3rdParty",init(n){us(n.options.react),hs(n)}},fs=ft();class ps{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(s=>{this.usedNamespaces[s]||(this.usedNamespaces[s]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const xs=(n,t)=>pe(t)?t:is(t)&&pe(t.defaultValue)?t.defaultValue:Array.isArray(n)?n[n.length-1]:n,bs={t:xs,ready:!1},vs=()=>()=>{},kt=(n,t={})=>{const{i18n:s}=t,{i18n:i,defaultNS:o}=pt(fs)||{},r=s||i||gs();r&&!r.reportNamespaces&&(r.reportNamespaces=new ps),r||Nt(r,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const l=le(()=>({...ms(),...r?.options?.react,...t}),[r,t]),{useSuspense:u,keyPrefix:g}=l,c=o||r?.options?.defaultNS,h=pe(c)?[c]:c||["translation"],d=le(()=>h,h);r?.reportNamespaces?.addUsedNamespaces?.(d);const N=K(0),C=G(E=>{if(!r)return vs;const{bindI18n:b,bindI18nStore:D}=l,z=()=>{N.current+=1,E()};return b&&r.on(b,z),D&&r.store.on(D,z),()=>{b&&b.split(" ").forEach(x=>r.off(x,z)),D&&D.split(" ").forEach(x=>r.store.off(x,z))}},[r,l]),y=K(),f=G(()=>{if(!r)return bs;const E=!!(r.isInitialized||r.initializedStoreOnce)&&d.every(A=>rs(A,r,l)),b=t.lng||r.language,D=N.current,z=y.current;if(z&&z.ready===E&&z.lng===b&&z.keyPrefix===g&&z.revision===D)return z;const j={t:r.getFixedT(b,l.nsMode==="fallback"?d:d[0],g),ready:E,lng:b,keyPrefix:g,revision:D};return y.current=j,j},[r,d,g,l,t.lng]),[M,T]=p(0),{t:ce,ready:Q}=_t.useSyncExternalStore(C,f,f);$(()=>{if(r&&!Q&&!u){const E=()=>T(b=>b+1);t.lng?dt(r,t.lng,d,E):Ze(r,d,E)}},[r,t.lng,d,Q,u,M]);const W=r||{},H=K(null),ne=K(),se=E=>{const b=Object.getOwnPropertyDescriptors(E);b.__original&&delete b.__original;const D=Object.create(Object.getPrototypeOf(E),b);if(!Object.prototype.hasOwnProperty.call(D,"__original"))try{Object.defineProperty(D,"__original",{value:E,writable:!1,enumerable:!1,configurable:!1})}catch{}return D},ie=le(()=>{const E=W,b=E?.language;let D=E;E&&(H.current&&H.current.__original===E?ne.current!==b?(D=se(E),H.current=D,ne.current=b):D=H.current:(D=se(E),H.current=D,ne.current=b));const z=[ce,D,Q];return z.t=ce,z.i18n=D,z.ready=Q,z},[ce,W,Q,W.resolvedLanguage,W.language,W.languages]);if(r&&u&&!Q)throw new Promise(E=>{const b=()=>E();t.lng?dt(r,t.lng,d,b):Ze(r,d,b)});return ie},ys=Qn(),ws={apiKey:"AIzaSyCZ8V17HUVMlBKXK0ftrMURS-XP2zIsOps",authDomain:"nexo-jtsky100.firebaseapp.com",projectId:"nexo-jtsky100",storageBucket:"nexo-jtsky100.firebasestorage.app",messagingSenderId:"859320186482",appId:"1:859320186482:web:0c9dcca5d8ce613aaf34eb",measurementId:"G-G8PX4GB2YF"},Ke=Un(ws),ve=Kn(Ke);Wn(Ke);const R=Hn(Ke);typeof window<"u"&&$n(Ke);const Dt=ft(void 0);function ba({children:n}){const[t,s]=p(null),[i,o]=p(!0),[r,l]=p(null);$(()=>(Gn(ve).then(f=>{f?.user&&s(f.user)}).catch(f=>{}),qn(ve,f=>{s(f),o(!1)})),[]);const u=async(y,f)=>{try{l(null);const M=await Xn(ve,y,f)}catch(M){let T="Anmeldung fehlgeschlagen";switch(M.code){case"auth/invalid-email":T="Ungültige E-Mail-Adresse";break;case"auth/user-disabled":T="Dieses Konto wurde deaktiviert";break;case"auth/user-not-found":T="Kein Konto mit dieser E-Mail gefunden";break;case"auth/wrong-password":T="Falsches Passwort";break;case"auth/invalid-credential":T="Ungültige Anmeldedaten";break;default:T=M.message||"Ein Fehler ist aufgetreten"}throw l(T),new Error(T)}},g=async(y,f)=>{try{l(null);const M=await Yn(ve,y,f)}catch(M){let T="Registrierung fehlgeschlagen";switch(M.code){case"auth/email-already-in-use":T="Diese E-Mail wird bereits verwendet";break;case"auth/invalid-email":T="Ungültige E-Mail-Adresse";break;case"auth/weak-password":T="Passwort ist zu schwach";break;default:T=M.message||"Ein Fehler ist aufgetreten"}throw l(T),new Error(T)}},c=async()=>{try{l(null);const y=new Vn;y.addScope("email"),y.addScope("profile"),y.setCustomParameters({prompt:"select_account"}),await Jn(ve,y)}catch(y){let f="Ein Fehler ist aufgetreten";switch(y.code){case"auth/unauthorized-domain":f="Diese Domain ist nicht autorisiert. Bitte kontaktieren Sie den Administrator.";break;case"auth/operation-not-allowed":f="Google Sign-In ist nicht aktiviert.";break;case"auth/network-request-failed":f="Netzwerkfehler. Bitte überprüfen Sie Ihre Internetverbindung.";break;default:f=y.message||"Ein unbekannter Fehler ist aufgetreten"}throw l(f),new Error(f)}},h=async()=>{try{await Zn(ve)}catch{throw new Error("Abmeldung fehlgeschlagen")}},d=u,N=c,C=h;return e.jsx(Dt.Provider,{value:{user:t,loading:i,error:r,signIn:u,signUp:g,signInWithGoogle:c,signOut:h,loginWithEmail:d,loginWithGoogle:N,logout:C},children:n})}function js(){const n=pt(Dt);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n}function k(...n){return Bn(On(n))}const Ns=Lt("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-transparent shadow-xs hover:bg-accent dark:bg-transparent dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function U({className:n,variant:t,size:s,asChild:i=!1,...o}){const r=i?un:"button";return e.jsx(r,{"data-slot":"button",className:k(Ns({variant:t,size:s,className:n})),...o})}function Cs({className:n,...t}){return e.jsx("div",{"data-slot":"card",className:k("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",n),...t})}function va({className:n,...t}){return e.jsx("div",{"data-slot":"card-header",className:k("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",n),...t})}function ya({className:n,...t}){return e.jsx("div",{"data-slot":"card-title",className:k("leading-none font-semibold",n),...t})}function wa({className:n,...t}){return e.jsx("div",{"data-slot":"card-description",className:k("text-muted-foreground text-sm",n),...t})}function Ss({className:n,...t}){return e.jsx("div",{"data-slot":"card-content",className:k("px-6",n),...t})}const ut="glassEffectEnabled";function Et(){const[n,t]=p(()=>{const i=localStorage.getItem(ut);return i!==null?i==="true":!0});return $(()=>{localStorage.setItem(ut,String(n))},[n]),{isEnabled:n,toggle:()=>{t(i=>!i)},setIsEnabled:t}}const At=fe.createContext({isComposing:()=>!1,setComposing:()=>{},justEndedComposing:()=>!1,markCompositionEnd:()=>{}}),Qe=()=>fe.useContext(At);function Ce({...n}){const t=fe.useRef(!1),s=fe.useRef(!1),i=fe.useRef(null),o=fe.useMemo(()=>({isComposing:()=>t.current,setComposing:r=>{t.current=r},justEndedComposing:()=>s.current,markCompositionEnd:()=>{s.current=!0,i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{s.current=!1},150)}}),[]);return e.jsx(At.Provider,{value:o,children:e.jsx(mn,{"data-slot":"dialog",...n})})}function ks({...n}){return e.jsx(xn,{"data-slot":"dialog-portal",...n})}function It({className:n,...t}){return e.jsx(bn,{"data-slot":"dialog-overlay",className:k("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",n),...t})}It.displayName="DialogOverlay";function Se({className:n,children:t,showCloseButton:s=!0,onEscapeKeyDown:i,...o}){const{isComposing:r}=Qe(),l=fe.useCallback(u=>{if(u.isComposing||r()){u.preventDefault();return}i?.(u)},[r,i]);return e.jsxs(ks,{"data-slot":"dialog-portal",children:[e.jsx(It,{}),e.jsxs(hn,{"data-slot":"dialog-content",className:k("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-0 left-0 right-0 bottom-0 z-50 flex flex-col w-full h-full border-0 shadow-lg duration-200 sm:top-[50%] sm:left-[50%] sm:right-auto sm:bottom-auto sm:translate-x-[-50%] sm:translate-y-[-50%] sm:max-w-lg sm:h-auto sm:max-h-[90vh] sm:rounded-lg sm:border sm:m-4 sm:flex sm:flex-col",n),onEscapeKeyDown:l,...o,children:[t,s&&e.jsxs(gn,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(Je,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function ke({className:n,...t}){return e.jsx("div",{"data-slot":"dialog-header",className:k("flex flex-col gap-2 text-center sm:text-left",n),...t})}function De({className:n,...t}){return e.jsx("div",{"data-slot":"dialog-footer",className:k("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",n),...t})}function Ee({className:n,...t}){return e.jsx(fn,{"data-slot":"dialog-title",className:k("text-lg leading-none font-semibold",n),...t})}function ja({className:n,...t}){return e.jsx(pn,{"data-slot":"dialog-description",className:k("text-muted-foreground text-sm",n),...t})}const Ds={maxRetries:3,initialDelay:1e3,maxDelay:1e4,backoffMultiplier:2,retryableErrors:["network","timeout","ECONNRESET","ETIMEDOUT","ENOTFOUND","EAI_AGAIN","500","502","503","504"]};function Es(n,t){if(!n)return!1;const s=n.message?.toLowerCase()||"",i=n.code?.toLowerCase()||"",o=n.status?.toString()||"";return t.some(r=>{const l=r.toLowerCase();return s.includes(l)||i.includes(l)||o.includes(l)})}function As(n,t){const s=t.initialDelay*Math.pow(t.backoffMultiplier,n);return Math.min(s,t.maxDelay)}async function Is(n,t={}){const s={...Ds,...t};let i;for(let o=0;o<=s.maxRetries;o++)try{return await n()}catch(r){if(i=r,o>=s.maxRetries||!Es(r,s.retryableErrors))break;const l=As(o,s);await new Promise(u=>setTimeout(u,l))}throw i}async function he(n,t,s={}){return Is(async()=>(await n(t)).data,s)}const et={maxRetries:3,initialDelay:1e3},Me={maxRetries:2,initialDelay:500};function Na(n){const[t,s]=p([]),[i,o]=p(!0),[r,l]=p(null),[u,g]=p(0);return $(()=>{(async()=>{try{o(!0);const y=(await F(R,"getReminders")(n||{})).data.reminders.map(f=>({...f,dueDate:f.dueDate?.toDate?f.dueDate.toDate():new Date(f.dueDate),createdAt:f.createdAt?.toDate?f.createdAt.toDate():new Date(f.createdAt),updatedAt:f.updatedAt?.toDate?f.updatedAt.toDate():new Date(f.updatedAt)}));s(y),l(null)}catch(d){l(d)}finally{o(!1)}})()},[n?.startDate,n?.endDate,n?.status,u]),{data:t,isLoading:i,error:r,refetch:()=>g(h=>h+1)}}async function Fs(n){const t=F(R,"createReminder");return he(t,n,et)}async function Ca(n,t){const s=F(R,"updateReminder");await he(s,{id:n,...t},Me)}async function Sa(n){const t=F(R,"deleteReminder");await he(t,{id:n},Me)}function ka(n){const[t,s]=p([]),[i,o]=p(!0),[r,l]=p(null),u=G(async()=>{try{o(!0);const N=(await F(R,"getFinanceEntries")(n||{})).data.entries.map(C=>({...C,date:C.date?.toDate?C.date.toDate():new Date(C.date),createdAt:C.createdAt?.toDate?C.createdAt.toDate():new Date(C.createdAt),updatedAt:C.updatedAt?.toDate?C.updatedAt.toDate():new Date(C.updatedAt)}));s(N),l(null)}catch(c){l(c)}finally{o(!1)}},[n?.startDate,n?.endDate,n?.type]);$(()=>{u()},[u]);const g=G(async()=>{await u()},[u]);return{data:t,isLoading:i,error:r,refetch:g}}async function Rs(n){const t=F(R,"createFinanceEntry");return he(t,n,et)}async function Da(n,t){const s=F(R,"updateFinanceEntry");await he(s,{id:n,...t},Me)}function Ea(){const[n,t]=p([]),[s,i]=p(!0),[o,r]=p(null);return $(()=>{(async()=>{try{i(!0);const h=(await F(R,"getTaxProfiles")({})).data.profiles.map(d=>({...d,createdAt:d.createdAt?.toDate?d.createdAt.toDate():new Date(d.createdAt),updatedAt:d.updatedAt?.toDate?d.updatedAt.toDate():new Date(d.updatedAt)}));t(h),r(null)}catch(u){r(u)}finally{i(!1)}})()},[]),{data:n,isLoading:s,error:o}}async function Aa(n){await F(R,"deleteTaxProfile")({id:n})}function Ia(){const[n,t]=p([]),[s,i]=p(!0),[o,r]=p(null);return $(()=>{(async()=>{try{i(!0);const h=(await F(R,"getPeople")({})).data.people.map(d=>({...d,createdAt:d.createdAt?.toDate?d.createdAt.toDate():new Date(d.createdAt),updatedAt:d.updatedAt?.toDate?d.updatedAt.toDate():new Date(d.updatedAt)}));t(h),r(null)}catch(u){r(u)}finally{i(!1)}})()},[]),{data:n,isLoading:s,error:o}}async function Fa(n){const t=F(R,"createPerson");return he(t,n,et)}async function Ra(n,t){const s=F(R,"updatePerson");await he(s,{personId:n,...t},Me)}async function Ta(n){const t=F(R,"deletePerson");await he(t,{personId:n},Me)}function za(n){const[t,s]=p([]),[i,o]=p(!0),[r,l]=p(null),[u,g]=p(0);return $(()=>{(async()=>{try{o(!0);const y=(await F(R,"getShoppingList")({status:n})).data.items.map(f=>({...f,boughtAt:f.boughtAt?.toDate?f.boughtAt.toDate():f.boughtAt?new Date(f.boughtAt):null,createdAt:f.createdAt?.toDate?f.createdAt.toDate():new Date(f.createdAt),updatedAt:f.updatedAt?.toDate?f.updatedAt.toDate():new Date(f.updatedAt)}));s(y),l(null)}catch(d){l(d)}finally{o(!1)}})()},[n,u]),{data:t,isLoading:i,error:r,refetch:()=>g(h=>h+1)}}async function Ts(n){return(await F(R,"createShoppingItem")(n)).data}async function Pa(n){await F(R,"deleteShoppingItem")({itemId:n})}async function Ma(n,t,s){return(await F(R,"markShoppingItemAsBought")({itemId:n,actualPrice:t,createExpense:s})).data}function zs(){const[n,t]=p([]),[s,i]=p(!0),[o,r]=p(null),[l,u]=p(0);return $(()=>{(async()=>{try{i(!0);const C=(await F(R,"getChatConversations")({})).data.conversations.map(y=>{let f=new Date;y.createdAt&&(typeof y.createdAt=="string"?f=y.createdAt:f=new Date(y.createdAt).toISOString());let M=new Date;return y.updatedAt&&(typeof y.updatedAt=="string"?M=y.updatedAt:M=new Date(y.updatedAt).toISOString()),{...y,createdAt:f,updatedAt:M}});C.sort((y,f)=>{const M=typeof y.updatedAt=="string"?new Date(y.updatedAt).getTime():y.updatedAt.getTime();return(typeof f.updatedAt=="string"?new Date(f.updatedAt).getTime():f.updatedAt.getTime())-M}),t(C),r(null)}catch(h){r(h)}finally{i(!1)}})()},[l]),{data:n,isLoading:s,error:o,refetch:()=>u(c=>c+1)}}function Ps(n,t){const[s,i]=p(null),[o,r]=p(!1),[l,u]=p(null);return $(()=>{if(!n){i(null);return}(async()=>{try{r(!0),u(null);const d=(await F(R,"getWeather")({date:n.toISOString(),location:t})).data,N=!1;if(d)i(d);else{const C=new Date;C.setHours(0,0,0,0);const y=new Date(n);y.setHours(0,0,0,0),y<C?u(new Error("Historische Wetterdaten sind nur aus dem Cache verfügbar.")):u(new Error("Keine Wetterdaten verfügbar. Bitte überprüfen Sie den Standort in den Einstellungen."))}}catch(c){console.error("[useWeather] Error:",c);const h=c?.message||c?.code||"Unbekannter Fehler beim Laden der Wetterdaten";u(new Error(h)),i(null)}finally{r(!1)}})()},[n,t]),{data:s,isLoading:o,error:l}}function Ms(){const[n,t]=p(null),[s,i]=p(!0),[o,r]=p(null);$(()=>{(async()=>{try{i(!0),r(null);const h=(await F(R,"getUserSettings")({})).data;t(h)}catch(g){r(g)}finally{i(!1)}})()},[]);const l=G(async u=>{try{return await F(R,"updateUserSettings")(u),t(c=>c?{...c,...u}:u),{success:!0}}catch(g){throw r(g),g}},[]);return{settings:n,isLoading:s,error:o,updateSettings:l}}async function _s(n){return(await F(R,"createChatConversation")(n)).data}async function Ls(n,t){await F(R,"updateChatConversation")({id:n,...t})}function Bs({selectedDate:n}){const{settings:t,isLoading:s}=Ms(),i=t?.weatherLocation||"Zurich, CH",{data:o,isLoading:r,error:l}=Ps(n,i);gt.useEffect(()=>{},[n,i,s,o,r,l]);const u=c=>{switch(c){case"sun":return e.jsx(Ut,{className:"w-5 h-5"});case"cloud-sun":return e.jsx(Ot,{className:"w-5 h-5"});case"cloud":return e.jsx(nt,{className:"w-5 h-5"});case"rain":return e.jsx(st,{className:"w-5 h-5"});case"snow":return e.jsx(st,{className:"w-5 h-5"});default:return e.jsx(nt,{className:"w-5 h-5"})}};if(!n)return null;const g=n.toLocaleDateString("de-CH",{weekday:"long",day:"numeric",month:"long"});return e.jsxs("div",{className:"p-3 border-b border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-xs font-semibold text-muted-foreground",children:"Wetter"}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:g})]}),r?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx("div",{className:"text-xs text-muted-foreground",children:"Lädt..."})}):o?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[u(o.icon),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsxs("span",{className:"text-lg font-bold",children:[o.temperature,"°"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"C"})]}),e.jsx("div",{className:"text-[10px] text-muted-foreground",children:o.condition})]})]}),o.humidity!==void 0&&o.windSpeed!==void 0&&e.jsxs("div",{className:"flex gap-3 text-[9px] text-muted-foreground pt-1 border-t border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Bt,{className:"w-3 h-3"}),e.jsxs("span",{children:[o.windSpeed," km/h"]})]}),e.jsx("div",{children:e.jsxs("span",{children:["Luftfeuchtigkeit: ",o.humidity,"%"]})})]})]}):l?e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground text-center py-2",children:l.message||"Fehler beim Laden der Wetterdaten"}),e.jsxs("div",{className:"text-[10px] text-muted-foreground/70 text-center",children:["Standort: ",i]})]}):s?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx("div",{className:"text-xs text-muted-foreground",children:"Lädt Einstellungen..."})}):e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground text-center py-2",children:"Keine Wetterdaten verfügbar"}),e.jsxs("div",{className:"text-[10px] text-muted-foreground/70 text-center",children:["Standort: ",i]})]})]})}function Os(){const[,n]=Pe(),[t,s]=p(new Date),[i,o]=p([]),[r,l]=p(!1),[u,g]=p(null),[c,h]=p(null),[d,N]=p(!1),[C,y]=p(!1);$(()=>{u||g(new Date)},[]);const f=["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],M=["Mo","Di","Mi","Do","Fr","Sa","So"],T=G(async()=>{try{l(!0);const x=F(R,"getCalendarEvents"),j=F(R,"getVacations"),A=F(R,"getSchoolSchedules"),J=F(R,"getSchoolHolidays"),X=new Date(t.getFullYear(),t.getMonth()-1,1),_=new Date(t.getFullYear(),t.getMonth()+2,0),[re,xe,ge,m]=await Promise.all([x({startDate:X.toISOString(),endDate:_.toISOString()}).catch(()=>({data:{events:[]}})),j({startDate:X.toISOString(),endDate:_.toISOString()}).catch(()=>({data:{vacations:[]}})),A({startDate:X.toISOString(),endDate:_.toISOString()}).catch(()=>({data:{schedules:[]}})),J({startDate:X.toISOString(),endDate:_.toISOString()}).catch(()=>({data:{holidays:[]}}))]),w=re.data,B=xe.data,Y=ge.data,P=m.data,L=[...w.events||[],...(B.vacations||[]).map(I=>({id:`vacation-${I.id}`,type:"work",title:I.title||"Ferien",date:I.startDate,description:I.description})),...(Y.schedules||[]).map(I=>({id:`school-${I.id}`,type:"school",title:I.childName?`${I.childName} - Schule`:"Schule",date:I.date,schoolType:I.type})),...(P.holidays||[]).map(I=>({id:`holiday-${I.id}`,type:"school-holiday",title:I.title||"Schulferien",date:I.date}))];o(L)}catch{}finally{l(!1)}},[t]);$(()=>{T()},[T]);const ce=x=>{const j=new Date(x),A=j.getDay(),J=j.getDate()-(A===0?6:A-1);return new Date(j.setDate(J))},Q=le(()=>{const x=ce(t),j=[];for(let A=0;A<7;A++){const J=new Date(x);J.setDate(x.getDate()+A);const X=J.toISOString().split("T")[0];j.push({date:J,events:i.filter(_=>_.date===X)})}return j},[t,i]),W=()=>{const x=new Date(t);x.setDate(x.getDate()-7),s(x)},H=()=>{const x=new Date(t);x.setDate(x.getDate()+7),s(x)},ne=()=>{s(new Date)},se=x=>{const j=new Date;return x.toDateString()===j.toDateString()},ie=x=>{g(x),N(!0)},E=x=>{g(x)},b=x=>{h(x),y(!0)},D=le(()=>{if(!u)return[];const x=u.toISOString().split("T")[0];return i.filter(j=>j.date===x)},[u,i]),z=x=>{switch(x){case"due":return"bg-red-500";case"reminder":return"bg-blue-500";case"appointment":return"bg-green-500";case"work":return"bg-purple-500";case"school":return"bg-yellow-500";case"hort":return"bg-orange-500";default:return"bg-gray-500"}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-2 border-b border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx(U,{variant:"ghost",size:"sm",onClick:W,className:"h-5 w-5 p-0 min-w-0",children:e.jsx(Kt,{className:"w-3 h-3"})}),e.jsx("div",{className:"flex-1 text-center px-1",children:e.jsxs("h3",{className:"text-[11px] font-semibold leading-tight",children:[f[t.getMonth()]," ",t.getFullYear()]})}),e.jsx(U,{variant:"ghost",size:"sm",onClick:H,className:"h-5 w-5 p-0 min-w-0",children:e.jsx(Wt,{className:"w-3 h-3"})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-0",children:M.map((x,j)=>{const A=Q[j],J=A?se(A.date):!1;return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"text-center text-[10px] font-medium text-muted-foreground mb-1 w-full",children:x}),A&&e.jsxs("button",{onClick:()=>{E(A.date),ie(A.date)},className:k("w-full aspect-square min-h-[28px] max-h-[30px] rounded-sm transition-colors flex flex-col items-center justify-center relative","text-foreground",u&&A.date.toDateString()===u.toDateString()?"bg-primary/20 ring-1 ring-primary":J?"bg-primary text-primary-foreground font-semibold":"hover:bg-muted/50"),children:[e.jsx("span",{className:"text-[12px] leading-none font-medium",children:A.date.getDate()}),A.events.length>0&&e.jsx("div",{className:"absolute bottom-0.5 left-0 right-0 flex gap-0.5 justify-center",children:A.events.slice(0,2).map((X,_)=>e.jsx("div",{onClick:re=>{re.stopPropagation(),b(X)},className:k("h-0.5 w-0.5 rounded-full",z(X.type)),title:X.title},_))})]})]},j)})}),e.jsx(U,{variant:"ghost",size:"sm",onClick:ne,className:"w-full h-6 mt-1.5 text-[10px]",children:"Heute"})]}),e.jsx(Bs,{selectedDate:u}),e.jsx(Ce,{open:d,onOpenChange:N,children:e.jsxs(Se,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-fit !rounded-3xl !m-0 !overflow-visible !shadow-2xl",children:[e.jsx(ke,{className:"px-5 pt-5 pb-3",children:e.jsx(Ee,{className:"text-lg font-semibold",children:u?.toLocaleDateString("de-CH",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})}),e.jsx("div",{className:"space-y-2 px-5 pb-2",children:D.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Keine Events an diesem Tag"}):D.map(x=>e.jsx(Cs,{className:"cursor-pointer",onClick:()=>{N(!1),b(x)},children:e.jsx(Ss,{className:"p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:k("w-3 h-3 rounded-full mt-1 flex-shrink-0",z(x.type))}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:x.title}),x.time&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:x.time}),x.personName&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:x.personName})]})]})})},x.id))}),e.jsxs(De,{className:"px-5 pb-3 pt-2",children:[e.jsx(U,{variant:"outline",onClick:()=>{N(!1),n("/calendar")},className:"h-11 min-h-[44px] w-full rounded-xl text-sm font-medium",children:"Zum Kalender"}),e.jsx(U,{variant:"outline",onClick:()=>N(!1),className:"h-11 min-h-[44px] w-full rounded-xl text-sm font-medium",children:"Schließen"})]})]})}),e.jsx(Ce,{open:C,onOpenChange:y,children:e.jsxs(Se,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-fit !rounded-3xl !m-0 !overflow-visible !shadow-2xl",children:[e.jsx(ke,{className:"px-5 pt-5 pb-3",children:e.jsx(Ee,{className:"text-lg font-semibold",children:c?.title})}),e.jsxs("div",{className:"space-y-3 px-5 pb-2",children:[c?.date&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Datum"}),e.jsx("p",{className:"text-sm",children:new Date(c.date).toLocaleDateString("de-CH",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})]}),c?.time&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Uhrzeit"}),e.jsx("p",{className:"text-sm",children:c.time})]}),c?.description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Beschreibung"}),e.jsx("p",{className:"text-sm",children:c.description})]}),c?.personName&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Person"}),e.jsx("p",{className:"text-sm",children:c.personName})]}),c?.amount&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Betrag"}),e.jsxs("p",{className:"text-sm",children:["CHF ",c.amount.toFixed(2)]})]})]}),e.jsxs(De,{className:"px-5 pb-3 pt-2",children:[e.jsx(U,{variant:"outline",onClick:()=>{y(!1),n("/calendar")},className:"h-11 min-h-[44px] w-full rounded-xl text-sm font-medium",children:"Zum Kalender"}),e.jsx(U,{variant:"outline",onClick:()=>y(!1),className:"h-11 min-h-[44px] w-full rounded-xl text-sm font-medium",children:"Schließen"})]})]})})]})}const Us=[{path:"/",icon:Ht,label:"Assistent"},{path:"/dashboard",icon:Xe,label:"Dashboard"},{path:"/calendar",icon:xt,label:"Kalender"},{path:"/reminders",icon:Ye,label:"Erinnerungen"},{path:"/finance",icon:Re,label:"Finanzen"},{path:"/people",icon:bt,label:"Personen"},{path:"/bills",icon:Te,label:"Rechnungen"},{path:"/documents",icon:Oe,label:"Dokumente"},{path:"/shopping",icon:ze,label:"Einkaufen"},{path:"/taxes",icon:vt,label:"Steuern"},{path:"/settings",icon:Ue,label:"Einstellungen"}];function Ks({open:n,onClose:t,currentChatId:s,onSelectChat:i,onNewChat:o}){const[r]=Pe(),{user:l}=js(),{isEnabled:u}=Et(),g=()=>{if(l?.displayName){const c=l.displayName.split(" ");return c.length>=2?(c[0][0]+c[1][0]).toUpperCase():l.displayName.substring(0,2).toUpperCase()}return l?.email?l.email.substring(0,2).toUpperCase():"U"};return e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{className:k("fixed inset-0 z-40 transition-opacity",u?"bg-black/5":"bg-black/50"),onClick:t}),e.jsx("aside",{className:k("fixed top-0 left-0 h-full w-full max-w-sm z-50 transform transition-transform duration-300 ease-in-out shadow-xl",n?"translate-x-0":"-translate-x-full",u?"bg-background/95 backdrop-blur-md":"bg-background"),"aria-label":"Hauptnavigation","aria-hidden":!n,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"p-4 border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("button",{onClick:t,className:"p-2 hover:bg-muted rounded-lg transition-colors","aria-label":"Menü schließen",children:e.jsx(Je,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-lg font-semibold flex-1",children:"Menü"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b border-border",children:[e.jsx("h3",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider mb-3",children:"Navigation"}),e.jsx("nav",{className:"space-y-1",children:Us.map(c=>{const h=c.icon,d=r===c.path;return e.jsx(dn,{href:c.path,children:e.jsxs("button",{onClick:t,className:k("w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors text-left min-h-[44px]",d?"bg-primary/10 text-primary font-medium":"text-foreground hover:bg-muted"),"aria-label":`Zu ${c.label} navigieren`,"aria-current":d?"page":void 0,"aria-pressed":d,type:"button",role:"menuitem",children:[e.jsx(h,{className:"w-5 h-5 flex-shrink-0","aria-hidden":"true"}),e.jsx("span",{className:"text-sm",children:c.label})]})},c.path)})})]}),e.jsx(Os,{})]}),e.jsx("div",{className:"p-4 border-t border-border",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary text-primary-foreground flex items-center justify-center flex-shrink-0 text-sm font-medium",children:l?.photoURL?e.jsx("img",{src:l.photoURL,alt:l?.displayName||"Benutzerprofilbild",className:"w-10 h-10 rounded-full object-cover"}):e.jsx("span",{"aria-label":"Benutzerinitialen",children:g()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:l?.displayName||"Benutzer"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:l?.email||"Nicht angemeldet"})]})]})})]})})]})}function Ws({title:n,showSidebar:t=!1,showQuickActions:s=!1,quickActions:i=[],currentChatId:o,onSelectChat:r,onNewChat:l,sidebarOpen:u,onSidebarToggle:g}){Pe();const[c,h]=p(!1),{isEnabled:d}=Et(),N=u!==void 0?u:c,C=g||h;return e.jsxs(e.Fragment,{children:[t&&e.jsx(Ks,{open:N,onClose:()=>C(!1),currentChatId:o,onSelectChat:r,onNewChat:l}),e.jsx("header",{className:k("fixed top-0 left-0 right-0 z-40 border-b safe-top",d?"bg-background/95 backdrop-blur-md border-border/30":"bg-background border-border"),children:e.jsx("div",{className:"px-4 h-14 flex items-center gap-3",children:e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("h1",{className:"text-lg font-semibold text-center",children:n})})})})]})}function _e(n){const t=K(n);t.current=n;const s=K(null);return s.current||(s.current=function(...i){return t.current.apply(this,i)}),s.current}function Ft(n={}){const{onKeyDown:t,onCompositionStart:s,onCompositionEnd:i}=n,o=K(!1),r=K(null),l=K(null),u=_e(d=>{r.current&&(clearTimeout(r.current),r.current=null),l.current&&(clearTimeout(l.current),l.current=null),o.current=!0,s?.(d)}),g=_e(d=>{r.current=setTimeout(()=>{l.current=setTimeout(()=>{o.current=!1})}),i?.(d)}),c=_e(d=>{if(o.current&&(d.key==="Escape"||d.key==="Enter"&&!d.shiftKey)){d.stopPropagation();return}t?.(d)}),h=_e(()=>o.current);return{onCompositionStart:u,onCompositionEnd:g,onKeyDown:c,isComposing:h}}function me({className:n,type:t,onKeyDown:s,onCompositionStart:i,onCompositionEnd:o,...r}){const l=Qe(),{onCompositionStart:u,onCompositionEnd:g,onKeyDown:c}=Ft({onKeyDown:h=>{const d=h.nativeEvent.isComposing||l.justEndedComposing();h.key==="Enter"&&d||s?.(h)},onCompositionStart:h=>{l.setComposing(!0),i?.(h)},onCompositionEnd:h=>{l.markCompositionEnd(),setTimeout(()=>{l.setComposing(!1)},100),o?.(h)}});return e.jsx("input",{type:t,"data-slot":"input",className:k("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",n),onCompositionStart:u,onCompositionEnd:g,onKeyDown:c,...r})}function V({className:n,...t}){return e.jsx(vn,{"data-slot":"label",className:k("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",n),...t})}function ye({...n}){return e.jsx(yn,{"data-slot":"select",...n})}function we({...n}){return e.jsx(Nn,{"data-slot":"select-value",...n})}function je({className:n,size:t="default",children:s,...i}){return e.jsxs(wn,{"data-slot":"select-trigger","data-size":t,className:k("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",n),...i,children:[s,e.jsx(jn,{asChild:!0,children:e.jsx(yt,{className:"size-4 opacity-50"})})]})}function Ne({className:n,children:t,position:s="popper",align:i="center",...o}){return e.jsx(Cn,{children:e.jsxs(Sn,{"data-slot":"select-content",className:k("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:s,align:i,...o,children:[e.jsx(Hs,{}),e.jsx(kn,{className:k("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),e.jsx($s,{})]})})}function te({className:n,children:t,...s}){return e.jsxs(Dn,{"data-slot":"select-item",className:k("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",n),...s,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(En,{children:e.jsx(wt,{className:"size-4"})})}),e.jsx(An,{children:t})]})}function Hs({className:n,...t}){return e.jsx(In,{"data-slot":"select-scroll-up-button",className:k("flex cursor-default items-center justify-center py-1",n),...t,children:e.jsx($t,{className:"size-4"})})}function $s({className:n,...t}){return e.jsx(Fn,{"data-slot":"select-scroll-down-button",className:k("flex cursor-default items-center justify-center py-1",n),...t,children:e.jsx(yt,{className:"size-4"})})}function Gs({className:n,...t}){return e.jsx(Rn,{"data-slot":"switch",className:k("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",n),...t,children:e.jsx(Tn,{"data-slot":"switch-thumb",className:k("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const qs={light:10,medium:20,heavy:30,success:[50,50,50],error:[100,50,100],warning:[50,100,50],selection:5};function tt(n="medium"){if(!navigator.vibrate)return;const t=qs[n];try{navigator.vibrate(t)}catch{}}function He(){tt("success")}function Zs(){tt("error")}function _a(){tt("selection")}function Vs(n){const t=n;if(t?.code==="unavailable"||t?.message?.includes("network")||t?.message?.includes("fetch"))return{title:"Verbindungsfehler",message:"Keine Internetverbindung. Bitte überprüfen Sie Ihre Netzwerkverbindung und versuchen Sie es erneut.",action:"Erneut versuchen",retryable:!0};if(t?.code==="deadline-exceeded"||t?.message?.includes("timeout"))return{title:"Zeitüberschreitung",message:"Die Anfrage hat zu lange gedauert. Bitte versuchen Sie es erneut.",action:"Erneut versuchen",retryable:!0};if(t?.code==="permission-denied"||t?.message?.includes("permission"))return{title:"Berechtigung verweigert",message:"Sie haben keine Berechtigung für diese Aktion. Bitte kontaktieren Sie den Administrator.",retryable:!1};if(t?.code==="unauthenticated"||t?.message?.includes("auth")||t?.message?.includes("login"))return{title:"Anmeldung erforderlich",message:"Bitte melden Sie sich an, um fortzufahren.",action:"Anmelden",retryable:!1};if(t?.code==="not-found"||t?.message?.includes("not found"))return{title:"Nicht gefunden",message:"Die angeforderte Ressource wurde nicht gefunden.",retryable:!1};if(t?.code==="invalid-argument"||t?.message?.includes("validation")||t?.message?.includes("invalid"))return{title:"Ungültige Eingabe",message:t?.message||"Bitte überprüfen Sie Ihre Eingabe und versuchen Sie es erneut.",retryable:!1};if(t?.code==="resource-exhausted"||t?.message?.includes("quota"))return{title:"Kontingent überschritten",message:"Das Tageslimit wurde erreicht. Bitte versuchen Sie es später erneut.",retryable:!1};if(t?.message?.includes("billing")||t?.message?.includes("Billing"))return{title:"Abrechnungsfehler",message:"Google Cloud Billing ist erforderlich. Bitte kontaktieren Sie den Administrator.",retryable:!1};if(t?.code?.startsWith("functions/"))return{title:"Server-Fehler",message:`Ein Fehler ist aufgetreten: ${t.code.replace("functions/","")}. Bitte versuchen Sie es später erneut.`,action:"Erneut versuchen",retryable:!0};const s=t?.message||t?.toString()||"Ein unbekannter Fehler ist aufgetreten.";return{title:"Fehler",message:s.length>100?`${s.substring(0,100)}...`:s,action:"Erneut versuchen",retryable:!0}}function Js(n){return Vs(n).message}function Xs({className:n,children:t,...s}){return e.jsxs(zn,{"data-slot":"scroll-area",className:k("relative",n),...s,children:[e.jsx(Pn,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),e.jsx(Ys,{}),e.jsx(Mn,{})]})}function Ys({className:n,orientation:t="vertical",...s}){return e.jsx(_n,{"data-slot":"scroll-area-scrollbar",orientation:t,className:k("hidden opacity-0 w-0 h-0 invisible pointer-events-none",n),...s,children:e.jsx(Ln,{"data-slot":"scroll-area-thumb",className:"hidden opacity-0 w-0 h-0"})})}const Qs={"layout-dashboard":Xe,calendar:xt,bell:Ye,wallet:Re,users:bt,"file-text":vt,folder:Oe,"scan-line":Oe,"shopping-cart":ze,receipt:Te,"clipboard-list":Te,settings:Ue,check:wt,plus:jt,search:rn,edit:an,trash:sn,clock:nn,euro:tn,"trending-up":en,"trending-down":Qt,info:Yt,"alert-circle":Xt},ea={dashboard:{path:"/",icon:Xe},finance:{path:"/finance",icon:Re},finanzen:{path:"/finance",icon:Re},bills:{path:"/bills",icon:Te},rechnungen:{path:"/bills",icon:Te},shopping:{path:"/shopping",icon:ze},einkaufsliste:{path:"/shopping",icon:ze},settings:{path:"/settings",icon:Ue},einstellungen:{path:"/settings",icon:Ue}};function ta({content:n,onNavigate:t}){const s=le(()=>{const i=[],o=n.length>1e4?n.substring(0,1e4)+"...":n;let r=0,l=0;const u=/\[(nav|icon):([a-zA-Z0-9_-]+)(?:[|｜]([^\]]+))?\]/g;let g;const c=[];for(;(g=u.exec(o))!==null;)c.push({index:g.index,type:g[1],key:g[2],label:g[3],endIndex:g.index+g[0].length});for(const h of c){if(h.index>r){const d=o.slice(r,h.index);i.push(e.jsx("span",{dangerouslySetInnerHTML:{__html:$e(d)}},`text-${l++}`))}if(h.type==="nav"&&h.label){const d=h.key,N=h.label,C=ea[d];if(C&&t){const y=C.icon;i.push(e.jsxs("button",{onClick:f=>{f.preventDefault(),f.stopPropagation();try{t(C.path)}catch{}},className:"inline-flex items-center gap-1.5 px-2 py-1 mx-0.5 rounded-lg bg-primary/10 hover:bg-primary/20 text-primary font-medium text-sm transition-all duration-200 cursor-pointer border border-primary/20 hover:border-primary/40",children:[e.jsx(y,{className:"size-4"}),e.jsx("span",{className:"underline decoration-dotted underline-offset-2",children:Be(N)})]},`nav-${l++}`))}else i.push(e.jsx("span",{className:"font-medium text-primary",children:Be(N)},`nav-text-${l++}`))}else if(h.type==="icon"){const d=h.key,N=Qs[d];N?i.push(e.jsx(N,{className:"inline-block size-4 mx-0.5 align-text-bottom text-primary"},`icon-${l++}`)):i.push(e.jsxs("span",{children:["[",Be(d),"]"]},`unknown-${l++}`))}r=h.endIndex}if(r<o.length){const h=o.slice(r);i.push(e.jsx("span",{dangerouslySetInnerHTML:{__html:$e(h)}},`text-${l++}`))}return i.length>0?i:[e.jsx("span",{dangerouslySetInnerHTML:{__html:$e(o)}},"full")]},[n,t]);return e.jsx("div",{className:"prose prose-sm max-w-none",children:s})}function Be(n){const t=document.createElement("div");return t.textContent=n,t.innerHTML}function $e(n){let t=Be(n);return t=t.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/__(.+?)__/g,"<strong>$1</strong>"),t=t.replace(new RegExp("(?<!\\*)\\*(?!\\*)(.+?)(?<!\\*)\\*(?!\\*)","g"),"<em>$1</em>"),t=t.replace(/`(.+?)`/g,'<code class="bg-muted px-1.5 py-0.5 rounded text-sm font-mono">$1</code>'),t=t.replace(/\n/g,"<br />"),t}function na({messages:n,onSendMessage:t,isLoading:s=!1,placeholder:i="Nachricht eingeben...",className:o,height:r="100%",emptyStateMessage:l="Beginne eine Unterhaltung mit dem Assistenten",suggestedPrompts:u}){const{t:g,i18n:c}=kt(),[,h]=Pe(),[d,N]=p(""),C=K(null),y=K(null),f=K(null),M=K(null),T=K(null),ce=K(null),[Q,W]=p(!1),[H,ne]=p(null),[se,ie]=p(!1),E=K(null),b=G(m=>{localStorage.setItem("nexo_chat_messages",JSON.stringify(n)),localStorage.setItem("nexo_chat_open_popup","true"),localStorage.setItem("nexo_chat_from_route",m),h(m)},[n,h]),D=le(()=>n.filter(m=>m.role!=="system"),[n]),z=le(()=>u?u.map(m=>typeof m=="string"?{text:m,icon:"tag"}:m):[],[u]),x=G(()=>{const m=C.current?.querySelector("[data-radix-scroll-area-viewport]");m&&requestAnimationFrame(()=>{m.scrollTo({top:m.scrollHeight,behavior:"smooth"})})},[]);$(()=>{D.length>0&&x()},[D.length,x]),$(()=>{const m=w=>{E.current&&!E.current.contains(w.target)&&ie(!1)};if(se)return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[se]);const j=G(m=>{m.preventDefault();const w=d.trim();if(!(!w||s)){if(w.length>1e4){v.error("Nachricht ist zu lang. Bitte kürze sie auf maximal 10.000 Zeichen.");return}if(s){v.info("Bitte warte auf die Antwort...");return}try{t(w),N(""),x(),M.current?.focus()}catch{v.error("Fehler beim Senden der Nachricht. Bitte versuche es erneut.")}}},[d,s,t,x]),A=G(m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),j(m))},[j]),J=G(m=>{s||(t(m),x())},[s,t,x]),X=G(async m=>{if(m.size>10485760){v.error(`Datei ist zu groß. Maximal ${(10485760/1024/1024).toFixed(0)}MB erlaubt.`);return}if(!m.name||m.name.length>255){v.error("Ungültiger Dateiname.");return}const B=v.loading("Datei wird hochgeladen...");try{const Y=await Promise.race([new Promise((q,O)=>{const ee=new FileReader;ee.onload=()=>{const ae=ee.result;if(!ae||!ae.includes(",")){O(new Error("Ungültiges Dateiformat"));return}q(ae.split(",")[1])},ee.onerror=()=>O(new Error("Fehler beim Lesen der Datei")),ee.readAsDataURL(m)}),new Promise((q,O)=>setTimeout(()=>O(new Error("Upload-Timeout")),3e4))]),P=F(R,"uploadAIChatFile"),L=await Promise.race([P({fileName:m.name,fileData:Y,fileType:m.type}),new Promise((q,O)=>setTimeout(()=>O(new Error("Upload-Timeout")),6e4))]);if(!L?.data)throw new Error("Keine Antwort vom Server erhalten");const I=L.data;if(!I.fileUrl||!I.fileName)throw new Error("Ungültige Server-Antwort");v.dismiss(B),t(`[Datei: ${I.fileName}](${I.fileUrl})`),v.success("Datei erfolgreich hochgeladen")}catch(Y){v.dismiss(B);const P=Y.message||"Unbekannter Fehler";v.error(`Fehler beim Hochladen: ${P}`)}},[t]),_=G(async m=>{if(!m.type.startsWith("image/")){v.error("Bitte wähle ein Bild aus (JPG, PNG, GIF, etc.)");return}const w=5*1024*1024;if(m.size>w){v.error(`Bild ist zu groß. Maximal ${(w/1024/1024).toFixed(0)}MB erlaubt.`);return}if(!m.name||m.name.length>255){v.error("Ungültiger Dateiname.");return}const B=v.loading("Bild wird hochgeladen...");try{const Y=await Promise.race([new Promise((q,O)=>{const ee=new FileReader;ee.onload=()=>{const ae=ee.result;if(!ae||!ae.includes(",")){O(new Error("Ungültiges Bildformat"));return}q(ae.split(",")[1])},ee.onerror=()=>O(new Error("Fehler beim Lesen des Bildes")),ee.readAsDataURL(m)}),new Promise((q,O)=>setTimeout(()=>O(new Error("Upload-Timeout")),3e4))]),P=F(R,"uploadAIChatImage"),L=await Promise.race([P({fileName:m.name,fileData:Y,fileType:m.type}),new Promise((q,O)=>setTimeout(()=>O(new Error("Upload-Timeout")),6e4))]);if(!L?.data)throw new Error("Keine Antwort vom Server erhalten");const I=L.data;if(!I.imageUrl||!I.fileName)throw new Error("Ungültige Server-Antwort");v.dismiss(B),t(`![${I.fileName}](${I.imageUrl})`),v.success("Bild erfolgreich hochgeladen")}catch(Y){v.dismiss(B);const P=Y.message||"Unbekannter Fehler";v.error(`Fehler beim Hochladen: ${P}`)}},[t]),re=G(async()=>{if(Q&&H){try{H.stop(),W(!1),v.info("Aufnahme wird verarbeitet...")}catch{W(!1),v.error("Fehler beim Stoppen der Aufnahme")}return}try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){v.error("Mikrofon-Zugriff wird von diesem Browser nicht unterstützt.");return}const m=await Promise.race([navigator.mediaDevices.getUserMedia({audio:!0}),new Promise((P,L)=>setTimeout(()=>L(new Error("Mikrofon-Zugriff-Timeout")),1e4))]),w=new MediaRecorder(m),B=[];let Y=null;w.ondataavailable=P=>{P.data.size>0&&B.push(P.data)},w.onstop=async()=>{Y&&clearTimeout(Y);const P=new Blob(B,{type:"audio/webm"}),L=10*1024*1024;if(P.size>L){v.error("Audio-Aufnahme ist zu groß. Bitte kürze die Aufnahme."),m.getTracks().forEach(q=>q.stop());return}const I=v.loading("Audio wird transkribiert...");try{const q=await Promise.race([new Promise((be,ue)=>{const de=new FileReader;de.onload=()=>{const Ae=de.result;if(!Ae||!Ae.includes(",")){ue(new Error("Ungültiges Audioformat"));return}be(Ae.split(",")[1])},de.onerror=()=>ue(new Error("Fehler beim Lesen der Audio-Datei")),de.readAsDataURL(P)}),new Promise((be,ue)=>setTimeout(()=>ue(new Error("Audio-Verarbeitung-Timeout")),3e4))]),O=F(R,"transcribeAIChatAudio"),ee=await Promise.race([O({audioData:q,mimeType:"audio/webm"}),new Promise((be,ue)=>setTimeout(()=>ue(new Error("Transkription-Timeout")),6e4))]);if(!ee?.data)throw new Error("Keine Antwort vom Server erhalten");const ae=ee.data;if(ae.transcription&&ae.transcription.trim())N(ae.transcription.trim()),M.current?.focus(),v.dismiss(I),v.success("Spracheingabe erfolgreich");else throw new Error("Keine Transkription erhalten")}catch(q){v.dismiss(I);const O=q.message||"Unbekannter Fehler";v.error(`Fehler bei der Transkription: ${O}`)}finally{m.getTracks().forEach(q=>q.stop())}},w.onerror=P=>{v.error("Fehler bei der Aufnahme"),W(!1),m.getTracks().forEach(L=>L.stop())},Y=setTimeout(()=>{w.state==="recording"&&(w.stop(),v.warning("Maximale Aufnahmezeit erreicht (5 Minuten)"))},300*1e3),w.start(),ne(w),W(!0),v.info("Aufnahme gestartet... (Klicke erneut zum Stoppen)")}catch(m){W(!1);const w=m.message||"Unbekannter Fehler";w.includes("permission")||w.includes("denied")?v.error("Mikrofon-Zugriff wurde verweigert. Bitte erlaube den Zugriff in den Browser-Einstellungen."):w.includes("not found")||w.includes("not available")?v.error("Kein Mikrofon gefunden. Bitte verbinde ein Mikrofon."):v.error(`Mikrofon-Fehler: ${w}`)}},[Q,H]),xe=G(()=>{const w=c.language==="de"?"en":"de";c.changeLanguage(w),localStorage.setItem("language",w),v.success(w==="de"?"Sprache auf Deutsch geändert":"Language changed to English")},[c]),ge=()=>e.jsxs("form",{ref:f,onSubmit:j,className:"w-full",children:[e.jsx("input",{ref:T,type:"file",className:"hidden",onChange:m=>{const w=m.target.files?.[0];w&&X(w),m.target.value=""},accept:"*/*"}),e.jsx("input",{ref:ce,type:"file",className:"hidden",onChange:m=>{const w=m.target.files?.[0];w&&(_(w),ie(!1)),m.target.value=""},accept:"image/*"}),e.jsx("div",{className:"w-full max-w-full mx-auto",children:e.jsxs("div",{className:"flex items-center gap-2 px-2",style:{alignItems:"center"},children:[e.jsx("div",{className:"relative",ref:E,children:se&&e.jsxs("div",{className:"absolute bottom-full left-2 mb-2 bg-background border border-border rounded-lg shadow-lg z-50 min-w-[200px] overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>{T.current?.click()},className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-muted transition-colors text-left",children:[e.jsx(Gt,{className:"w-5 h-5 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Datei anhängen"})]}),e.jsxs("button",{type:"button",onClick:()=>{ce.current?.click()},className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-muted transition-colors text-left",children:[e.jsx(qt,{className:"w-5 h-5 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Bild hinzufügen"})]}),e.jsxs("button",{type:"button",onClick:()=>{xe(),ie(!1)},className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-muted transition-colors text-left",children:[e.jsx(Zt,{className:"w-5 h-5 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Sprache wechseln"})]})]})}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("button",{type:"button",onClick:()=>ie(!se),className:"absolute left-2 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full bg-transparent hover:bg-muted/50 transition-colors flex items-center justify-center active:scale-95 z-10","aria-label":"Mehr Optionen",disabled:s,children:e.jsx(jt,{className:"w-4 h-4 text-muted-foreground"})}),e.jsx("textarea",{ref:M,value:d,onChange:m=>N(m.target.value),onKeyDown:A,placeholder:i,rows:1,className:"w-full pl-10 pr-4 py-3 rounded-2xl bg-muted border-0 text-base text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/20 transition-all resize-none overflow-y-auto min-h-[44px] max-h-[120px] leading-relaxed",style:{height:"auto",minHeight:"44px"},disabled:s,onInput:m=>{const w=m.target;w.style.height="auto",w.style.height=`${Math.min(w.scrollHeight,120)}px`}})]}),d.trim()?e.jsx("button",{type:"submit",disabled:s,className:"w-10 h-10 rounded-full bg-primary text-primary-foreground hover:bg-primary/90 transition-colors flex items-center justify-center active:scale-95 shadow-md self-center","aria-label":s?"Wird gesendet...":"Nachricht senden",children:s?e.jsx(at,{className:"w-5 h-5 animate-spin"}):e.jsx(Vt,{className:"w-5 h-5"})}):e.jsx("button",{type:"button",onClick:re,className:k("transition-colors flex items-center justify-center active:scale-95 self-center p-2",Q?"text-red-500 hover:text-red-600":"text-foreground hover:text-foreground/80"),"aria-label":"Spracheingabe",disabled:s,children:e.jsx(Jt,{className:k("w-7 h-7",Q?"text-red-500":"text-foreground")})})]})})]});return e.jsx("div",{ref:y,className:k("flex flex-col bg-background text-foreground",o),style:{height:r},children:D.length===0?e.jsxs("div",{className:"flex flex-col h-full animate-in fade-in duration-300 pb-20",children:[e.jsx("div",{className:"flex-1 flex items-center justify-center px-4",children:e.jsx("div",{className:"w-full max-w-2xl"})}),z.length>0&&e.jsx("div",{className:"fixed bottom-24 left-0 right-0 px-4 pb-2 z-20 pointer-events-none",children:e.jsx("div",{className:"w-full max-w-2xl mx-auto",children:e.jsx("div",{className:"overflow-x-auto scrollbar-hide -mx-4 px-4 pointer-events-auto",children:e.jsx("div",{className:"flex gap-3",style:{width:"max-content"},children:z.map((m,w)=>{const B=m.subtitle&&m.subtitle.trim().length>0;return e.jsxs("button",{onClick:()=>J(m.text),disabled:s,className:"flex-shrink-0 w-[calc(40vw-1rem)] min-w-[140px] max-w-[160px] rounded-xl bg-muted hover:bg-muted/80 active:bg-muted/70 px-2.5 py-2 text-left transition-all duration-200 disabled:cursor-not-allowed disabled:opacity-50 shadow-sm",type:"button",children:[e.jsx("p",{className:"font-medium text-xs text-foreground mb-0.5 line-clamp-2 leading-tight",children:m.text}),B&&e.jsx("p",{className:"text-[10px] text-muted-foreground line-clamp-2 leading-tight",children:m.subtitle})]},w)})})})})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 w-full bg-background px-4 py-3 safe-bottom",style:{paddingBottom:"max(0.75rem, env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"w-full max-w-2xl mx-auto",children:ge()})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:C,className:"flex-1 overflow-hidden pb-32",children:e.jsx(Xs,{className:"h-full [&>div>div]:!overflow-y-auto [&>div>div]:[-ms-overflow-style:none] [&>div>div]:[scrollbar-width:none] [&>div>div::-webkit-scrollbar]:hidden",children:e.jsxs("div",{className:"flex flex-col p-4 space-y-4 pb-6",children:[D.map((m,w)=>e.jsx("div",{className:k("flex gap-3 animate-in fade-in slide-in-from-bottom-2 duration-300",m.role==="user"?"justify-end":"justify-start"),children:e.jsx("div",{className:k("max-w-[85%] select-text",m.role==="user"?"bg-primary text-primary-foreground rounded-2xl px-4 py-3 text-base":"text-foreground text-base"),onClick:B=>B.stopPropagation(),onMouseDown:B=>B.stopPropagation(),children:m.role==="assistant"?e.jsx(ta,{content:m.content,onNavigate:b}):e.jsx("p",{className:"whitespace-pre-wrap leading-relaxed",children:m.content})})},w)),s&&e.jsx("div",{className:"flex items-start gap-4 justify-start animate-in fade-in duration-200",children:e.jsx("div",{className:"rounded-lg bg-muted px-4 py-3",children:e.jsx(at,{className:"size-4 animate-spin text-muted-foreground"})})})]})})}),z.length>0&&e.jsx("div",{className:"fixed bottom-24 left-0 right-0 px-4 pb-2 z-20 pointer-events-none",children:e.jsx("div",{className:"w-full max-w-2xl mx-auto",children:e.jsx("div",{className:"overflow-x-auto scrollbar-hide -mx-4 px-4 pointer-events-auto",children:e.jsx("div",{className:"flex gap-3",style:{width:"max-content"},children:z.map((m,w)=>{const B=m.subtitle&&m.subtitle.trim().length>0;return e.jsxs("button",{onClick:()=>J(m.text),disabled:s,className:"flex-shrink-0 w-[calc(40vw-1rem)] min-w-[140px] max-w-[160px] rounded-xl bg-muted hover:bg-muted/80 active:bg-muted/70 px-2.5 py-2 text-left transition-all duration-200 disabled:cursor-not-allowed disabled:opacity-50 shadow-sm",type:"button",children:[e.jsx("p",{className:"font-medium text-xs text-foreground mb-0.5 line-clamp-2 leading-tight",children:m.text}),B&&e.jsx("p",{className:"text-[10px] text-muted-foreground line-clamp-2 leading-tight",children:m.subtitle})]},w)})})})})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 w-full bg-background/95 backdrop-blur-sm px-4 py-3 safe-bottom flex-shrink-0 z-30",style:{paddingBottom:"max(0.75rem, env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"w-full max-w-2xl mx-auto",children:ge()})})]})})}function mt({className:n,onKeyDown:t,onCompositionStart:s,onCompositionEnd:i,...o}){const r=Qe(),{onCompositionStart:l,onCompositionEnd:u,onKeyDown:g}=Ft({onKeyDown:c=>{const h=c.nativeEvent.isComposing||r.justEndedComposing();c.key==="Enter"&&!c.shiftKey&&h||t?.(c)},onCompositionStart:c=>{r.setComposing(!0),s?.(c)},onCompositionEnd:c=>{r.markCompositionEnd(),setTimeout(()=>{r.setComposing(!1)},100),i?.(c)}});return e.jsx("textarea",{"data-slot":"textarea",className:k("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),onCompositionStart:l,onCompositionEnd:u,onKeyDown:g,...o})}function sa(){return zs()}async function Ge(n){try{if(n.id&&!n.id.startsWith("chat_"))await Ls(n.id,{title:n.title,messages:n.messages});else{const t=await _s({title:n.title,messages:n.messages});n.id=t.id}}catch(t){throw t}}function qe(n,t){return t.find(s=>s.id===n)||null}function aa(n){return n.length<=50?n:n.substring(0,50)+"..."}function ht(){const n=`chat_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,t=new Date().toISOString();return{id:n,userId:"",title:"Neue Konversation",messages:[],createdAt:t,updatedAt:t}}const Le={role:"system",content:"Du bist ein hilfreicher Assistent für die Nexo-Anwendung. Du hilfst Benutzern bei Fragen zu Finanzen, Rechnungen, Terminen und anderen Funktionen der App."};function La(){const{t:n}=kt();Pe();const{data:t,isLoading:s,refetch:i}=sa(),[o,r]=p(null),[l,u]=p(!1),[g,c]=p(!1),[h,d]=p(!1),[N,C]=p(!1),[y,f]=p(!1),[M,T]=p(!1),[ce,Q]=p(!1),[W,H]=p(null),ne=K(null),se=K(null),ie=K(null),E=K(null),[b,D]=p({title:"",type:"termin",dueDate:"",isAllDay:!1,amount:"",currency:"CHF",notes:""}),[z,x]=p(!1),[j,A]=p({type:"ausgabe",amount:"",category:"",description:"",date:new Date().toISOString().split("T")[0],paymentMethod:"Karte"}),[J,X]=p(!1),[_,re]=p({name:"",quantity:"1",category:"Lebensmittel",store:""}),[xe,ge]=p(!1),m=["Lebensmittel","Getränke","Haushalt","Hygiene","Tierbedarf","Sonstiges"],w=async()=>{if(!_.name){v.error("Bitte Artikelname eingeben");return}ge(!0);try{await Ts({item:_.name,quantity:parseInt(_.quantity)||1,category:_.category,estimatedPrice:0,currency:"EUR",unit:null}),v.success("Artikel zur Einkaufsliste hinzugefügt"),f(!1),re({name:"",quantity:"1",category:"Lebensmittel",store:""})}catch(a){v.error("Fehler beim Hinzufügen des Artikels"),console.error(a)}finally{ge(!1)}},B={income:["Gehalt","Freelance","Investitionen","Geschenk","Sonstiges"],expense:["Lebensmittel","Transport","Wohnen","Unterhaltung","Gesundheit","Kleidung","Bildung","Rechnung","Sonstiges"]},Y=async()=>{if(!j.amount||!j.category){v.error("Bitte Betrag und Kategorie eingeben");return}X(!0);try{await Rs({type:j.type,category:j.category,amount:Math.round(parseFloat(j.amount)*100),currency:"CHF",date:new Date(j.date),paymentMethod:j.paymentMethod,notes:j.description||"",status:j.type==="ausgabe"?"open":void 0}),v.success(j.type==="einnahme"?"Einnahme hinzugefügt":"Ausgabe hinzugefügt"),C(!1),A({type:"ausgabe",amount:"",category:"",description:"",date:new Date().toISOString().split("T")[0],paymentMethod:"Karte"})}catch(a){v.error("Fehler beim Erstellen des Eintrags"),console.error(a)}finally{X(!1)}};$(()=>{if(!s&&t.length>0&&!o)r(t[0].id);else if(!s&&t.length===0&&!o){const a=ht();Ge(a).then(()=>{i(),r(a.id)})}},[s,t,o,i]);const[P,L]=p([Le]);$(()=>{if(o&&t.length>0){const a=qe(o,t);a&&a.messages.length>0?L(a.messages):L([Le])}},[o,t]),$(()=>{if(o&&P.length>1){const a=setTimeout(async()=>{const S=qe(o,t);if(S){const Z=P.find(oe=>oe.role==="user");Z&&S.title==="Neue Konversation"&&(S.title=aa(Z.content)),S.messages=P,S.updatedAt=new Date().toISOString();try{await Ge(S),i()}catch{}}},1e3);return()=>clearTimeout(a)}},[P,o,t,i]);const I=G(async()=>{const a=ht();try{await Ge(a),r(a.id),L([Le]),await i(),v.success("Neue Konversation gestartet")}catch(S){v.error("Fehler beim Erstellen der neuen Konversation: "+(S instanceof Error?S.message:String(S)))}},[i]),q=G(a=>{r(a);const S=qe(a,t);S&&S.messages.length>0?L(S.messages):L([Le])},[t]),O=ys.ai.chat.useMutation({onSuccess:a=>{const S={role:"assistant",content:a.content};L(Z=>[...Z,S])},onError:a=>{let S="Ein unbekannter Fehler ist aufgetreten.";a.message.includes("<!doctype")||a.message.includes("Unexpected token")||a.message.includes("Failed to fetch")?S="Der Server ist nicht erreichbar oder gibt eine ungültige Antwort zurück. Bitte stelle sicher, dass der Server läuft und du eine Internetverbindung hast.":a.message.includes("Unable to transform")||a.message.includes("NetworkError")?S="Fehler bei der Datenübertragung. Bitte überprüfe deine Internetverbindung und versuche es erneut.":a.data?.code==="UNAUTHORIZED"||a.message.includes("unauthenticated")?S="Du bist nicht angemeldet. Bitte melde dich an.":a.data?.code==="INTERNAL_SERVER_ERROR"||a.message.includes("500")?S="Ein Serverfehler ist aufgetreten. Bitte versuche es später erneut.":a.message.includes("timeout")||a.message.includes("Timeout")?S="Die Anfrage hat zu lange gedauert. Bitte versuche es erneut.":a.message.includes("rate limit")||a.message.includes("429")?S="Zu viele Anfragen. Bitte warte einen Moment und versuche es erneut.":S=a.message||"Ein Fehler ist aufgetreten.";const Z={role:"assistant",content:`**Fehler aufgetreten**

${S}

Bitte versuche es erneut oder starte eine neue Konversation.`};L(oe=>[...oe,Z]),v.error("Fehler beim Senden der Nachricht")}}),ee=G(a=>{if(a.length>1e4){v.error("Nachricht ist zu lang. Bitte kürze sie auf maximal 10.000 Zeichen.");return}if(P.filter(Z=>Z.role==="user").length>=50){v.warning("Zu viele Nachrichten in dieser Konversation. Bitte starte eine neue Konversation.");return}try{const Z={role:"user",content:a},oe=[...P,Z];L(oe),O.mutate({messages:oe})}catch{v.error("Fehler beim Senden der Nachricht. Bitte versuche es erneut.")}},[P,O]),ae=le(()=>[{text:"Wie funktioniert die Rechnungsverwaltung?",subtitle:"Lerne die Rechnungsverwaltung kennen",icon:"receipt"},{text:"Wie erstelle ich eine Erinnerung?",subtitle:"Erstelle Termine und Erinnerungen",icon:"bell"},{text:"Wie verwalte ich meine Finanzen?",subtitle:"Verwalte Einnahmen und Ausgaben",icon:"wallet"},{text:"Was kann ich mit der Einkaufsliste machen?",subtitle:"Verwalte deine Einkaufsliste",icon:"shoppingCart"},{text:"Wie funktioniert das Raten-System?",subtitle:"Lerne Ratenzahlungen zu verwalten",icon:"calendar"},{text:"Wie scanne ich eine Rechnung?",subtitle:"Erfasse Rechnungen automatisch",icon:"scan"}],[]),be=P.some(a=>a.role==="user"),ue=()=>o&&t.length>0&&t.find(S=>S.id===o)?.title||"Assistent",de=le(()=>[{id:"reminder",label:"Erinnerung erstellen",path:"#",icon:Ye,onClick:()=>c(!0)},{id:"scan",label:"Rechnung scannen",path:"#",icon:Oe,onClick:()=>{d(!0),H(null)}},{id:"finance",label:"Finanzübersicht",path:"#",icon:Re,onClick:()=>C(!0)},{id:"shopping",label:"Einkaufsliste",path:"#",icon:ze,onClick:()=>f(!0)}],[]),Ae=async()=>{if(!b.title||!b.dueDate){v.error("Bitte füllen Sie Titel und Datum aus");return}x(!0);try{const a=b.amount?Math.round(parseFloat(b.amount)*100):void 0;await Fs({title:b.title,type:b.type,dueDate:new Date(b.dueDate),isAllDay:b.isAllDay,amount:a,currency:b.currency,notes:b.notes||""}),v.success("Erinnerung erstellt"),c(!1),D({title:"",type:"termin",dueDate:"",isAllDay:!1,amount:"",currency:"CHF",notes:""})}catch(a){v.error("Fehler beim Erstellen der Erinnerung"),console.error(a)}finally{x(!1)}},Rt=async()=>{try{const a=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});E.current=a,ne.current&&(ne.current.srcObject=a),T(!0),He()}catch(a){v.error(Js(a)),Zs()}},Ie=()=>{E.current&&(E.current.getTracks().forEach(a=>a.stop()),E.current=null),T(!1)},Tt=()=>{if(ne.current&&se.current){const a=ne.current,S=se.current;S.width=a.videoWidth,S.height=a.videoHeight;const Z=S.getContext("2d");if(Z){Z.drawImage(a,0,0);const oe=S.toDataURL("image/jpeg");H(oe),Ie(),He()}}},zt=a=>{const S=a.target.files?.[0];if(S){const Z=new FileReader;Z.onload=oe=>{const Mt=oe.target?.result;H(Mt),He()},Z.readAsDataURL(S)}},Pt=async()=>{if(W){const a={role:"user",content:`![Gescanntes Bild](${W})`};L(S=>[...S,a]),H(null),d(!1),v.success("Scan zum Chat hinzugefügt");try{O.mutate({messages:[...P,a]})}catch(S){console.error("Error sending scan to chat:",S)}}};return $(()=>()=>{h||Ie()},[h]),e.jsxs("div",{className:"min-h-screen bg-background flex flex-col safe-area-inset",children:[e.jsx(Ws,{title:ue(),showSidebar:!0,showQuickActions:!0,quickActions:de,currentChatId:o||void 0,onSelectChat:q,onNewChat:I,sidebarOpen:l,onSidebarToggle:u}),de.length>0&&e.jsxs("div",{className:"fixed top-14 left-0 right-0 z-30 px-4 py-3 flex flex-row gap-3 justify-center safe-top",style:{paddingTop:"max(0.75rem, env(safe-area-inset-top))"},children:[e.jsx("button",{onClick:()=>u(!0),className:"w-12 h-12 rounded-full bg-background hover:bg-muted border border-border transition-colors flex items-center justify-center active:scale-95 shadow-sm","aria-label":"Menü öffnen","aria-expanded":l,"aria-controls":"sidebar-menu",title:"Menü öffnen",children:e.jsx(on,{className:"w-5 h-5 text-foreground"})}),de.map(a=>{const S=a.icon;return e.jsx("button",{onClick:a.onClick,className:"w-12 h-12 rounded-full bg-background hover:bg-muted border border-border transition-colors flex items-center justify-center active:scale-95 shadow-sm","aria-label":a.label,title:a.label,children:S&&e.jsx(S,{className:"w-5 h-5 text-foreground"})},a.id)}),be&&e.jsx("button",{onClick:I,className:"w-12 h-12 rounded-full bg-background hover:bg-muted border border-border transition-colors flex items-center justify-center active:scale-95 shadow-sm","aria-label":"Neue Konversation",title:"Neue Konversation",children:e.jsx(ln,{className:"w-5 h-5 text-foreground"})})]}),e.jsx("div",{className:"flex-1 overflow-hidden flex flex-col bg-background",style:{paddingTop:de.length>0?"7rem":"3.5rem"},children:e.jsx("div",{className:"flex-1 flex flex-col w-full overflow-hidden min-h-0",children:e.jsx(na,{messages:P,onSendMessage:ee,isLoading:O.isPending,placeholder:n("common.typeMessage","Nachricht eingeben..."),height:"100%",emptyStateMessage:"Wähle eine Frage oder stelle deine eigene",suggestedPrompts:be?[]:ae})})}),e.jsx(Ce,{open:g,onOpenChange:c,children:e.jsxs(Se,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-fit !rounded-3xl !m-0 !overflow-visible !shadow-2xl",children:[e.jsx(ke,{className:"px-5 pt-5 pb-3",children:e.jsx(Ee,{className:"text-lg font-semibold",children:"Erinnerung erstellen"})}),e.jsxs("div",{className:"space-y-3 px-5 pb-2",children:[e.jsxs("div",{children:[e.jsx(V,{className:"text-sm font-medium",children:"Titel *"}),e.jsx(me,{value:b.title,onChange:a=>D({...b,title:a.target.value}),placeholder:"Titel",className:"h-11 min-h-[44px] mt-1.5 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx(V,{className:"text-sm font-medium",children:"Typ *"}),e.jsxs(ye,{value:b.type,onValueChange:a=>D({...b,type:a}),children:[e.jsx(je,{className:"h-11 min-h-[44px] mt-1.5 rounded-xl",children:e.jsx(we,{})}),e.jsxs(Ne,{children:[e.jsx(te,{value:"termin",children:"Termin"}),e.jsx(te,{value:"zahlung",children:"Zahlung"}),e.jsx(te,{value:"aufgabe",children:"Aufgabe"})]})]})]}),e.jsxs("div",{children:[e.jsx(V,{className:"text-sm font-medium",children:"Datum & Uhrzeit *"}),e.jsx(me,{type:"datetime-local",value:b.dueDate,onChange:a=>D({...b,dueDate:a.target.value}),className:"h-11 min-h-[44px] mt-1.5 rounded-xl"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gs,{checked:b.isAllDay,onCheckedChange:a=>D({...b,isAllDay:a})}),e.jsx(V,{className:"text-sm font-medium",children:"Ganztägig"})]}),b.type==="zahlung"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(V,{children:"Betrag"}),e.jsx(me,{type:"number",step:"0.01",value:b.amount,onChange:a=>D({...b,amount:a.target.value}),placeholder:"0.00",className:"h-10 min-h-[44px] mt-1"})]}),e.jsxs("div",{children:[e.jsx(V,{className:"text-sm font-medium",children:"Währung"}),e.jsxs(ye,{value:b.currency,onValueChange:a=>D({...b,currency:a}),children:[e.jsx(je,{className:"h-10 min-h-[44px] mt-1",children:e.jsx(we,{})}),e.jsxs(Ne,{children:[e.jsx(te,{value:"CHF",children:"CHF"}),e.jsx(te,{value:"EUR",children:"EUR"}),e.jsx(te,{value:"USD",children:"USD"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(V,{className:"text-sm font-medium",children:"Notizen"}),e.jsx(mt,{value:b.notes,onChange:a=>D({...b,notes:a.target.value}),placeholder:"Notizen...",className:"mt-1.5 min-h-[90px] rounded-xl"})]})]}),e.jsxs(De,{className:"px-5 pb-3 pt-2 gap-2.5",children:[e.jsx(U,{variant:"outline",onClick:()=>c(!1),className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:"Abbrechen"}),e.jsx(U,{onClick:Ae,disabled:z,className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:z?"Speichert...":"Erstellen"})]})]})}),e.jsx(Ce,{open:h,onOpenChange:a=>{d(a),a||(Ie(),H(null))},children:e.jsxs(Se,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-fit !rounded-3xl !m-0 !overflow-visible !shadow-2xl",children:[e.jsx(ke,{className:"px-5 pt-5 pb-3",children:e.jsx(Ee,{className:"text-lg font-semibold",children:"Rechnung scannen"})}),e.jsxs("div",{className:"space-y-3 px-5 pb-2",children:[!M&&!W&&e.jsxs("div",{className:"space-y-2.5",children:[e.jsxs(U,{onClick:Rt,className:"w-full h-11 flex items-center justify-center gap-2 rounded-xl text-sm font-medium",children:[e.jsx(rt,{className:"w-4 h-4"}),"Kamera öffnen"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:ie,type:"file",accept:"image/*",onChange:zt,className:"hidden"}),e.jsxs(U,{variant:"outline",onClick:()=>ie.current?.click(),className:"w-full h-11 flex items-center justify-center gap-2 rounded-xl text-sm font-medium",children:[e.jsx(cn,{className:"w-4 h-4"}),"Bild hochladen"]})]})]}),M&&e.jsxs("div",{className:"space-y-2.5",children:[e.jsxs("div",{className:"relative bg-black rounded-xl overflow-hidden aspect-video",children:[e.jsx("video",{ref:ne,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),e.jsx("canvas",{ref:se,className:"hidden"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(U,{variant:"outline",onClick:Ie,className:"flex-1 h-11 rounded-xl text-sm font-medium",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Abbrechen"]}),e.jsxs(U,{onClick:Tt,className:"flex-1 h-11 rounded-xl text-sm font-medium",children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),"Aufnehmen"]})]})]}),W&&e.jsxs("div",{className:"space-y-2.5",children:[e.jsx("div",{className:"relative bg-black rounded-xl overflow-hidden",children:e.jsx("img",{src:W,alt:"Gescanntes Bild",className:"w-full h-auto"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{variant:"outline",onClick:()=>{H(null),T(!1)},className:"flex-1 h-11 rounded-xl text-sm font-medium",children:"Neu scannen"}),e.jsx(U,{onClick:Pt,className:"flex-1 h-11 rounded-xl text-sm font-medium",children:"Zum Chat hinzufügen"})]})]})]}),e.jsx(De,{className:"px-5 pb-3 pt-2",children:e.jsx(U,{variant:"outline",onClick:()=>{d(!1),Ie(),H(null)},className:"h-11 min-h-[44px] w-full rounded-xl text-sm font-medium",children:"Schließen"})})]})}),e.jsx(Ce,{open:N,onOpenChange:a=>{C(a),a||A({type:"ausgabe",amount:"",category:"",description:"",date:new Date().toISOString().split("T")[0],paymentMethod:"Karte"})},children:e.jsxs(Se,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-fit !rounded-3xl !m-0 !overflow-visible !shadow-2xl",children:[e.jsx(ke,{className:"px-5 pt-5 pb-3",children:e.jsx(Ee,{className:"text-lg font-semibold",children:"Einnahme / Ausgabe"})}),e.jsxs("div",{className:"space-y-3 px-5 pb-2",children:[e.jsxs("div",{children:[e.jsx(V,{className:"text-sm font-medium",children:"Typ *"}),e.jsxs(ye,{value:j.type,onValueChange:a=>{A({...j,type:a,category:""})},children:[e.jsx(je,{className:"h-11 min-h-[44px] mt-1.5 rounded-xl",children:e.jsx(we,{})}),e.jsxs(Ne,{children:[e.jsx(te,{value:"einnahme",children:"Einnahme"}),e.jsx(te,{value:"ausgabe",children:"Ausgabe"})]})]})]}),e.jsxs("div",{children:[e.jsx(V,{children:"Betrag *"}),e.jsx(me,{type:"number",step:"0.01",value:j.amount,onChange:a=>A({...j,amount:a.target.value}),placeholder:"0.00",className:"h-11 min-h-[44px] mt-1.5 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx(V,{className:"text-sm font-medium",children:"Kategorie *"}),e.jsxs(ye,{value:j.category,onValueChange:a=>A({...j,category:a}),children:[e.jsx(je,{className:"h-11 min-h-[44px] mt-1.5 rounded-xl",children:e.jsx(we,{placeholder:"Kategorie wählen"})}),e.jsx(Ne,{children:(j.type==="einnahme"?B.income:B.expense).map(a=>e.jsx(te,{value:a,children:a},a))})]})]}),e.jsxs("div",{children:[e.jsx(V,{className:"text-sm font-medium",children:"Datum *"}),e.jsx(me,{type:"date",value:j.date,onChange:a=>A({...j,date:a.target.value}),className:"h-11 min-h-[44px] mt-1.5 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx(V,{children:"Zahlungsmethode"}),e.jsxs(ye,{value:j.paymentMethod,onValueChange:a=>A({...j,paymentMethod:a}),children:[e.jsx(je,{className:"h-11 min-h-[44px] mt-1.5 rounded-xl",children:e.jsx(we,{})}),e.jsxs(Ne,{children:[e.jsx(te,{value:"Karte",children:"Karte"}),e.jsx(te,{value:"Bar",children:"Bar"}),e.jsx(te,{value:"Überweisung",children:"Überweisung"}),e.jsx(te,{value:"Andere",children:"Andere"})]})]})]}),e.jsxs("div",{children:[e.jsx(V,{children:"Beschreibung"}),e.jsx(mt,{value:j.description,onChange:a=>A({...j,description:a.target.value}),placeholder:"Beschreibung...",className:"mt-1 min-h-[80px]"})]})]}),e.jsxs(De,{className:"px-5 pb-3 pt-2 gap-2.5",children:[e.jsx(U,{variant:"outline",onClick:()=>C(!1),className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:"Abbrechen"}),e.jsx(U,{onClick:Y,disabled:J,className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:J?"Speichert...":"Erstellen"})]})]})}),e.jsx(Ce,{open:y,onOpenChange:a=>{f(a),a||re({name:"",quantity:"1",category:"Lebensmittel",store:""})},children:e.jsxs(Se,{className:"!fixed !top-[50%] !left-[50%] !right-auto !bottom-auto !translate-x-[-50%] !translate-y-[-50%] !w-[85vw] !max-w-sm !max-h-fit !rounded-3xl !m-0 !overflow-visible !shadow-2xl",children:[e.jsx(ke,{className:"px-5 pt-5 pb-3",children:e.jsx(Ee,{className:"text-lg font-semibold",children:"Artikel zur Einkaufsliste hinzufügen"})}),e.jsxs("div",{className:"space-y-3 px-5 pb-2",children:[e.jsxs("div",{children:[e.jsx(V,{className:"text-sm font-medium",children:"Artikelname *"}),e.jsx(me,{value:_.name,onChange:a=>re({..._,name:a.target.value}),placeholder:"z.B. Milch",className:"h-11 min-h-[44px] mt-1.5 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx(V,{className:"text-sm font-medium",children:"Menge"}),e.jsx(me,{type:"number",min:"1",value:_.quantity,onChange:a=>re({..._,quantity:a.target.value}),placeholder:"1",className:"h-11 min-h-[44px] mt-1.5 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx(V,{className:"text-sm font-medium",children:"Kategorie"}),e.jsxs(ye,{value:_.category,onValueChange:a=>re({..._,category:a}),children:[e.jsx(je,{className:"h-11 min-h-[44px] mt-1.5 rounded-xl",children:e.jsx(we,{})}),e.jsx(Ne,{children:m.map(a=>e.jsx(te,{value:a,children:a},a))})]})]}),e.jsxs("div",{children:[e.jsx(V,{className:"text-sm font-medium",children:"Geschäft (optional)"}),e.jsx(me,{value:_.store,onChange:a=>re({..._,store:a.target.value}),placeholder:"z.B. Migros",className:"h-11 min-h-[44px] mt-1.5 rounded-xl"})]})]}),e.jsxs(De,{className:"px-5 pb-3 pt-2 gap-2.5",children:[e.jsx(U,{variant:"outline",onClick:()=>f(!1),className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:"Abbrechen"}),e.jsx(U,{onClick:w,disabled:xe,className:"h-11 min-h-[44px] flex-1 rounded-xl text-sm font-medium",children:xe?"Speichert...":"Hinzufügen"})]})]})})]})}export{ba as $,ya as A,U as B,Cs as C,Ce as D,wa as E,k as F,ka as G,Gs as H,me as I,Da as J,Ca as K,V as L,Fs as M,js as N,Et as O,Ws as P,Ms as Q,Sa as R,ye as S,mt as T,Ia as U,Fa as V,Ra as W,Ta as X,ja as Y,Ea as Z,Aa as _,Na as a,La as a0,ga as a1,ys as a2,ve as a3,Se as b,ke as c,Ee as d,Ss as e,R as f,De as g,za as h,je as i,e as j,we as k,Ne as l,te as m,Ts as n,He as o,Zs as p,Ma as q,_a as r,Js as s,Pa as t,kt as u,Rs as v,fa as w,pa as x,xa as y,va as z};
